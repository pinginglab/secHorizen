(function (global, factory) {
    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('escape-string-regexp'), require('@angular/core'), require('@angular/forms'), require('@angular/platform-browser'), require('rxjs'), require('rxjs/operators'), require('lodash'), require('@angular/common')) :
    typeof define === 'function' && define.amd ? define('ngx-select-ex', ['exports', 'escape-string-regexp', '@angular/core', '@angular/forms', '@angular/platform-browser', 'rxjs', 'rxjs/operators', 'lodash', '@angular/common'], factory) :
    (factory((global['ngx-select-ex'] = {}),global.escapeString,global.ng.core,global.ng.forms,global.ng.platformBrowser,global.rxjs,global.rxjs.operators,global._,global.ng.common));
}(this, (function (exports,escapeStringNs,core,forms,platformBrowser,rxjs,operators,lodashNs,common) { 'use strict';

    /*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m)
            return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done)
                ar.push(r.value);
        }
        catch (error) {
            e = { error: error };
        }
        finally {
            try {
                if (r && !r.done && (m = i["return"]))
                    m.call(i);
            }
            finally {
                if (e)
                    throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++)
            ar = ar.concat(__read(arguments[i]));
        return ar;
    }

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
     */
    /** @type {?} */
    var escapeString = escapeStringNs;
    var NgxSelectOption = /** @class */ (function () {
        function NgxSelectOption(value, text, disabled, data, _parent) {
            if (_parent === void 0) {
                _parent = null;
            }
            this.value = value;
            this.text = text;
            this.disabled = disabled;
            this.data = data;
            this._parent = _parent;
            this.type = 'option';
            this.cacheRenderedText = null;
        }
        Object.defineProperty(NgxSelectOption.prototype, "parent", {
            get: /**
             * @return {?}
             */ function () {
                return this._parent;
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @param {?} sanitizer
         * @param {?} highlightText
         * @return {?}
         */
        NgxSelectOption.prototype.renderText = /**
         * @param {?} sanitizer
         * @param {?} highlightText
         * @return {?}
         */
            function (sanitizer, highlightText) {
                if (this.cacheHighlightText !== highlightText || this.cacheRenderedText === null) {
                    this.cacheHighlightText = highlightText;
                    if (this.cacheHighlightText) {
                        this.cacheRenderedText = sanitizer.bypassSecurityTrustHtml((this.text + '').replace(new RegExp(escapeString(this.cacheHighlightText), 'gi'), '<strong>$&</strong>'));
                    }
                    else {
                        this.cacheRenderedText = sanitizer.bypassSecurityTrustHtml(this.text);
                    }
                }
                return this.cacheRenderedText;
            };
        return NgxSelectOption;
    }());
    var NgxSelectOptGroup = /** @class */ (function () {
        function NgxSelectOptGroup(label, options) {
            if (options === void 0) {
                options = [];
            }
            this.label = label;
            this.options = options;
            this.type = 'optgroup';
            this.filter(function () { return true; });
        }
        /**
         * @param {?} callbackFn
         * @return {?}
         */
        NgxSelectOptGroup.prototype.filter = /**
         * @param {?} callbackFn
         * @return {?}
         */
            function (callbackFn) {
                this.optionsFiltered = this.options.filter(function (option) { return callbackFn(option); });
            };
        return NgxSelectOptGroup;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
     */
    var NgxSelectOptionDirective = /** @class */ (function () {
        function NgxSelectOptionDirective(template) {
            this.template = template;
        }
        NgxSelectOptionDirective.decorators = [
            { type: core.Directive, args: [{ selector: '[ngx-select-option]' },] }
        ];
        /** @nocollapse */
        NgxSelectOptionDirective.ctorParameters = function () {
            return [
                { type: core.TemplateRef }
            ];
        };
        return NgxSelectOptionDirective;
    }());
    var NgxSelectOptionSelectedDirective = /** @class */ (function () {
        function NgxSelectOptionSelectedDirective(template) {
            this.template = template;
        }
        NgxSelectOptionSelectedDirective.decorators = [
            { type: core.Directive, args: [{ selector: '[ngx-select-option-selected]' },] }
        ];
        /** @nocollapse */
        NgxSelectOptionSelectedDirective.ctorParameters = function () {
            return [
                { type: core.TemplateRef }
            ];
        };
        return NgxSelectOptionSelectedDirective;
    }());
    var NgxSelectOptionNotFoundDirective = /** @class */ (function () {
        function NgxSelectOptionNotFoundDirective(template) {
            this.template = template;
        }
        NgxSelectOptionNotFoundDirective.decorators = [
            { type: core.Directive, args: [{ selector: '[ngx-select-option-not-found]' },] }
        ];
        /** @nocollapse */
        NgxSelectOptionNotFoundDirective.ctorParameters = function () {
            return [
                { type: core.TemplateRef }
            ];
        };
        return NgxSelectOptionNotFoundDirective;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
     */
    /** @type {?} */
    var _ = lodashNs;
    /** @type {?} */
    var escapeString$1 = escapeStringNs;
    /** @type {?} */
    var NGX_SELECT_OPTIONS = new core.InjectionToken('NGX_SELECT_OPTIONS');
    /** @enum {number} */
    var ENavigation = {
        first: 0, previous: 1, next: 2, last: 3,
        firstSelected: 4, firstIfOptionActiveInvisible: 5,
    };
    ENavigation[ENavigation.first] = 'first';
    ENavigation[ENavigation.previous] = 'previous';
    ENavigation[ENavigation.next] = 'next';
    ENavigation[ENavigation.last] = 'last';
    ENavigation[ENavigation.firstSelected] = 'firstSelected';
    ENavigation[ENavigation.firstIfOptionActiveInvisible] = 'firstIfOptionActiveInvisible';
    /**
     * @param {?} obj
     * @param {?} propertyName
     * @return {?}
     */
    function propertyExists(obj, propertyName) {
        return propertyName in obj;
    }
    var NgxSelectComponent = /** @class */ (function () {
        function NgxSelectComponent(iterableDiffers, sanitizer, cd, defaultOptions) {
            var _this = this;
            this.sanitizer = sanitizer;
            this.cd = cd;
            this.optionValueField = 'id';
            this.optionTextField = 'text';
            this.optGroupLabelField = 'label';
            this.optGroupOptionsField = 'options';
            this.multiple = false;
            this.allowClear = false;
            this.placeholder = '';
            this.noAutoComplete = false;
            this.disabled = false;
            this.defaultValue = [];
            this.autoSelectSingleOption = false;
            this.autoClearSearch = false;
            this.noResultsFound = 'No results found';
            this.size = 'default';
            this.autoActiveOnMouseEnter = true;
            this.isFocused = false;
            this.keyCodeToRemoveSelected = 'Delete';
            this.keyCodeToOptionsOpen = ['Enter', 'NumpadEnter'];
            this.keyCodeToOptionsClose = 'Escape';
            this.keyCodeToOptionsSelect = ['Enter', 'NumpadEnter'];
            this.keyCodeToNavigateFirst = 'ArrowLeft';
            this.keyCodeToNavigatePrevious = 'ArrowUp';
            this.keyCodeToNavigateNext = 'ArrowDown';
            this.keyCodeToNavigateLast = 'ArrowRight';
            this.typed = new core.EventEmitter();
            this.focus = new core.EventEmitter();
            this.blur = new core.EventEmitter();
            this.open = new core.EventEmitter();
            this.close = new core.EventEmitter();
            this.select = new core.EventEmitter();
            this.remove = new core.EventEmitter();
            this.navigated = new core.EventEmitter();
            this.selectionChanges = new core.EventEmitter();
            this.optionsOpened = false;
            this.actualValue = [];
            this.subjOptions = new rxjs.BehaviorSubject([]);
            this.subjSearchText = new rxjs.BehaviorSubject('');
            this.subjOptionsSelected = new rxjs.BehaviorSubject([]);
            this.subjExternalValue = new rxjs.BehaviorSubject([]);
            this.subjDefaultValue = new rxjs.BehaviorSubject([]);
            this.subjRegisterOnChange = new rxjs.Subject();
            this._focusToInput = false;
            this.onChange = function (v) { return v; };
            this.onTouched = function () { return null; };
            Object.assign(this, defaultOptions);
            // DIFFERS
            this.itemsDiffer = iterableDiffers.find([]).create(null);
            this.defaultValueDiffer = iterableDiffers.find([]).create(null);
            // OBSERVERS
            this.typed.subscribe(function (text) { return _this.subjSearchText.next(text); });
            this.subjOptionsSelected.subscribe(function (options) { return _this.selectionChanges.emit(options); });
            /** @type {?} */
            var cacheExternalValue;
            /** @type {?} */
            var subjActualValue = rxjs.combineLatest(rxjs.merge(this.subjExternalValue.pipe(operators.map(function (v) { return cacheExternalValue = v === null ? [] : [].concat(v); })), this.subjOptionsSelected.pipe(operators.map(function (options) { return options.map(function (o) { return o.value; }); }))), this.subjDefaultValue).pipe(operators.map(function (_a) {
                var _b = __read(_a, 2), eVal = _b[0], dVal = _b[1];
                /** @type {?} */
                var newVal = _.isEqual(eVal, dVal) ? [] : eVal;
                return newVal.length ? newVal : dVal;
            }), operators.distinctUntilChanged(function (x, y) { return _.isEqual(x, y); }), operators.share());
            // Export actual value
            rxjs.combineLatest(subjActualValue, this.subjRegisterOnChange)
                .pipe(operators.map(function (_a) {
                var _b = __read(_a, 1), actualValue = _b[0];
                return actualValue;
            }))
                .subscribe(function (actualValue) {
                _this.actualValue = actualValue;
                if (!_.isEqual(actualValue, cacheExternalValue)) {
                    cacheExternalValue = actualValue;
                    if (_this.multiple) {
                        _this.onChange(actualValue);
                    }
                    else {
                        _this.onChange(actualValue.length ? actualValue[0] : null);
                    }
                }
            });
            // Correct selected options when the options changed
            rxjs.combineLatest(this.subjOptions.pipe(operators.flatMap(function (options) {
                return rxjs.from(options).pipe(operators.flatMap(function (option) {
                    return option instanceof NgxSelectOption
                        ? rxjs.of(option)
                        : (option instanceof NgxSelectOptGroup ? rxjs.from(option.options) : rxjs.EMPTY);
                }), operators.toArray());
            })), subjActualValue).pipe(operators.map(function (_a) {
                var _b = __read(_a, 2), optionsFlat = _b[0], actualValue = _b[1];
                /** @type {?} */
                var optionsSelected = [];
                actualValue.forEach(function (value) {
                    /** @type {?} */
                    var selectedOption = optionsFlat.find(function (option) { return option.value === value; });
                    if (selectedOption) {
                        optionsSelected.push(selectedOption);
                    }
                });
                if (_this.keepSelectedItems) {
                    /** @type {?} */
                    var optionValues_1 = optionsSelected.map(function (option) { return option.value; });
                    /** @type {?} */
                    var keptSelectedOptions = _this.subjOptionsSelected.value
                        .filter(function (selOption) { return optionValues_1.indexOf(selOption.value) === -1; });
                    optionsSelected.push.apply(optionsSelected, __spread(keptSelectedOptions));
                }
                if (!_.isEqual(optionsSelected, _this.subjOptionsSelected.value)) {
                    _this.subjOptionsSelected.next(optionsSelected);
                    _this.cd.markForCheck();
                }
            })).subscribe();
            // Ensure working filter by a search text
            rxjs.combineLatest(this.subjOptions, this.subjOptionsSelected, this.subjSearchText).pipe(operators.map(function (_a) {
                var _b = __read(_a, 3), options = _b[0], selectedOptions = _b[1], search = _b[2];
                _this.optionsFiltered = _this.filterOptions(search, options, selectedOptions).map(function (option) {
                    if (option instanceof NgxSelectOption) {
                        option.highlightedText = _this.highlightOption(option);
                    }
                    else if (option instanceof NgxSelectOptGroup) {
                        option.options.map(function (subOption) {
                            subOption.highlightedText = _this.highlightOption(subOption);
                            return subOption;
                        });
                    }
                    return option;
                });
                _this.cacheOptionsFilteredFlat = null;
                _this.navigateOption(ENavigation.firstIfOptionActiveInvisible);
                _this.cd.markForCheck();
                return selectedOptions;
            }), operators.flatMap(function (selectedOptions) { return _this.optionsFilteredFlat().pipe(operators.filter(function (flatOptions) { return _this.autoSelectSingleOption && flatOptions.length === 1 && !selectedOptions.length; })); })).subscribe(function (flatOptions) {
                _this.subjOptionsSelected.next(flatOptions);
                _this.cd.markForCheck();
            });
        }
        Object.defineProperty(NgxSelectComponent.prototype, "inputText", {
            get: /**
             * \@internal
             * @return {?}
             */ function () {
                if (this.inputElRef && this.inputElRef.nativeElement) {
                    return this.inputElRef.nativeElement.value;
                }
                return '';
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @param {?=} otherClassNames
         * @param {?=} useFormControl
         * @return {?}
         */
        NgxSelectComponent.prototype.setFormControlSize = /**
         * @param {?=} otherClassNames
         * @param {?=} useFormControl
         * @return {?}
         */
            function (otherClassNames, useFormControl) {
                if (otherClassNames === void 0) {
                    otherClassNames = {};
                }
                if (useFormControl === void 0) {
                    useFormControl = true;
                }
                /** @type {?} */
                var formControlExtraClasses = useFormControl ? {
                    'form-control-sm input-sm': this.size === 'small',
                    'form-control-lg input-lg': this.size === 'large'
                } : {};
                return Object.assign(formControlExtraClasses, otherClassNames);
            };
        /**
         * @return {?}
         */
        NgxSelectComponent.prototype.setBtnSize = /**
         * @return {?}
         */
            function () {
                return { 'btn-sm': this.size === 'small', 'btn-lg': this.size === 'large' };
            };
        Object.defineProperty(NgxSelectComponent.prototype, "optionsSelected", {
            get: /**
             * @return {?}
             */ function () {
                return this.subjOptionsSelected.value;
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @param {?} event
         * @return {?}
         */
        NgxSelectComponent.prototype.mainClicked = /**
         * @param {?} event
         * @return {?}
         */
            function (event) {
                event.clickedSelectComponent = this;
                if (!this.isFocused) {
                    this.isFocused = true;
                    this.focus.emit();
                }
            };
        /**
         * @param {?} event
         * @return {?}
         */
        NgxSelectComponent.prototype.documentClick = /**
         * @param {?} event
         * @return {?}
         */
            function (event) {
                if (event.clickedSelectComponent !== this) {
                    if (this.optionsOpened) {
                        this.optionsClose();
                        this.cd.detectChanges(); // fix error because of delay between different events
                    }
                    if (this.isFocused) {
                        this.isFocused = false;
                        this.blur.emit();
                    }
                }
            };
        /**
         * @return {?}
         */
        NgxSelectComponent.prototype.optionsFilteredFlat = /**
         * @return {?}
         */
            function () {
                var _this = this;
                if (this.cacheOptionsFilteredFlat) {
                    return rxjs.of(this.cacheOptionsFilteredFlat);
                }
                return rxjs.from(this.optionsFiltered).pipe(operators.flatMap(function (option) {
                    return option instanceof NgxSelectOption ? rxjs.of(option) :
                        (option instanceof NgxSelectOptGroup ? rxjs.from(option.optionsFiltered) : rxjs.EMPTY);
                }), operators.filter(function (optionsFilteredFlat) { return !optionsFilteredFlat.disabled; }), operators.toArray(), operators.tap(function (optionsFilteredFlat) { return _this.cacheOptionsFilteredFlat = optionsFilteredFlat; }));
            };
        /**
         * @param {?} navigation
         * @return {?}
         */
        NgxSelectComponent.prototype.navigateOption = /**
         * @param {?} navigation
         * @return {?}
         */
            function (navigation) {
                var _this = this;
                this.optionsFilteredFlat().pipe(operators.map(function (options) {
                    /** @type {?} */
                    var navigated = { index: -1, activeOption: null, filteredOptionList: options };
                    /** @type {?} */
                    var newActiveIdx;
                    switch (navigation) {
                        case ENavigation.first:
                            navigated.index = 0;
                            break;
                        case ENavigation.previous:
                            newActiveIdx = options.indexOf(_this.optionActive) - 1;
                            navigated.index = newActiveIdx >= 0 ? newActiveIdx : options.length - 1;
                            break;
                        case ENavigation.next:
                            newActiveIdx = options.indexOf(_this.optionActive) + 1;
                            navigated.index = newActiveIdx < options.length ? newActiveIdx : 0;
                            break;
                        case ENavigation.last:
                            navigated.index = options.length - 1;
                            break;
                        case ENavigation.firstSelected:
                            if (_this.subjOptionsSelected.value.length) {
                                navigated.index = options.indexOf(_this.subjOptionsSelected.value[0]);
                            }
                            break;
                        case ENavigation.firstIfOptionActiveInvisible:
                            /** @type {?} */
                            var idxOfOptionActive = -1;
                            if (_this.optionActive) {
                                idxOfOptionActive = options.indexOf(options.find(function (x) { return x.value === _this.optionActive.value; }));
                            }
                            navigated.index = idxOfOptionActive > 0 ? idxOfOptionActive : 0;
                            break;
                    }
                    navigated.activeOption = options[navigated.index];
                    return navigated;
                })).subscribe(function (newNavigated) { return _this.optionActivate(newNavigated); });
            };
        /**
         * @return {?}
         */
        NgxSelectComponent.prototype.ngDoCheck = /**
         * @return {?}
         */
            function () {
                if (this.itemsDiffer.diff(this.items)) {
                    this.subjOptions.next(this.buildOptions(this.items));
                }
                /** @type {?} */
                var defVal = this.defaultValue ? [].concat(this.defaultValue) : [];
                if (this.defaultValueDiffer.diff(defVal)) {
                    this.subjDefaultValue.next(defVal);
                }
            };
        /**
         * @return {?}
         */
        NgxSelectComponent.prototype.ngAfterContentChecked = /**
         * @return {?}
         */
            function () {
                if (this._focusToInput && this.checkInputVisibility() && this.inputElRef &&
                    this.inputElRef.nativeElement !== document.activeElement) {
                    this._focusToInput = false;
                    this.inputElRef.nativeElement.focus();
                }
                if (this.choiceMenuElRef) {
                    /** @type {?} */
                    var ulElement = /** @type {?} */ (this.choiceMenuElRef.nativeElement);
                    /** @type {?} */
                    var element = /** @type {?} */ (ulElement.querySelector('a.ngx-select__item_active.active'));
                    if (element && element.offsetHeight > 0) {
                        this.ensureVisibleElement(element);
                    }
                }
            };
        /**
         * @return {?}
         */
        NgxSelectComponent.prototype.canClearNotMultiple = /**
         * @return {?}
         */
            function () {
                return this.allowClear && !!this.subjOptionsSelected.value.length &&
                    (!this.subjDefaultValue.value.length || this.subjDefaultValue.value[0] !== this.actualValue[0]);
            };
        /**
         * @return {?}
         */
        NgxSelectComponent.prototype.focusToInput = /**
         * @return {?}
         */
            function () {
                this._focusToInput = true;
            };
        /**
         * @param {?} event
         * @return {?}
         */
        NgxSelectComponent.prototype.inputKeyDown = /**
         * @param {?} event
         * @return {?}
         */
            function (event) {
                /** @type {?} */
                var keysForOpenedState = [].concat(this.keyCodeToOptionsSelect, this.keyCodeToNavigateFirst, this.keyCodeToNavigatePrevious, this.keyCodeToNavigateNext, this.keyCodeToNavigateLast);
                /** @type {?} */
                var keysForClosedState = [].concat(this.keyCodeToOptionsOpen, this.keyCodeToRemoveSelected);
                if (this.optionsOpened && keysForOpenedState.indexOf(event.code) !== -1) {
                    event.preventDefault();
                    event.stopPropagation();
                    switch (event.code) {
                        case ([].concat(this.keyCodeToOptionsSelect).indexOf(event.code) + 1) && event.code:
                            this.optionSelect(this.optionActive);
                            this.navigateOption(ENavigation.next);
                            break;
                        case this.keyCodeToNavigateFirst:
                            this.navigateOption(ENavigation.first);
                            break;
                        case this.keyCodeToNavigatePrevious:
                            this.navigateOption(ENavigation.previous);
                            break;
                        case this.keyCodeToNavigateLast:
                            this.navigateOption(ENavigation.last);
                            break;
                        case this.keyCodeToNavigateNext:
                            this.navigateOption(ENavigation.next);
                            break;
                    }
                }
                else if (!this.optionsOpened && keysForClosedState.indexOf(event.code) !== -1) {
                    event.preventDefault();
                    event.stopPropagation();
                    switch (event.code) {
                        case ([].concat(this.keyCodeToOptionsOpen).indexOf(event.code) + 1) && event.code:
                            this.optionsOpen();
                            break;
                        case this.keyCodeToRemoveSelected:
                            this.optionRemove(this.subjOptionsSelected.value[this.subjOptionsSelected.value.length - 1], event);
                            break;
                    }
                }
            };
        /**
         * @param {?} index
         * @param {?} option
         * @return {?}
         */
        NgxSelectComponent.prototype.trackByOption = /**
         * @param {?} index
         * @param {?} option
         * @return {?}
         */
            function (index, option) {
                return option instanceof NgxSelectOption ? option.value :
                    (option instanceof NgxSelectOptGroup ? option.label : option);
            };
        /**
         * @return {?}
         */
        NgxSelectComponent.prototype.checkInputVisibility = /**
         * @return {?}
         */
            function () {
                return (this.multiple === true) || (this.optionsOpened && !this.noAutoComplete);
            };
        /**
         * \@internal
         * @param {?=} value
         * @param {?=} event
         * @return {?}
         */
        NgxSelectComponent.prototype.inputKeyUp = /**
         * \@internal
         * @param {?=} value
         * @param {?=} event
         * @return {?}
         */
            function (value, event) {
                if (value === void 0) {
                    value = '';
                }
                if (event.code === this.keyCodeToOptionsClose) {
                    this.optionsClose();
                }
                else if (this.optionsOpened && (['ArrowDown', 'ArrowUp', 'ArrowLeft', 'ArrowDown'].indexOf(event.code) === -1) /*ignore arrows*/) {
                    this.typed.emit(value);
                }
                else if (!this.optionsOpened && value) {
                    this.optionsOpen(value);
                }
            };
        /**
         * \@internal
         * @param {?=} value
         * @return {?}
         */
        NgxSelectComponent.prototype.inputClick = /**
         * \@internal
         * @param {?=} value
         * @return {?}
         */
            function (value) {
                if (value === void 0) {
                    value = '';
                }
                if (!this.optionsOpened) {
                    this.optionsOpen(value);
                }
            };
        /**
         * \@internal
         * @param {?} html
         * @return {?}
         */
        NgxSelectComponent.prototype.sanitize = /**
         * \@internal
         * @param {?} html
         * @return {?}
         */
            function (html) {
                return html ? this.sanitizer.bypassSecurityTrustHtml(html) : null;
            };
        /**
         * \@internal
         * @param {?} option
         * @return {?}
         */
        NgxSelectComponent.prototype.highlightOption = /**
         * \@internal
         * @param {?} option
         * @return {?}
         */
            function (option) {
                if (this.inputElRef) {
                    return option.renderText(this.sanitizer, this.inputElRef.nativeElement.value);
                }
                return option.renderText(this.sanitizer, '');
            };
        /**
         * \@internal
         * @param {?} option
         * @param {?=} event
         * @return {?}
         */
        NgxSelectComponent.prototype.optionSelect = /**
         * \@internal
         * @param {?} option
         * @param {?=} event
         * @return {?}
         */
            function (option, event) {
                if (event === void 0) {
                    event = null;
                }
                if (event) {
                    event.preventDefault();
                    event.stopPropagation();
                }
                if (option && !option.disabled) {
                    this.subjOptionsSelected.next((this.multiple ? this.subjOptionsSelected.value : []).concat([option]));
                    this.select.emit(option.value);
                    this.optionsClose();
                    this.onTouched();
                }
            };
        /**
         * \@internal
         * @param {?} option
         * @param {?} event
         * @return {?}
         */
        NgxSelectComponent.prototype.optionRemove = /**
         * \@internal
         * @param {?} option
         * @param {?} event
         * @return {?}
         */
            function (option, event) {
                if (!this.disabled && option) {
                    event.stopPropagation();
                    this.subjOptionsSelected.next((this.multiple ? this.subjOptionsSelected.value : []).filter(function (o) { return o !== option; }));
                    this.remove.emit(option.value);
                }
            };
        /**
         * \@internal
         * @param {?} navigated
         * @return {?}
         */
        NgxSelectComponent.prototype.optionActivate = /**
         * \@internal
         * @param {?} navigated
         * @return {?}
         */
            function (navigated) {
                if ((this.optionActive !== navigated.activeOption) &&
                    (!navigated.activeOption || !navigated.activeOption.disabled)) {
                    if (this.optionActive) {
                        this.optionActive.active = false;
                    }
                    this.optionActive = navigated.activeOption;
                    if (this.optionActive) {
                        this.optionActive.active = true;
                    }
                    this.navigated.emit(navigated);
                    this.cd.detectChanges();
                }
            };
        /**
         * \@internal
         * @param {?} navigated
         * @return {?}
         */
        NgxSelectComponent.prototype.onMouseEnter = /**
         * \@internal
         * @param {?} navigated
         * @return {?}
         */
            function (navigated) {
                var _this = this;
                document.onmousemove = function () {
                    if (_this.autoActiveOnMouseEnter) {
                        _this.optionActivate(navigated);
                    }
                };
            };
        /**
         * @param {?} search
         * @param {?} options
         * @param {?} selectedOptions
         * @return {?}
         */
        NgxSelectComponent.prototype.filterOptions = /**
         * @param {?} search
         * @param {?} options
         * @param {?} selectedOptions
         * @return {?}
         */
            function (search, options, selectedOptions) {
                var _this = this;
                /** @type {?} */
                var regExp = new RegExp(escapeString$1(search), 'i');
                /** @type {?} */
                var filterOption = function (option) {
                    if (_this.searchCallback) {
                        return _this.searchCallback(search, option);
                    }
                    return (!search || regExp.test(option.text)) && (!_this.multiple || selectedOptions.indexOf(option) === -1);
                };
                return options.filter(function (option) {
                    if (option instanceof NgxSelectOption) {
                        return filterOption(/** @type {?} */ (option));
                    }
                    else if (option instanceof NgxSelectOptGroup) {
                        /** @type {?} */
                        var subOp = /** @type {?} */ (option);
                        subOp.filter(function (subOption) { return filterOption(subOption); });
                        return subOp.optionsFiltered.length;
                    }
                });
            };
        /**
         * @param {?} element
         * @return {?}
         */
        NgxSelectComponent.prototype.ensureVisibleElement = /**
         * @param {?} element
         * @return {?}
         */
            function (element) {
                if (this.choiceMenuElRef && this.cacheElementOffsetTop !== element.offsetTop) {
                    this.cacheElementOffsetTop = element.offsetTop;
                    /** @type {?} */
                    var container = this.choiceMenuElRef.nativeElement;
                    if (this.cacheElementOffsetTop < container.scrollTop) {
                        container.scrollTop = this.cacheElementOffsetTop;
                    }
                    else if (this.cacheElementOffsetTop + element.offsetHeight > container.scrollTop + container.clientHeight) {
                        container.scrollTop = this.cacheElementOffsetTop + element.offsetHeight - container.clientHeight;
                    }
                }
            };
        /**
         * @param {?=} search
         * @return {?}
         */
        NgxSelectComponent.prototype.optionsOpen = /**
         * @param {?=} search
         * @return {?}
         */
            function (search) {
                if (search === void 0) {
                    search = '';
                }
                if (!this.disabled) {
                    this.optionsOpened = true;
                    this.subjSearchText.next(search);
                    if (!this.multiple && this.subjOptionsSelected.value.length) {
                        this.navigateOption(ENavigation.firstSelected);
                    }
                    else {
                        this.navigateOption(ENavigation.first);
                    }
                    this.focusToInput();
                    this.open.emit();
                    this.cd.markForCheck();
                }
            };
        /**
         * @return {?}
         */
        NgxSelectComponent.prototype.optionsClose = /**
         * @return {?}
         */
            function () {
                this.optionsOpened = false;
                // if (focusToHost) {
                //     const x = window.scrollX, y = window.scrollY;
                //     this.mainElRef.nativeElement.focus();
                //     window.scrollTo(x, y);
                // }
                this.close.emit();
                if (this.autoClearSearch && this.multiple && this.inputElRef) {
                    this.inputElRef.nativeElement.value = null;
                }
            };
        /**
         * @param {?} data
         * @return {?}
         */
        NgxSelectComponent.prototype.buildOptions = /**
         * @param {?} data
         * @return {?}
         */
            function (data) {
                var _this = this;
                /** @type {?} */
                var result = [];
                if (Array.isArray(data)) {
                    /** @type {?} */
                    var option_1 = void 0;
                    data.forEach(function (item) {
                        /** @type {?} */
                        var isOptGroup = typeof item === 'object' && item !== null &&
                            propertyExists(item, _this.optGroupLabelField) && propertyExists(item, _this.optGroupOptionsField) &&
                            Array.isArray(item[_this.optGroupOptionsField]);
                        if (isOptGroup) {
                            /** @type {?} */
                            var optGroup_1 = new NgxSelectOptGroup(item[_this.optGroupLabelField]);
                            item[_this.optGroupOptionsField].forEach(function (subOption) {
                                if (option_1 = _this.buildOption(subOption, optGroup_1)) {
                                    optGroup_1.options.push(option_1);
                                }
                            });
                            result.push(optGroup_1);
                        }
                        else if (option_1 = _this.buildOption(item, null)) {
                            result.push(option_1);
                        }
                    });
                }
                return result;
            };
        /**
         * @param {?} data
         * @param {?} parent
         * @return {?}
         */
        NgxSelectComponent.prototype.buildOption = /**
         * @param {?} data
         * @param {?} parent
         * @return {?}
         */
            function (data, parent) {
                /** @type {?} */
                var value;
                /** @type {?} */
                var text;
                /** @type {?} */
                var disabled;
                if (typeof data === 'string' || typeof data === 'number') {
                    value = text = data;
                    disabled = false;
                }
                else if (typeof data === 'object' && data !== null &&
                    (propertyExists(data, this.optionValueField) || propertyExists(data, this.optionTextField))) {
                    value = propertyExists(data, this.optionValueField) ? data[this.optionValueField] : data[this.optionTextField];
                    text = propertyExists(data, this.optionTextField) ? data[this.optionTextField] : data[this.optionValueField];
                    disabled = propertyExists(data, 'disabled') ? data['disabled'] : false;
                }
                else {
                    return null;
                }
                return new NgxSelectOption(value, text, disabled, data, parent);
            };
        /**
         * @param {?} obj
         * @return {?}
         */
        NgxSelectComponent.prototype.writeValue = /**
         * @param {?} obj
         * @return {?}
         */
            function (obj) {
                this.subjExternalValue.next(obj);
            };
        /**
         * @param {?} fn
         * @return {?}
         */
        NgxSelectComponent.prototype.registerOnChange = /**
         * @param {?} fn
         * @return {?}
         */
            function (fn) {
                this.onChange = fn;
                this.subjRegisterOnChange.next();
            };
        /**
         * @param {?} fn
         * @return {?}
         */
        NgxSelectComponent.prototype.registerOnTouched = /**
         * @param {?} fn
         * @return {?}
         */
            function (fn) {
                this.onTouched = fn;
            };
        /**
         * @param {?} isDisabled
         * @return {?}
         */
        NgxSelectComponent.prototype.setDisabledState = /**
         * @param {?} isDisabled
         * @return {?}
         */
            function (isDisabled) {
                this.disabled = isDisabled;
                this.cd.markForCheck();
            };
        NgxSelectComponent.decorators = [
            { type: core.Component, args: [{
                        selector: 'ngx-select',
                        template: "<div #main [tabindex]=\"disabled? -1: 0\" class=\"ngx-select dropdown\"\n     [ngClass]=\"setFormControlSize({\n        'ngx-select_multiple form-control': multiple === true,\n        'open show': optionsOpened && optionsFiltered.length\n     }, multiple === true)\"\n     (click)=\"mainClicked($event)\" (focusin)=\"mainClicked($event)\"\n     (focus)=\"focusToInput()\" (keydown)=\"inputKeyDown($event)\">\n    <div [ngClass]=\"{ 'ngx-select__disabled': disabled}\"></div>\n\n    <!-- single selected item -->\n    <div class=\"ngx-select__selected\"\n         *ngIf=\"(multiple === false) && (!optionsOpened || noAutoComplete)\">\n        <div class=\"ngx-select__toggle btn form-control\" [ngClass]=\"setFormControlSize(setBtnSize())\"\n             (click)=\"optionsOpen()\">\n\n            <span *ngIf=\"!optionsSelected.length\" class=\"ngx-select__placeholder text-muted\">\n                <span [innerHtml]=\"placeholder\"></span>\n            </span>\n            <span *ngIf=\"optionsSelected.length\"\n                  class=\"ngx-select__selected-single pull-left float-left\"\n                  [ngClass]=\"{'ngx-select__allow-clear': allowClear}\">\n                <ng-container [ngTemplateOutlet]=\"templateSelectedOption || defaultTemplateOption\"\n                              [ngTemplateOutletContext]=\"{$implicit: optionsSelected[0], index: 0,\n                                                          text: sanitize(optionsSelected[0].text)}\">\n                </ng-container>\n            </span>\n            <span class=\"ngx-select__toggle-buttons\">\n                <a class=\"ngx-select__clear btn btn-sm btn-link\" *ngIf=\"canClearNotMultiple()\"\n                   [ngClass]=\"setBtnSize()\"\n                   (click)=\"optionRemove(optionsSelected[0], $event)\">\n                    <i class=\"ngx-select__clear-icon\"></i>\n                </a>\n                <i class=\"dropdown-toggle\"></i>\n                <i class=\"ngx-select__toggle-caret caret\"></i>\n            </span>\n        </div>\n    </div>\n\n    <!-- multiple selected items -->\n    <div class=\"ngx-select__selected\" *ngIf=\"multiple === true\">\n        <span *ngFor=\"let option of optionsSelected; trackBy: trackByOption; let idx = index\">\n            <span tabindex=\"-1\" [ngClass]=\"setBtnSize()\"\n                  class=\"ngx-select__selected-plural btn btn-default btn-secondary btn-xs\">\n\n                <ng-container [ngTemplateOutlet]=\"templateSelectedOption || defaultTemplateOption\"\n                              [ngTemplateOutletContext]=\"{$implicit: option, index: idx, text: sanitize(option.text)}\">\n                </ng-container>\n\n                <a class=\"ngx-select__clear btn btn-sm btn-link pull-right float-right\" [ngClass]=\"setBtnSize()\"\n                   (click)=\"optionRemove(option, $event)\">\n                    <i class=\"ngx-select__clear-icon\"></i>\n                </a>\n            </span>\n        </span>\n    </div>\n\n    <!-- live search an item from the list -->\n    <input #input type=\"text\" class=\"ngx-select__search form-control\" [ngClass]=\"setFormControlSize()\"\n           *ngIf=\"checkInputVisibility()\"\n           [tabindex]=\"multiple === false? -1: 0\"\n           (keyup)=\"inputKeyUp(input.value, $event)\"\n           [disabled]=\"disabled\"\n           [placeholder]=\"optionsSelected.length? '': placeholder\"\n           (click)=\"inputClick(input.value)\"\n           autocomplete=\"off\"\n           autocorrect=\"off\"\n           autocapitalize=\"off\"\n           spellcheck=\"false\"\n           role=\"combobox\">\n\n    <!-- options template -->\n    <ul #choiceMenu role=\"menu\" *ngIf=\"isFocused\" class=\"ngx-select__choices dropdown-menu\"\n        [class.show]=\"optionsOpened && subjOptions.value.length\">\n        <li class=\"ngx-select__item-group\" role=\"menuitem\"\n            *ngFor=\"let opt of optionsFiltered; trackBy: trackByOption; let idxGroup=index\">\n            <div class=\"divider dropdown-divider\" *ngIf=\"opt.type === 'optgroup' && (idxGroup > 0)\"></div>\n            <div class=\"dropdown-header\" *ngIf=\"opt.type === 'optgroup'\">{{opt.label}}</div>\n\n            <a href=\"#\" #choiceItem class=\"ngx-select__item dropdown-item\"\n               *ngFor=\"let option of (opt.optionsFiltered || [opt]); trackBy: trackByOption; let idxOption = index\"\n               [ngClass]=\"{\n                    'ngx-select__item_active active': option.active,\n                    'ngx-select__item_disabled disabled': option.disabled\n               }\"\n               (mouseenter)=\"onMouseEnter({\n                    activeOption: option,\n                    filteredOptionList: optionsFiltered,\n                    index: optionsFiltered.indexOf(option)\n               })\"\n               (click)=\"optionSelect(option, $event)\">\n                <ng-container [ngTemplateOutlet]=\"templateOption || defaultTemplateOption\"\n                              [ngTemplateOutletContext]=\"{$implicit: option, text: option.highlightedText,\n                              index: idxGroup, subIndex: idxOption}\"></ng-container>\n            </a>\n        </li>\n        <li class=\"ngx-select__item ngx-select__item_no-found dropdown-header\" *ngIf=\"!optionsFiltered.length\">\n            <ng-container [ngTemplateOutlet]=\"templateOptionNotFound || defaultTemplateOptionNotFound\"\n                          [ngTemplateOutletContext]=\"{$implicit: inputText}\"></ng-container>\n        </li>\n    </ul>\n\n    <!--Default templates-->\n    <ng-template #defaultTemplateOption let-text=\"text\">\n        <span [innerHtml]=\"text\"></span>\n    </ng-template>\n\n    <ng-template #defaultTemplateOptionNotFound>\n        {{noResultsFound}}\n    </ng-template>\n\n</div>\n",
                        changeDetection: core.ChangeDetectionStrategy.OnPush,
                        providers: [
                            {
                                provide: forms.NG_VALUE_ACCESSOR,
                                useExisting: core.forwardRef(function () { return NgxSelectComponent; }),
                                multi: true
                            }
                        ],
                        styles: [".ngx-select_multiple{height:auto;padding:3px 3px 0}.ngx-select_multiple .ngx-select__search{background-color:transparent!important;border:none;outline:0;box-shadow:none;height:1.6666em;padding:0;margin-bottom:3px}.ngx-select__disabled{background-color:#eceeef;border-radius:4px;position:absolute;width:100%;height:100%;z-index:5;opacity:.6;top:0;left:0;cursor:not-allowed}.ngx-select__toggle{outline:0;position:relative;text-align:left!important;color:#333;background-color:#fff;border-color:#ccc;display:inline-flex;align-items:stretch;justify-content:space-between}.ngx-select__toggle:hover{color:#333;background-color:#e6e6e6;border-color:#adadad}.ngx-select__toggle-buttons{flex-shrink:0;display:flex;align-items:center}.ngx-select__toggle-caret{position:absolute;height:10px;top:50%;right:10px;margin-top:-2px}.ngx-select__placeholder{float:left;max-width:100%;text-overflow:ellipsis;overflow:hidden}.ngx-select__clear{margin-right:10px;padding:0;border:none}.ngx-select_multiple .ngx-select__clear{line-height:initial;margin-left:5px;margin-right:0;color:#000;opacity:.5}.ngx-select__clear-icon{display:inline-block;font-size:inherit;cursor:pointer;position:relative;width:1em;height:.75em;padding:0}.ngx-select__clear-icon:after,.ngx-select__clear-icon:before{content:'';position:absolute;border-top:3px solid;width:100%;top:50%;left:0;margin-top:-1px}.ngx-select__clear-icon:before{-webkit-transform:rotate(45deg);transform:rotate(45deg)}.ngx-select__clear-icon:after{-webkit-transform:rotate(-45deg);transform:rotate(-45deg)}.ngx-select__choices{width:100%;height:auto;max-height:200px;overflow-x:hidden;margin-top:0;position:absolute}.ngx-select_multiple .ngx-select__choices{margin-top:1px}.ngx-select__item{display:block;padding:3px 20px;clear:both;font-weight:400;line-height:1.42857143;white-space:nowrap;cursor:pointer;text-decoration:none}.ngx-select__item_disabled,.ngx-select__item_no-found{cursor:default}.ngx-select__item_active{color:#fff;outline:0;background-color:#428bca}.ngx-select__selected-plural,.ngx-select__selected-single{display:inline-flex;align-items:center;overflow:hidden}.ngx-select__selected-plural span,.ngx-select__selected-single span{overflow:hidden;text-overflow:ellipsis}.ngx-select__selected-plural{outline:0;margin:0 3px 3px 0}.input-group>.dropdown{position:static}"]
                    }] }
        ];
        /** @nocollapse */
        NgxSelectComponent.ctorParameters = function () {
            return [
                { type: core.IterableDiffers },
                { type: platformBrowser.DomSanitizer },
                { type: core.ChangeDetectorRef },
                { type: undefined, decorators: [{ type: core.Inject, args: [NGX_SELECT_OPTIONS,] }, { type: core.Optional }] }
            ];
        };
        NgxSelectComponent.propDecorators = {
            items: [{ type: core.Input }],
            optionValueField: [{ type: core.Input }],
            optionTextField: [{ type: core.Input }],
            optGroupLabelField: [{ type: core.Input }],
            optGroupOptionsField: [{ type: core.Input }],
            multiple: [{ type: core.Input }],
            allowClear: [{ type: core.Input }],
            placeholder: [{ type: core.Input }],
            noAutoComplete: [{ type: core.Input }],
            disabled: [{ type: core.Input }],
            defaultValue: [{ type: core.Input }],
            autoSelectSingleOption: [{ type: core.Input }],
            autoClearSearch: [{ type: core.Input }],
            noResultsFound: [{ type: core.Input }],
            keepSelectedItems: [{ type: core.Input }],
            size: [{ type: core.Input }],
            searchCallback: [{ type: core.Input }],
            autoActiveOnMouseEnter: [{ type: core.Input }],
            isFocused: [{ type: core.Input }],
            typed: [{ type: core.Output }],
            focus: [{ type: core.Output }],
            blur: [{ type: core.Output }],
            open: [{ type: core.Output }],
            close: [{ type: core.Output }],
            select: [{ type: core.Output }],
            remove: [{ type: core.Output }],
            navigated: [{ type: core.Output }],
            selectionChanges: [{ type: core.Output }],
            mainElRef: [{ type: core.ViewChild, args: ['main',] }],
            inputElRef: [{ type: core.ViewChild, args: ['input',] }],
            choiceMenuElRef: [{ type: core.ViewChild, args: ['choiceMenu',] }],
            templateOption: [{ type: core.ContentChild, args: [NgxSelectOptionDirective, { read: core.TemplateRef },] }],
            templateSelectedOption: [{ type: core.ContentChild, args: [NgxSelectOptionSelectedDirective, { read: core.TemplateRef },] }],
            templateOptionNotFound: [{ type: core.ContentChild, args: [NgxSelectOptionNotFoundDirective, { read: core.TemplateRef },] }],
            documentClick: [{ type: core.HostListener, args: ['document:focusin', ['$event'],] }, { type: core.HostListener, args: ['document:click', ['$event'],] }]
        };
        return NgxSelectComponent;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
     */
    var NgxSelectModule = /** @class */ (function () {
        function NgxSelectModule() {
        }
        /**
         * @param {?} options
         * @return {?}
         */
        NgxSelectModule.forRoot = /**
         * @param {?} options
         * @return {?}
         */
            function (options) {
                return {
                    ngModule: NgxSelectModule,
                    providers: [{ provide: NGX_SELECT_OPTIONS, useValue: options }]
                };
            };
        NgxSelectModule.decorators = [
            { type: core.NgModule, args: [{
                        imports: [
                            common.CommonModule
                        ],
                        declarations: [NgxSelectComponent,
                            NgxSelectOptionDirective, NgxSelectOptionSelectedDirective, NgxSelectOptionNotFoundDirective
                        ],
                        exports: [NgxSelectComponent,
                            NgxSelectOptionDirective, NgxSelectOptionSelectedDirective, NgxSelectOptionNotFoundDirective
                        ]
                    },] }
        ];
        return NgxSelectModule;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
     */

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
     */

    exports.NgxSelectModule = NgxSelectModule;
    exports.NGX_SELECT_OPTIONS = NGX_SELECT_OPTIONS;
    exports.NgxSelectComponent = NgxSelectComponent;
    exports.NgxSelectOption = NgxSelectOption;
    exports.NgxSelectOptGroup = NgxSelectOptGroup;
    exports.NgxSelectOptionDirective = NgxSelectOptionDirective;
    exports.NgxSelectOptionSelectedDirective = NgxSelectOptionSelectedDirective;
    exports.NgxSelectOptionNotFoundDirective = NgxSelectOptionNotFoundDirective;

    Object.defineProperty(exports, '__esModule', { value: true });

})));

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LXNlbGVjdC1leC51bWQuanMubWFwIiwic291cmNlcyI6WyJub2RlX21vZHVsZXMvdHNsaWIvdHNsaWIuZXM2LmpzIiwibmc6Ly9uZ3gtc2VsZWN0LWV4L25neC1zZWxlY3Qvbmd4LXNlbGVjdC5jbGFzc2VzLnRzIiwibmc6Ly9uZ3gtc2VsZWN0LWV4L25neC1zZWxlY3Qvbmd4LXRlbXBsYXRlcy5kaXJlY3RpdmUudHMiLCJuZzovL25neC1zZWxlY3QtZXgvbmd4LXNlbGVjdC9uZ3gtc2VsZWN0LmNvbXBvbmVudC50cyIsIm5nOi8vbmd4LXNlbGVjdC1leC9uZ3gtc2VsZWN0L25neC1zZWxlY3QubW9kdWxlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qISAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxyXG5Db3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cclxuTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTsgeW91IG1heSBub3QgdXNlXHJcbnRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlXHJcbkxpY2Vuc2UgYXQgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcblxyXG5USElTIENPREUgSVMgUFJPVklERUQgT04gQU4gKkFTIElTKiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZXHJcbktJTkQsIEVJVEhFUiBFWFBSRVNTIE9SIElNUExJRUQsIElOQ0xVRElORyBXSVRIT1VUIExJTUlUQVRJT04gQU5ZIElNUExJRURcclxuV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIFRJVExFLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSxcclxuTUVSQ0hBTlRBQkxJVFkgT1IgTk9OLUlORlJJTkdFTUVOVC5cclxuXHJcblNlZSB0aGUgQXBhY2hlIFZlcnNpb24gMi4wIExpY2Vuc2UgZm9yIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9uc1xyXG5hbmQgbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqICovXHJcbi8qIGdsb2JhbCBSZWZsZWN0LCBQcm9taXNlICovXHJcblxyXG52YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uKGQsIGIpIHtcclxuICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcclxuICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XHJcbiAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07XHJcbiAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxufTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2V4dGVuZHMoZCwgYikge1xyXG4gICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxuICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxyXG4gICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xyXG59XHJcblxyXG5leHBvcnQgdmFyIF9fYXNzaWduID0gZnVuY3Rpb24oKSB7XHJcbiAgICBfX2Fzc2lnbiA9IE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24gX19hc3NpZ24odCkge1xyXG4gICAgICAgIGZvciAodmFyIHMsIGkgPSAxLCBuID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IG47IGkrKykge1xyXG4gICAgICAgICAgICBzID0gYXJndW1lbnRzW2ldO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBwIGluIHMpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocywgcCkpIHRbcF0gPSBzW3BdO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdDtcclxuICAgIH1cclxuICAgIHJldHVybiBfX2Fzc2lnbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19yZXN0KHMsIGUpIHtcclxuICAgIHZhciB0ID0ge307XHJcbiAgICBmb3IgKHZhciBwIGluIHMpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocywgcCkgJiYgZS5pbmRleE9mKHApIDwgMClcclxuICAgICAgICB0W3BdID0gc1twXTtcclxuICAgIGlmIChzICE9IG51bGwgJiYgdHlwZW9mIE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMgPT09IFwiZnVuY3Rpb25cIilcclxuICAgICAgICBmb3IgKHZhciBpID0gMCwgcCA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMocyk7IGkgPCBwLmxlbmd0aDsgaSsrKSBpZiAoZS5pbmRleE9mKHBbaV0pIDwgMClcclxuICAgICAgICAgICAgdFtwW2ldXSA9IHNbcFtpXV07XHJcbiAgICByZXR1cm4gdDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpIHtcclxuICAgIHZhciBjID0gYXJndW1lbnRzLmxlbmd0aCwgciA9IGMgPCAzID8gdGFyZ2V0IDogZGVzYyA9PT0gbnVsbCA/IGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRhcmdldCwga2V5KSA6IGRlc2MsIGQ7XHJcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUgPT09IFwiZnVuY3Rpb25cIikgciA9IFJlZmxlY3QuZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpO1xyXG4gICAgZWxzZSBmb3IgKHZhciBpID0gZGVjb3JhdG9ycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgaWYgKGQgPSBkZWNvcmF0b3JzW2ldKSByID0gKGMgPCAzID8gZChyKSA6IGMgPiAzID8gZCh0YXJnZXQsIGtleSwgcikgOiBkKHRhcmdldCwga2V5KSkgfHwgcjtcclxuICAgIHJldHVybiBjID4gMyAmJiByICYmIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgciksIHI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3BhcmFtKHBhcmFtSW5kZXgsIGRlY29yYXRvcikge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQsIGtleSkgeyBkZWNvcmF0b3IodGFyZ2V0LCBrZXksIHBhcmFtSW5kZXgpOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX21ldGFkYXRhKG1ldGFkYXRhS2V5LCBtZXRhZGF0YVZhbHVlKSB7XHJcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QubWV0YWRhdGEgPT09IFwiZnVuY3Rpb25cIikgcmV0dXJuIFJlZmxlY3QubWV0YWRhdGEobWV0YWRhdGFLZXksIG1ldGFkYXRhVmFsdWUpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hd2FpdGVyKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xyXG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZShyZXN1bHQudmFsdWUpOyB9KS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XHJcbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2dlbmVyYXRvcih0aGlzQXJnLCBib2R5KSB7XHJcbiAgICB2YXIgXyA9IHsgbGFiZWw6IDAsIHNlbnQ6IGZ1bmN0aW9uKCkgeyBpZiAodFswXSAmIDEpIHRocm93IHRbMV07IHJldHVybiB0WzFdOyB9LCB0cnlzOiBbXSwgb3BzOiBbXSB9LCBmLCB5LCB0LCBnO1xyXG4gICAgcmV0dXJuIGcgPSB7IG5leHQ6IHZlcmIoMCksIFwidGhyb3dcIjogdmVyYigxKSwgXCJyZXR1cm5cIjogdmVyYigyKSB9LCB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgKGdbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSksIGc7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgcmV0dXJuIGZ1bmN0aW9uICh2KSB7IHJldHVybiBzdGVwKFtuLCB2XSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHN0ZXAob3ApIHtcclxuICAgICAgICBpZiAoZikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy5cIik7XHJcbiAgICAgICAgd2hpbGUgKF8pIHRyeSB7XHJcbiAgICAgICAgICAgIGlmIChmID0gMSwgeSAmJiAodCA9IG9wWzBdICYgMiA/IHlbXCJyZXR1cm5cIl0gOiBvcFswXSA/IHlbXCJ0aHJvd1wiXSB8fCAoKHQgPSB5W1wicmV0dXJuXCJdKSAmJiB0LmNhbGwoeSksIDApIDogeS5uZXh0KSAmJiAhKHQgPSB0LmNhbGwoeSwgb3BbMV0pKS5kb25lKSByZXR1cm4gdDtcclxuICAgICAgICAgICAgaWYgKHkgPSAwLCB0KSBvcCA9IFtvcFswXSAmIDIsIHQudmFsdWVdO1xyXG4gICAgICAgICAgICBzd2l0Y2ggKG9wWzBdKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDA6IGNhc2UgMTogdCA9IG9wOyBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgNDogXy5sYWJlbCsrOyByZXR1cm4geyB2YWx1ZTogb3BbMV0sIGRvbmU6IGZhbHNlIH07XHJcbiAgICAgICAgICAgICAgICBjYXNlIDU6IF8ubGFiZWwrKzsgeSA9IG9wWzFdOyBvcCA9IFswXTsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDc6IG9wID0gXy5vcHMucG9wKCk7IF8udHJ5cy5wb3AoKTsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghKHQgPSBfLnRyeXMsIHQgPSB0Lmxlbmd0aCA+IDAgJiYgdFt0Lmxlbmd0aCAtIDFdKSAmJiAob3BbMF0gPT09IDYgfHwgb3BbMF0gPT09IDIpKSB7IF8gPSAwOyBjb250aW51ZTsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gMyAmJiAoIXQgfHwgKG9wWzFdID4gdFswXSAmJiBvcFsxXSA8IHRbM10pKSkgeyBfLmxhYmVsID0gb3BbMV07IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSA2ICYmIF8ubGFiZWwgPCB0WzFdKSB7IF8ubGFiZWwgPSB0WzFdOyB0ID0gb3A7IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQgJiYgXy5sYWJlbCA8IHRbMl0pIHsgXy5sYWJlbCA9IHRbMl07IF8ub3BzLnB1c2gob3ApOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0WzJdKSBfLm9wcy5wb3AoKTtcclxuICAgICAgICAgICAgICAgICAgICBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG9wID0gYm9keS5jYWxsKHRoaXNBcmcsIF8pO1xyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHsgb3AgPSBbNiwgZV07IHkgPSAwOyB9IGZpbmFsbHkgeyBmID0gdCA9IDA7IH1cclxuICAgICAgICBpZiAob3BbMF0gJiA1KSB0aHJvdyBvcFsxXTsgcmV0dXJuIHsgdmFsdWU6IG9wWzBdID8gb3BbMV0gOiB2b2lkIDAsIGRvbmU6IHRydWUgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZXhwb3J0U3RhcihtLCBleHBvcnRzKSB7XHJcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3ZhbHVlcyhvKSB7XHJcbiAgICB2YXIgbSA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvW1N5bWJvbC5pdGVyYXRvcl0sIGkgPSAwO1xyXG4gICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIG5leHQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDtcclxuICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9O1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3JlYWQobywgbikge1xyXG4gICAgdmFyIG0gPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb1tTeW1ib2wuaXRlcmF0b3JdO1xyXG4gICAgaWYgKCFtKSByZXR1cm4gbztcclxuICAgIHZhciBpID0gbS5jYWxsKG8pLCByLCBhciA9IFtdLCBlO1xyXG4gICAgdHJ5IHtcclxuICAgICAgICB3aGlsZSAoKG4gPT09IHZvaWQgMCB8fCBuLS0gPiAwKSAmJiAhKHIgPSBpLm5leHQoKSkuZG9uZSkgYXIucHVzaChyLnZhbHVlKTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlcnJvcikgeyBlID0geyBlcnJvcjogZXJyb3IgfTsgfVxyXG4gICAgZmluYWxseSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKHIgJiYgIXIuZG9uZSAmJiAobSA9IGlbXCJyZXR1cm5cIl0pKSBtLmNhbGwoaSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZpbmFsbHkgeyBpZiAoZSkgdGhyb3cgZS5lcnJvcjsgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGFyO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19zcHJlYWQoKSB7XHJcbiAgICBmb3IgKHZhciBhciA9IFtdLCBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKylcclxuICAgICAgICBhciA9IGFyLmNvbmNhdChfX3JlYWQoYXJndW1lbnRzW2ldKSk7XHJcbiAgICByZXR1cm4gYXI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2F3YWl0KHYpIHtcclxuICAgIHJldHVybiB0aGlzIGluc3RhbmNlb2YgX19hd2FpdCA/ICh0aGlzLnYgPSB2LCB0aGlzKSA6IG5ldyBfX2F3YWl0KHYpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY0dlbmVyYXRvcih0aGlzQXJnLCBfYXJndW1lbnRzLCBnZW5lcmF0b3IpIHtcclxuICAgIGlmICghU3ltYm9sLmFzeW5jSXRlcmF0b3IpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuYXN5bmNJdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XHJcbiAgICB2YXIgZyA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSwgaSwgcSA9IFtdO1xyXG4gICAgcmV0dXJuIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiKSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuYXN5bmNJdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IGlmIChnW25dKSBpW25dID0gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChhLCBiKSB7IHEucHVzaChbbiwgdiwgYSwgYl0pID4gMSB8fCByZXN1bWUobiwgdik7IH0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiByZXN1bWUobiwgdikgeyB0cnkgeyBzdGVwKGdbbl0odikpOyB9IGNhdGNoIChlKSB7IHNldHRsZShxWzBdWzNdLCBlKTsgfSB9XHJcbiAgICBmdW5jdGlvbiBzdGVwKHIpIHsgci52YWx1ZSBpbnN0YW5jZW9mIF9fYXdhaXQgPyBQcm9taXNlLnJlc29sdmUoci52YWx1ZS52KS50aGVuKGZ1bGZpbGwsIHJlamVjdCkgOiBzZXR0bGUocVswXVsyXSwgcik7IH1cclxuICAgIGZ1bmN0aW9uIGZ1bGZpbGwodmFsdWUpIHsgcmVzdW1lKFwibmV4dFwiLCB2YWx1ZSk7IH1cclxuICAgIGZ1bmN0aW9uIHJlamVjdCh2YWx1ZSkgeyByZXN1bWUoXCJ0aHJvd1wiLCB2YWx1ZSk7IH1cclxuICAgIGZ1bmN0aW9uIHNldHRsZShmLCB2KSB7IGlmIChmKHYpLCBxLnNoaWZ0KCksIHEubGVuZ3RoKSByZXN1bWUocVswXVswXSwgcVswXVsxXSk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNEZWxlZ2F0b3Iobykge1xyXG4gICAgdmFyIGksIHA7XHJcbiAgICByZXR1cm4gaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIsIGZ1bmN0aW9uIChlKSB7IHRocm93IGU7IH0pLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuLCBmKSB7IGlbbl0gPSBvW25dID8gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIChwID0gIXApID8geyB2YWx1ZTogX19hd2FpdChvW25dKHYpKSwgZG9uZTogbiA9PT0gXCJyZXR1cm5cIiB9IDogZiA/IGYodikgOiB2OyB9IDogZjsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY1ZhbHVlcyhvKSB7XHJcbiAgICBpZiAoIVN5bWJvbC5hc3luY0l0ZXJhdG9yKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3ltYm9sLmFzeW5jSXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xyXG4gICAgdmFyIG0gPSBvW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSwgaTtcclxuICAgIHJldHVybiBtID8gbS5jYWxsKG8pIDogKG8gPSB0eXBlb2YgX192YWx1ZXMgPT09IFwiZnVuY3Rpb25cIiA/IF9fdmFsdWVzKG8pIDogb1tTeW1ib2wuaXRlcmF0b3JdKCksIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiKSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuYXN5bmNJdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpKTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyBpW25dID0gb1tuXSAmJiBmdW5jdGlvbiAodikgeyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgeyB2ID0gb1tuXSh2KSwgc2V0dGxlKHJlc29sdmUsIHJlamVjdCwgdi5kb25lLCB2LnZhbHVlKTsgfSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHNldHRsZShyZXNvbHZlLCByZWplY3QsIGQsIHYpIHsgUHJvbWlzZS5yZXNvbHZlKHYpLnRoZW4oZnVuY3Rpb24odikgeyByZXNvbHZlKHsgdmFsdWU6IHYsIGRvbmU6IGQgfSk7IH0sIHJlamVjdCk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fbWFrZVRlbXBsYXRlT2JqZWN0KGNvb2tlZCwgcmF3KSB7XHJcbiAgICBpZiAoT2JqZWN0LmRlZmluZVByb3BlcnR5KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjb29rZWQsIFwicmF3XCIsIHsgdmFsdWU6IHJhdyB9KTsgfSBlbHNlIHsgY29va2VkLnJhdyA9IHJhdzsgfVxyXG4gICAgcmV0dXJuIGNvb2tlZDtcclxufTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2ltcG9ydFN0YXIobW9kKSB7XHJcbiAgICBpZiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSByZXR1cm4gbW9kO1xyXG4gICAgdmFyIHJlc3VsdCA9IHt9O1xyXG4gICAgaWYgKG1vZCAhPSBudWxsKSBmb3IgKHZhciBrIGluIG1vZCkgaWYgKE9iamVjdC5oYXNPd25Qcm9wZXJ0eS5jYWxsKG1vZCwgaykpIHJlc3VsdFtrXSA9IG1vZFtrXTtcclxuICAgIHJlc3VsdC5kZWZhdWx0ID0gbW9kO1xyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9faW1wb3J0RGVmYXVsdChtb2QpIHtcclxuICAgIHJldHVybiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSA/IG1vZCA6IHsgZGVmYXVsdDogbW9kIH07XHJcbn1cclxuIiwiaW1wb3J0IHtEb21TYW5pdGl6ZXIsIFNhZmVIdG1sfSBmcm9tICdAYW5ndWxhci9wbGF0Zm9ybS1icm93c2VyJztcbmltcG9ydCAqIGFzIGVzY2FwZVN0cmluZ05zIGZyb20gJ2VzY2FwZS1zdHJpbmctcmVnZXhwJztcbmltcG9ydCB7SU5neFNlbGVjdE9wdEdyb3VwLCBJTmd4U2VsZWN0T3B0aW9uLCBJTmd4U2VsZWN0T3B0aW9uQmFzZSwgVE5neFNlbGVjdE9wdGlvblR5cGV9IGZyb20gJy4vbmd4LXNlbGVjdC5pbnRlcmZhY2VzJztcblxuY29uc3QgZXNjYXBlU3RyaW5nID0gZXNjYXBlU3RyaW5nTnM7XG5cbmV4cG9ydCBjbGFzcyBOZ3hTZWxlY3RPcHRpb24gaW1wbGVtZW50cyBJTmd4U2VsZWN0T3B0aW9uLCBJTmd4U2VsZWN0T3B0aW9uQmFzZSB7XG4gICAgcmVhZG9ubHkgdHlwZTogVE5neFNlbGVjdE9wdGlvblR5cGUgPSAnb3B0aW9uJztcblxuICBoaWdobGlnaHRlZFRleHQ6IFNhZmVIdG1sO1xuICBhY3RpdmU6IGJvb2xlYW47XG5cbiAgY29uc3RydWN0b3IocHVibGljIHZhbHVlOiBudW1iZXIgfCBzdHJpbmcsXG4gICAgICAgICAgICAgICAgcHVibGljIHRleHQ6IHN0cmluZyxcbiAgICAgICAgICAgICAgICBwdWJsaWMgZGlzYWJsZWQ6IGJvb2xlYW4sXG4gICAgICAgICAgICAgICAgcHVibGljIGRhdGE6IGFueSxcbiAgICAgICAgICAgICAgICBwcml2YXRlIF9wYXJlbnQ6IE5neFNlbGVjdE9wdEdyb3VwID0gbnVsbCkge1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXQgcGFyZW50KCk6IE5neFNlbGVjdE9wdEdyb3VwIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3BhcmVudDtcbiAgICB9XG5cbiAgICBwcml2YXRlIGNhY2hlSGlnaGxpZ2h0VGV4dDogc3RyaW5nO1xuICAgIHByaXZhdGUgY2FjaGVSZW5kZXJlZFRleHQ6IFNhZmVIdG1sID0gbnVsbDtcblxuICAgIHB1YmxpYyByZW5kZXJUZXh0KHNhbml0aXplcjogRG9tU2FuaXRpemVyLCBoaWdobGlnaHRUZXh0OiBzdHJpbmcpOiBTYWZlSHRtbCB7XG4gICAgICAgIGlmICh0aGlzLmNhY2hlSGlnaGxpZ2h0VGV4dCAhPT0gaGlnaGxpZ2h0VGV4dCB8fCB0aGlzLmNhY2hlUmVuZGVyZWRUZXh0ID09PSBudWxsKSB7XG4gICAgICAgICAgICB0aGlzLmNhY2hlSGlnaGxpZ2h0VGV4dCA9IGhpZ2hsaWdodFRleHQ7XG4gICAgICAgICAgICBpZiAodGhpcy5jYWNoZUhpZ2hsaWdodFRleHQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNhY2hlUmVuZGVyZWRUZXh0ID0gc2FuaXRpemVyLmJ5cGFzc1NlY3VyaXR5VHJ1c3RIdG1sKCh0aGlzLnRleHQgKyAnJykucmVwbGFjZShcbiAgICAgICAgICAgICAgICAgICAgbmV3IFJlZ0V4cChlc2NhcGVTdHJpbmcodGhpcy5jYWNoZUhpZ2hsaWdodFRleHQpLCAnZ2knKSwgJzxzdHJvbmc+JCY8L3N0cm9uZz4nXG4gICAgICAgICAgICAgICAgKSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuY2FjaGVSZW5kZXJlZFRleHQgPSBzYW5pdGl6ZXIuYnlwYXNzU2VjdXJpdHlUcnVzdEh0bWwodGhpcy50ZXh0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5jYWNoZVJlbmRlcmVkVGV4dDtcbiAgICB9XG59XG5cbmV4cG9ydCBjbGFzcyBOZ3hTZWxlY3RPcHRHcm91cCBpbXBsZW1lbnRzIElOZ3hTZWxlY3RPcHRHcm91cCwgSU5neFNlbGVjdE9wdGlvbkJhc2Uge1xuICAgIHJlYWRvbmx5IHR5cGU6IFROZ3hTZWxlY3RPcHRpb25UeXBlID0gJ29wdGdyb3VwJztcblxuICAgIHB1YmxpYyBvcHRpb25zRmlsdGVyZWQ6IE5neFNlbGVjdE9wdGlvbltdO1xuXG4gICAgY29uc3RydWN0b3IocHVibGljIGxhYmVsOiBzdHJpbmcsXG4gICAgICAgICAgICAgICAgcHVibGljIG9wdGlvbnM6IE5neFNlbGVjdE9wdGlvbltdID0gW10pIHtcbiAgICAgICAgdGhpcy5maWx0ZXIoKCkgPT4gdHJ1ZSk7XG4gICAgfVxuXG4gICAgcHVibGljIGZpbHRlcihjYWxsYmFja0ZuOiAodmFsdWU6IE5neFNlbGVjdE9wdGlvbikgPT4gYW55KTogdm9pZCB7XG4gICAgICAgIHRoaXMub3B0aW9uc0ZpbHRlcmVkID0gdGhpcy5vcHRpb25zLmZpbHRlcigob3B0aW9uOiBOZ3hTZWxlY3RPcHRpb24pID0+IGNhbGxiYWNrRm4ob3B0aW9uKSk7XG4gICAgfVxufVxuXG5leHBvcnQgdHlwZSBUU2VsZWN0T3B0aW9uID0gTmd4U2VsZWN0T3B0R3JvdXAgfCBOZ3hTZWxlY3RPcHRpb247XG4iLCJpbXBvcnQge0RpcmVjdGl2ZSwgVGVtcGxhdGVSZWZ9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuXG5ARGlyZWN0aXZlKHtzZWxlY3RvcjogJ1tuZ3gtc2VsZWN0LW9wdGlvbl0nfSlcbmV4cG9ydCBjbGFzcyBOZ3hTZWxlY3RPcHRpb25EaXJlY3RpdmUge1xuICAgIGNvbnN0cnVjdG9yKHB1YmxpYyB0ZW1wbGF0ZTogVGVtcGxhdGVSZWY8YW55Pikge1xuICAgIH1cbn1cblxuQERpcmVjdGl2ZSh7c2VsZWN0b3I6ICdbbmd4LXNlbGVjdC1vcHRpb24tc2VsZWN0ZWRdJ30pXG5leHBvcnQgY2xhc3MgTmd4U2VsZWN0T3B0aW9uU2VsZWN0ZWREaXJlY3RpdmUge1xuICAgIGNvbnN0cnVjdG9yKHB1YmxpYyB0ZW1wbGF0ZTogVGVtcGxhdGVSZWY8YW55Pikge1xuICAgIH1cbn1cblxuQERpcmVjdGl2ZSh7c2VsZWN0b3I6ICdbbmd4LXNlbGVjdC1vcHRpb24tbm90LWZvdW5kXSd9KVxuZXhwb3J0IGNsYXNzIE5neFNlbGVjdE9wdGlvbk5vdEZvdW5kRGlyZWN0aXZlIHtcbiAgICBjb25zdHJ1Y3RvcihwdWJsaWMgdGVtcGxhdGU6IFRlbXBsYXRlUmVmPGFueT4pIHtcbiAgICB9XG59XG4iLCJpbXBvcnQge1xuICAgIEFmdGVyQ29udGVudENoZWNrZWQsIERvQ2hlY2ssIElucHV0LCBPdXRwdXQsIFZpZXdDaGlsZCxcbiAgICBDb21wb25lbnQsIEVsZW1lbnRSZWYsIEV2ZW50RW1pdHRlciwgZm9yd2FyZFJlZiwgSG9zdExpc3RlbmVyLCBJdGVyYWJsZURpZmZlciwgSXRlcmFibGVEaWZmZXJzLCBDaGFuZ2VEZXRlY3RvclJlZiwgQ29udGVudENoaWxkLFxuICAgIFRlbXBsYXRlUmVmLCBPcHRpb25hbCwgSW5qZWN0LCBJbmplY3Rpb25Ub2tlbiwgQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3lcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQge0NvbnRyb2xWYWx1ZUFjY2Vzc29yLCBOR19WQUxVRV9BQ0NFU1NPUn0gZnJvbSAnQGFuZ3VsYXIvZm9ybXMnO1xuaW1wb3J0IHtEb21TYW5pdGl6ZXIsIFNhZmVIdG1sfSBmcm9tICdAYW5ndWxhci9wbGF0Zm9ybS1icm93c2VyJztcbmltcG9ydCB7T2JzZXJ2YWJsZSwgU3ViamVjdCwgQmVoYXZpb3JTdWJqZWN0LCBFTVBUWSwgb2YsIGZyb20sIG1lcmdlLCBjb21iaW5lTGF0ZXN0fSBmcm9tICdyeGpzJztcbmltcG9ydCB7dGFwLCBmaWx0ZXIsIG1hcCwgc2hhcmUsIGZsYXRNYXAsIHRvQXJyYXksIGRpc3RpbmN0VW50aWxDaGFuZ2VkfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5pbXBvcnQgKiBhcyBsb2Rhc2hOcyBmcm9tICdsb2Rhc2gnO1xuaW1wb3J0ICogYXMgZXNjYXBlU3RyaW5nTnMgZnJvbSAnZXNjYXBlLXN0cmluZy1yZWdleHAnO1xuaW1wb3J0IHtOZ3hTZWxlY3RPcHRHcm91cCwgTmd4U2VsZWN0T3B0aW9uLCBUU2VsZWN0T3B0aW9ufSBmcm9tICcuL25neC1zZWxlY3QuY2xhc3Nlcyc7XG5pbXBvcnQge05neFNlbGVjdE9wdGlvbkRpcmVjdGl2ZSwgTmd4U2VsZWN0T3B0aW9uTm90Rm91bmREaXJlY3RpdmUsIE5neFNlbGVjdE9wdGlvblNlbGVjdGVkRGlyZWN0aXZlfSBmcm9tICcuL25neC10ZW1wbGF0ZXMuZGlyZWN0aXZlJztcbmltcG9ydCB7SU5neE9wdGlvbk5hdmlnYXRlZCwgSU5neFNlbGVjdE9wdGlvbiwgSU5neFNlbGVjdE9wdGlvbnN9IGZyb20gJy4vbmd4LXNlbGVjdC5pbnRlcmZhY2VzJztcblxuY29uc3QgXyA9IGxvZGFzaE5zO1xuY29uc3QgZXNjYXBlU3RyaW5nID0gZXNjYXBlU3RyaW5nTnM7XG5cbmV4cG9ydCBjb25zdCBOR1hfU0VMRUNUX09QVElPTlMgPSBuZXcgSW5qZWN0aW9uVG9rZW48YW55PignTkdYX1NFTEVDVF9PUFRJT05TJyk7XG5cbmV4cG9ydCBpbnRlcmZhY2UgSU5neFNlbGVjdENvbXBvbmVudE1vdXNlRXZlbnQgZXh0ZW5kcyBNb3VzZUV2ZW50IHtcbiAgICBjbGlja2VkU2VsZWN0Q29tcG9uZW50PzogTmd4U2VsZWN0Q29tcG9uZW50O1xufVxuXG5lbnVtIEVOYXZpZ2F0aW9uIHtcbiAgICBmaXJzdCwgcHJldmlvdXMsIG5leHQsIGxhc3QsXG4gICAgZmlyc3RTZWxlY3RlZCwgZmlyc3RJZk9wdGlvbkFjdGl2ZUludmlzaWJsZVxufVxuXG5mdW5jdGlvbiBwcm9wZXJ0eUV4aXN0cyhvYmo6IE9iamVjdCwgcHJvcGVydHlOYW1lOiBzdHJpbmcpIHtcbiAgICByZXR1cm4gcHJvcGVydHlOYW1lIGluIG9iajtcbn1cblxuQENvbXBvbmVudCh7XG4gICAgc2VsZWN0b3I6ICduZ3gtc2VsZWN0JyxcbiAgICB0ZW1wbGF0ZVVybDogJy4vbmd4LXNlbGVjdC5jb21wb25lbnQuaHRtbCcsXG4gICAgc3R5bGVVcmxzOiBbJy4vbmd4LXNlbGVjdC5jb21wb25lbnQuc2NzcyddLFxuICAgIGNoYW5nZURldGVjdGlvbjogQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kuT25QdXNoLFxuICAgIHByb3ZpZGVyczogW1xuICAgICAgICB7XG4gICAgICAgICAgICBwcm92aWRlOiBOR19WQUxVRV9BQ0NFU1NPUixcbiAgICAgICAgICAgIHVzZUV4aXN0aW5nOiBmb3J3YXJkUmVmKCgpID0+IE5neFNlbGVjdENvbXBvbmVudCksXG4gICAgICAgICAgICBtdWx0aTogdHJ1ZVxuICAgICAgICB9XG4gICAgXVxufSlcbmV4cG9ydCBjbGFzcyBOZ3hTZWxlY3RDb21wb25lbnQgaW1wbGVtZW50cyBJTmd4U2VsZWN0T3B0aW9ucywgQ29udHJvbFZhbHVlQWNjZXNzb3IsIERvQ2hlY2ssIEFmdGVyQ29udGVudENoZWNrZWQge1xuICAgIEBJbnB1dCgpIHB1YmxpYyBpdGVtczogYW55W107XG4gICAgQElucHV0KCkgcHVibGljIG9wdGlvblZhbHVlRmllbGQgPSAnaWQnO1xuICAgIEBJbnB1dCgpIHB1YmxpYyBvcHRpb25UZXh0RmllbGQgPSAndGV4dCc7XG4gICAgQElucHV0KCkgcHVibGljIG9wdEdyb3VwTGFiZWxGaWVsZCA9ICdsYWJlbCc7XG4gICAgQElucHV0KCkgcHVibGljIG9wdEdyb3VwT3B0aW9uc0ZpZWxkID0gJ29wdGlvbnMnO1xuICAgIEBJbnB1dCgpIHB1YmxpYyBtdWx0aXBsZSA9IGZhbHNlO1xuICAgIEBJbnB1dCgpIHB1YmxpYyBhbGxvd0NsZWFyID0gZmFsc2U7XG4gICAgQElucHV0KCkgcHVibGljIHBsYWNlaG9sZGVyID0gJyc7XG4gICAgQElucHV0KCkgcHVibGljIG5vQXV0b0NvbXBsZXRlID0gZmFsc2U7XG4gICAgQElucHV0KCkgcHVibGljIGRpc2FibGVkID0gZmFsc2U7XG4gICAgQElucHV0KCkgcHVibGljIGRlZmF1bHRWYWx1ZTogYW55W10gPSBbXTtcbiAgICBASW5wdXQoKSBwdWJsaWMgYXV0b1NlbGVjdFNpbmdsZU9wdGlvbiA9IGZhbHNlO1xuICAgIEBJbnB1dCgpIHB1YmxpYyBhdXRvQ2xlYXJTZWFyY2ggPSBmYWxzZTtcbiAgICBASW5wdXQoKSBwdWJsaWMgbm9SZXN1bHRzRm91bmQgPSAnTm8gcmVzdWx0cyBmb3VuZCc7XG4gICAgQElucHV0KCkgcHVibGljIGtlZXBTZWxlY3RlZEl0ZW1zOiBmYWxzZTtcbiAgICBASW5wdXQoKSBwdWJsaWMgc2l6ZTogJ3NtYWxsJyB8ICdkZWZhdWx0JyB8ICdsYXJnZScgPSAnZGVmYXVsdCc7XG4gICAgQElucHV0KCkgcHVibGljIHNlYXJjaENhbGxiYWNrOiAoc2VhcmNoOiBzdHJpbmcsIGl0ZW06IElOZ3hTZWxlY3RPcHRpb24pID0+IGJvb2xlYW47XG4gICAgQElucHV0KCkgcHVibGljIGF1dG9BY3RpdmVPbk1vdXNlRW50ZXIgPSB0cnVlO1xuICAgIEBJbnB1dCgpIHB1YmxpYyBpc0ZvY3VzZWQgPSBmYWxzZTtcbiAgICBwdWJsaWMga2V5Q29kZVRvUmVtb3ZlU2VsZWN0ZWQgPSAnRGVsZXRlJztcbiAgICBwdWJsaWMga2V5Q29kZVRvT3B0aW9uc09wZW4gPSBbJ0VudGVyJywgJ051bXBhZEVudGVyJ107XG4gICAgcHVibGljIGtleUNvZGVUb09wdGlvbnNDbG9zZSA9ICdFc2NhcGUnO1xuICAgIHB1YmxpYyBrZXlDb2RlVG9PcHRpb25zU2VsZWN0ID0gWydFbnRlcicsICdOdW1wYWRFbnRlciddO1xuICAgIHB1YmxpYyBrZXlDb2RlVG9OYXZpZ2F0ZUZpcnN0ID0gJ0Fycm93TGVmdCc7XG4gICAgcHVibGljIGtleUNvZGVUb05hdmlnYXRlUHJldmlvdXMgPSAnQXJyb3dVcCc7XG4gICAgcHVibGljIGtleUNvZGVUb05hdmlnYXRlTmV4dCA9ICdBcnJvd0Rvd24nO1xuICAgIHB1YmxpYyBrZXlDb2RlVG9OYXZpZ2F0ZUxhc3QgPSAnQXJyb3dSaWdodCc7XG5cbiAgICBAT3V0cHV0KCkgcHVibGljIHR5cGVkID0gbmV3IEV2ZW50RW1pdHRlcjxzdHJpbmc+KCk7XG4gICAgQE91dHB1dCgpIHB1YmxpYyBmb2N1cyA9IG5ldyBFdmVudEVtaXR0ZXI8dm9pZD4oKTtcbiAgICBAT3V0cHV0KCkgcHVibGljIGJsdXIgPSBuZXcgRXZlbnRFbWl0dGVyPHZvaWQ+KCk7XG4gICAgQE91dHB1dCgpIHB1YmxpYyBvcGVuID0gbmV3IEV2ZW50RW1pdHRlcjx2b2lkPigpO1xuICAgIEBPdXRwdXQoKSBwdWJsaWMgY2xvc2UgPSBuZXcgRXZlbnRFbWl0dGVyPHZvaWQ+KCk7XG4gICAgQE91dHB1dCgpIHB1YmxpYyBzZWxlY3QgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcbiAgICBAT3V0cHV0KCkgcHVibGljIHJlbW92ZSA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xuICAgIEBPdXRwdXQoKSBwdWJsaWMgbmF2aWdhdGVkID0gbmV3IEV2ZW50RW1pdHRlcjxJTmd4T3B0aW9uTmF2aWdhdGVkPigpO1xuICAgIEBPdXRwdXQoKSBwdWJsaWMgc2VsZWN0aW9uQ2hhbmdlcyA9IG5ldyBFdmVudEVtaXR0ZXI8SU5neFNlbGVjdE9wdGlvbltdPigpO1xuXG4gICAgQFZpZXdDaGlsZCgnbWFpbicpIHByb3RlY3RlZCBtYWluRWxSZWY6IEVsZW1lbnRSZWY7XG4gICAgQFZpZXdDaGlsZCgnaW5wdXQnKSBwcm90ZWN0ZWQgaW5wdXRFbFJlZjogRWxlbWVudFJlZjtcbiAgICBAVmlld0NoaWxkKCdjaG9pY2VNZW51JykgcHJvdGVjdGVkIGNob2ljZU1lbnVFbFJlZjogRWxlbWVudFJlZjtcblxuICAgIEBDb250ZW50Q2hpbGQoTmd4U2VsZWN0T3B0aW9uRGlyZWN0aXZlLCB7cmVhZDogVGVtcGxhdGVSZWZ9KSB0ZW1wbGF0ZU9wdGlvbjogTmd4U2VsZWN0T3B0aW9uRGlyZWN0aXZlO1xuICAgIEBDb250ZW50Q2hpbGQoTmd4U2VsZWN0T3B0aW9uU2VsZWN0ZWREaXJlY3RpdmUsIHtyZWFkOiBUZW1wbGF0ZVJlZn0pIHRlbXBsYXRlU2VsZWN0ZWRPcHRpb246IE5neFNlbGVjdE9wdGlvblNlbGVjdGVkRGlyZWN0aXZlO1xuICAgIEBDb250ZW50Q2hpbGQoTmd4U2VsZWN0T3B0aW9uTm90Rm91bmREaXJlY3RpdmUsIHtyZWFkOiBUZW1wbGF0ZVJlZn0pIHRlbXBsYXRlT3B0aW9uTm90Rm91bmQ6IE5neFNlbGVjdE9wdGlvbk5vdEZvdW5kRGlyZWN0aXZlO1xuXG4gICAgcHVibGljIG9wdGlvbnNPcGVuZWQgPSBmYWxzZTtcbiAgICBwdWJsaWMgb3B0aW9uc0ZpbHRlcmVkOiBUU2VsZWN0T3B0aW9uW107XG5cbiAgICBwcml2YXRlIG9wdGlvbkFjdGl2ZTogTmd4U2VsZWN0T3B0aW9uO1xuICAgIHByaXZhdGUgaXRlbXNEaWZmZXI6IEl0ZXJhYmxlRGlmZmVyPGFueT47XG4gICAgcHJpdmF0ZSBkZWZhdWx0VmFsdWVEaWZmZXI6IEl0ZXJhYmxlRGlmZmVyPGFueVtdPjtcbiAgICBwcml2YXRlIGFjdHVhbFZhbHVlOiBhbnlbXSA9IFtdO1xuXG4gICAgcHVibGljIHN1YmpPcHRpb25zID0gbmV3IEJlaGF2aW9yU3ViamVjdDxUU2VsZWN0T3B0aW9uW10+KFtdKTtcbiAgICBwcml2YXRlIHN1YmpTZWFyY2hUZXh0ID0gbmV3IEJlaGF2aW9yU3ViamVjdDxzdHJpbmc+KCcnKTtcblxuICAgIHByaXZhdGUgc3Viak9wdGlvbnNTZWxlY3RlZCA9IG5ldyBCZWhhdmlvclN1YmplY3Q8Tmd4U2VsZWN0T3B0aW9uW10+KFtdKTtcbiAgICBwcml2YXRlIHN1YmpFeHRlcm5hbFZhbHVlID0gbmV3IEJlaGF2aW9yU3ViamVjdDxhbnlbXT4oW10pO1xuICAgIHByaXZhdGUgc3ViakRlZmF1bHRWYWx1ZSA9IG5ldyBCZWhhdmlvclN1YmplY3Q8YW55W10+KFtdKTtcbiAgICBwcml2YXRlIHN1YmpSZWdpc3Rlck9uQ2hhbmdlID0gbmV3IFN1YmplY3QoKTtcblxuICAgIHByaXZhdGUgY2FjaGVPcHRpb25zRmlsdGVyZWRGbGF0OiBOZ3hTZWxlY3RPcHRpb25bXTtcbiAgICBwcml2YXRlIGNhY2hlRWxlbWVudE9mZnNldFRvcDogbnVtYmVyO1xuXG4gICAgcHJpdmF0ZSBfZm9jdXNUb0lucHV0ID0gZmFsc2U7XG5cbiAgICAvKiogQGludGVybmFsICovXG4gICAgcHVibGljIGdldCBpbnB1dFRleHQoKSB7XG4gICAgICAgIGlmICh0aGlzLmlucHV0RWxSZWYgJiYgdGhpcy5pbnB1dEVsUmVmLm5hdGl2ZUVsZW1lbnQpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmlucHV0RWxSZWYubmF0aXZlRWxlbWVudC52YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gJyc7XG4gICAgfVxuXG4gICAgY29uc3RydWN0b3IoaXRlcmFibGVEaWZmZXJzOiBJdGVyYWJsZURpZmZlcnMsIHByaXZhdGUgc2FuaXRpemVyOiBEb21TYW5pdGl6ZXIsIHByaXZhdGUgY2Q6IENoYW5nZURldGVjdG9yUmVmLFxuICAgICAgICAgICAgICAgIEBJbmplY3QoTkdYX1NFTEVDVF9PUFRJT05TKSBAT3B0aW9uYWwoKSBkZWZhdWx0T3B0aW9uczogSU5neFNlbGVjdE9wdGlvbnMpIHtcbiAgICAgICAgT2JqZWN0LmFzc2lnbih0aGlzLCBkZWZhdWx0T3B0aW9ucyk7XG5cbiAgICAgICAgLy8gRElGRkVSU1xuICAgICAgICB0aGlzLml0ZW1zRGlmZmVyID0gaXRlcmFibGVEaWZmZXJzLmZpbmQoW10pLmNyZWF0ZTxhbnk+KG51bGwpO1xuICAgICAgICB0aGlzLmRlZmF1bHRWYWx1ZURpZmZlciA9IGl0ZXJhYmxlRGlmZmVycy5maW5kKFtdKS5jcmVhdGU8YW55PihudWxsKTtcblxuICAgICAgICAvLyBPQlNFUlZFUlNcbiAgICAgICAgdGhpcy50eXBlZC5zdWJzY3JpYmUoKHRleHQ6IHN0cmluZykgPT4gdGhpcy5zdWJqU2VhcmNoVGV4dC5uZXh0KHRleHQpKTtcbiAgICAgICAgdGhpcy5zdWJqT3B0aW9uc1NlbGVjdGVkLnN1YnNjcmliZSgob3B0aW9uczogTmd4U2VsZWN0T3B0aW9uW10pID0+IHRoaXMuc2VsZWN0aW9uQ2hhbmdlcy5lbWl0KG9wdGlvbnMpKTtcbiAgICAgICAgbGV0IGNhY2hlRXh0ZXJuYWxWYWx1ZTogYW55W107XG5cbiAgICAgICAgLy8gR2V0IGFjdHVhbCB2YWx1ZVxuICAgICAgICBjb25zdCBzdWJqQWN0dWFsVmFsdWUgPSBjb21iaW5lTGF0ZXN0KFxuICAgICAgICAgICAgbWVyZ2UoXG4gICAgICAgICAgICAgICAgdGhpcy5zdWJqRXh0ZXJuYWxWYWx1ZS5waXBlKG1hcChcbiAgICAgICAgICAgICAgICAgICAgKHY6IGFueVtdKSA9PiBjYWNoZUV4dGVybmFsVmFsdWUgPSB2ID09PSBudWxsID8gW10gOiBbXS5jb25jYXQodilcbiAgICAgICAgICAgICAgICApKSxcbiAgICAgICAgICAgICAgICB0aGlzLnN1YmpPcHRpb25zU2VsZWN0ZWQucGlwZShtYXAoXG4gICAgICAgICAgICAgICAgICAgIChvcHRpb25zOiBOZ3hTZWxlY3RPcHRpb25bXSkgPT4gb3B0aW9ucy5tYXAoKG86IE5neFNlbGVjdE9wdGlvbikgPT4gby52YWx1ZSlcbiAgICAgICAgICAgICAgICApKVxuICAgICAgICAgICAgKSxcbiAgICAgICAgICAgIHRoaXMuc3ViakRlZmF1bHRWYWx1ZVxuICAgICAgICApLnBpcGUoXG4gICAgICAgICAgICBtYXAoKFtlVmFsLCBkVmFsXTogW2FueVtdLCBhbnlbXV0pID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBuZXdWYWwgPSBfLmlzRXF1YWwoZVZhbCwgZFZhbCkgPyBbXSA6IGVWYWw7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ld1ZhbC5sZW5ndGggPyBuZXdWYWwgOiBkVmFsO1xuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBkaXN0aW5jdFVudGlsQ2hhbmdlZCgoeCwgeSkgPT4gXy5pc0VxdWFsKHgsIHkpKSxcbiAgICAgICAgICAgIHNoYXJlKClcbiAgICAgICAgKTtcblxuICAgICAgICAvLyBFeHBvcnQgYWN0dWFsIHZhbHVlXG4gICAgICAgIGNvbWJpbmVMYXRlc3Qoc3ViakFjdHVhbFZhbHVlLCB0aGlzLnN1YmpSZWdpc3Rlck9uQ2hhbmdlKVxuICAgICAgICAgICAgLnBpcGUobWFwKChbYWN0dWFsVmFsdWVdOiBbYW55W10sIGFueVtdXSkgPT4gYWN0dWFsVmFsdWUpKVxuICAgICAgICAgICAgLnN1YnNjcmliZSgoYWN0dWFsVmFsdWU6IGFueVtdKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5hY3R1YWxWYWx1ZSA9IGFjdHVhbFZhbHVlO1xuICAgICAgICAgICAgICAgIGlmICghXy5pc0VxdWFsKGFjdHVhbFZhbHVlLCBjYWNoZUV4dGVybmFsVmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhY2hlRXh0ZXJuYWxWYWx1ZSA9IGFjdHVhbFZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5tdWx0aXBsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkNoYW5nZShhY3R1YWxWYWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9uQ2hhbmdlKGFjdHVhbFZhbHVlLmxlbmd0aCA/IGFjdHVhbFZhbHVlWzBdIDogbnVsbCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAvLyBDb3JyZWN0IHNlbGVjdGVkIG9wdGlvbnMgd2hlbiB0aGUgb3B0aW9ucyBjaGFuZ2VkXG4gICAgICAgIGNvbWJpbmVMYXRlc3QoXG4gICAgICAgICAgICB0aGlzLnN1YmpPcHRpb25zLnBpcGUoXG4gICAgICAgICAgICAgICAgZmxhdE1hcCgob3B0aW9uczogVFNlbGVjdE9wdGlvbltdKSA9PiBmcm9tKG9wdGlvbnMpLnBpcGUoXG4gICAgICAgICAgICAgICAgICAgIGZsYXRNYXAoKG9wdGlvbjogVFNlbGVjdE9wdGlvbikgPT4gb3B0aW9uIGluc3RhbmNlb2YgTmd4U2VsZWN0T3B0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICA/IG9mKG9wdGlvbilcbiAgICAgICAgICAgICAgICAgICAgICAgIDogKG9wdGlvbiBpbnN0YW5jZW9mIE5neFNlbGVjdE9wdEdyb3VwID8gZnJvbShvcHRpb24ub3B0aW9ucykgOiBFTVBUWSlcbiAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgdG9BcnJheSgpXG4gICAgICAgICAgICAgICAgKSlcbiAgICAgICAgICAgICksXG4gICAgICAgICAgICBzdWJqQWN0dWFsVmFsdWVcbiAgICAgICAgKS5waXBlKFxuICAgICAgICAgICAgbWFwKChbb3B0aW9uc0ZsYXQsIGFjdHVhbFZhbHVlXTogW05neFNlbGVjdE9wdGlvbltdLCBhbnlbXV0pID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBvcHRpb25zU2VsZWN0ZWQgPSBbXTtcblxuICAgICAgICAgICAgICAgIGFjdHVhbFZhbHVlLmZvckVhY2goKHZhbHVlOiBhbnkpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWRPcHRpb24gPSBvcHRpb25zRmxhdC5maW5kKChvcHRpb246IE5neFNlbGVjdE9wdGlvbikgPT4gb3B0aW9uLnZhbHVlID09PSB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWxlY3RlZE9wdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uc1NlbGVjdGVkLnB1c2goc2VsZWN0ZWRPcHRpb24pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5rZWVwU2VsZWN0ZWRJdGVtcykge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBvcHRpb25WYWx1ZXMgPSBvcHRpb25zU2VsZWN0ZWQubWFwKChvcHRpb246IE5neFNlbGVjdE9wdGlvbikgPT4gb3B0aW9uLnZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qga2VwdFNlbGVjdGVkT3B0aW9ucyA9IHRoaXMuc3Viak9wdGlvbnNTZWxlY3RlZC52YWx1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgLmZpbHRlcigoc2VsT3B0aW9uOiBOZ3hTZWxlY3RPcHRpb24pID0+IG9wdGlvblZhbHVlcy5pbmRleE9mKHNlbE9wdGlvbi52YWx1ZSkgPT09IC0xKTtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uc1NlbGVjdGVkLnB1c2goLi4ua2VwdFNlbGVjdGVkT3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKCFfLmlzRXF1YWwob3B0aW9uc1NlbGVjdGVkLCB0aGlzLnN1YmpPcHRpb25zU2VsZWN0ZWQudmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3Viak9wdGlvbnNTZWxlY3RlZC5uZXh0KG9wdGlvbnNTZWxlY3RlZCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2QubWFya0ZvckNoZWNrKCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9KVxuICAgICAgICApLnN1YnNjcmliZSgpO1xuXG4gICAgICAgIC8vIEVuc3VyZSB3b3JraW5nIGZpbHRlciBieSBhIHNlYXJjaCB0ZXh0XG4gICAgICAgIGNvbWJpbmVMYXRlc3QodGhpcy5zdWJqT3B0aW9ucywgdGhpcy5zdWJqT3B0aW9uc1NlbGVjdGVkLCB0aGlzLnN1YmpTZWFyY2hUZXh0KS5waXBlKFxuICAgICAgICAgICAgbWFwKChbb3B0aW9ucywgc2VsZWN0ZWRPcHRpb25zLCBzZWFyY2hdOiBbVFNlbGVjdE9wdGlvbltdLCBOZ3hTZWxlY3RPcHRpb25bXSwgc3RyaW5nXSkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMub3B0aW9uc0ZpbHRlcmVkID0gdGhpcy5maWx0ZXJPcHRpb25zKHNlYXJjaCwgb3B0aW9ucywgc2VsZWN0ZWRPcHRpb25zKS5tYXAob3B0aW9uID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wdGlvbiBpbnN0YW5jZW9mIE5neFNlbGVjdE9wdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uLmhpZ2hsaWdodGVkVGV4dCA9IHRoaXMuaGlnaGxpZ2h0T3B0aW9uKG9wdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAob3B0aW9uIGluc3RhbmNlb2YgTmd4U2VsZWN0T3B0R3JvdXApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbi5vcHRpb25zLm1hcChzdWJPcHRpb24gPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Yk9wdGlvbi5oaWdobGlnaHRlZFRleHQgPSB0aGlzLmhpZ2hsaWdodE9wdGlvbihzdWJPcHRpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzdWJPcHRpb247XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gb3B0aW9uO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoaXMuY2FjaGVPcHRpb25zRmlsdGVyZWRGbGF0ID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLm5hdmlnYXRlT3B0aW9uKEVOYXZpZ2F0aW9uLmZpcnN0SWZPcHRpb25BY3RpdmVJbnZpc2libGUpO1xuICAgICAgICAgICAgICAgIHRoaXMuY2QubWFya0ZvckNoZWNrKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHNlbGVjdGVkT3B0aW9ucztcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgZmxhdE1hcCgoc2VsZWN0ZWRPcHRpb25zOiBOZ3hTZWxlY3RPcHRpb25bXSkgPT4gdGhpcy5vcHRpb25zRmlsdGVyZWRGbGF0KCkucGlwZShmaWx0ZXIoXG4gICAgICAgICAgICAgICAgKGZsYXRPcHRpb25zOiBOZ3hTZWxlY3RPcHRpb25bXSkgPT4gdGhpcy5hdXRvU2VsZWN0U2luZ2xlT3B0aW9uICYmIGZsYXRPcHRpb25zLmxlbmd0aCA9PT0gMSAmJiAhc2VsZWN0ZWRPcHRpb25zLmxlbmd0aFxuICAgICAgICAgICAgKSkpXG4gICAgICAgICkuc3Vic2NyaWJlKChmbGF0T3B0aW9uczogTmd4U2VsZWN0T3B0aW9uW10pID0+IHtcbiAgICAgICAgICAgIHRoaXMuc3Viak9wdGlvbnNTZWxlY3RlZC5uZXh0KGZsYXRPcHRpb25zKTtcbiAgICAgICAgICAgIHRoaXMuY2QubWFya0ZvckNoZWNrKCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHB1YmxpYyBzZXRGb3JtQ29udHJvbFNpemUob3RoZXJDbGFzc05hbWVzOiBPYmplY3QgPSB7fSwgdXNlRm9ybUNvbnRyb2w6IGJvb2xlYW4gPSB0cnVlKSB7XG4gICAgICAgIGNvbnN0IGZvcm1Db250cm9sRXh0cmFDbGFzc2VzID0gdXNlRm9ybUNvbnRyb2wgPyB7XG4gICAgICAgICAgICAnZm9ybS1jb250cm9sLXNtIGlucHV0LXNtJzogdGhpcy5zaXplID09PSAnc21hbGwnLFxuICAgICAgICAgICAgJ2Zvcm0tY29udHJvbC1sZyBpbnB1dC1sZyc6IHRoaXMuc2l6ZSA9PT0gJ2xhcmdlJ1xuICAgICAgICB9IDoge307XG4gICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKGZvcm1Db250cm9sRXh0cmFDbGFzc2VzLCBvdGhlckNsYXNzTmFtZXMpO1xuICAgIH1cblxuICAgIHB1YmxpYyBzZXRCdG5TaXplKCkge1xuICAgICAgICByZXR1cm4geydidG4tc20nOiB0aGlzLnNpemUgPT09ICdzbWFsbCcsICdidG4tbGcnOiB0aGlzLnNpemUgPT09ICdsYXJnZSd9O1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXQgb3B0aW9uc1NlbGVjdGVkKCk6IE5neFNlbGVjdE9wdGlvbltdIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3Viak9wdGlvbnNTZWxlY3RlZC52YWx1ZTtcbiAgICB9XG5cbiAgICBwdWJsaWMgbWFpbkNsaWNrZWQoZXZlbnQ6IElOZ3hTZWxlY3RDb21wb25lbnRNb3VzZUV2ZW50KSB7XG4gICAgICAgIGV2ZW50LmNsaWNrZWRTZWxlY3RDb21wb25lbnQgPSB0aGlzO1xuICAgICAgICBpZiAoIXRoaXMuaXNGb2N1c2VkKSB7XG4gICAgICAgICAgICB0aGlzLmlzRm9jdXNlZCA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLmZvY3VzLmVtaXQoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIEBIb3N0TGlzdGVuZXIoJ2RvY3VtZW50OmZvY3VzaW4nLCBbJyRldmVudCddKVxuICAgIEBIb3N0TGlzdGVuZXIoJ2RvY3VtZW50OmNsaWNrJywgWyckZXZlbnQnXSlcbiAgICBwdWJsaWMgZG9jdW1lbnRDbGljayhldmVudDogSU5neFNlbGVjdENvbXBvbmVudE1vdXNlRXZlbnQpIHtcbiAgICAgICAgaWYgKGV2ZW50LmNsaWNrZWRTZWxlY3RDb21wb25lbnQgIT09IHRoaXMpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnNPcGVuZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnNDbG9zZSgpO1xuICAgICAgICAgICAgICAgIHRoaXMuY2QuZGV0ZWN0Q2hhbmdlcygpOyAvLyBmaXggZXJyb3IgYmVjYXVzZSBvZiBkZWxheSBiZXR3ZWVuIGRpZmZlcmVudCBldmVudHNcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLmlzRm9jdXNlZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuaXNGb2N1c2VkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdGhpcy5ibHVyLmVtaXQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgb3B0aW9uc0ZpbHRlcmVkRmxhdCgpOiBPYnNlcnZhYmxlPE5neFNlbGVjdE9wdGlvbltdPiB7XG4gICAgICAgIGlmICh0aGlzLmNhY2hlT3B0aW9uc0ZpbHRlcmVkRmxhdCkge1xuICAgICAgICAgICAgcmV0dXJuIG9mKHRoaXMuY2FjaGVPcHRpb25zRmlsdGVyZWRGbGF0KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBmcm9tKHRoaXMub3B0aW9uc0ZpbHRlcmVkKS5waXBlKFxuICAgICAgICAgICAgZmxhdE1hcDxUU2VsZWN0T3B0aW9uLCBOZ3hTZWxlY3RPcHRpb24+KChvcHRpb246IFRTZWxlY3RPcHRpb24pID0+XG4gICAgICAgICAgICAgICAgb3B0aW9uIGluc3RhbmNlb2YgTmd4U2VsZWN0T3B0aW9uID8gb2Yob3B0aW9uKSA6XG4gICAgICAgICAgICAgICAgICAgIChvcHRpb24gaW5zdGFuY2VvZiBOZ3hTZWxlY3RPcHRHcm91cCA/IGZyb20ob3B0aW9uLm9wdGlvbnNGaWx0ZXJlZCkgOiBFTVBUWSlcbiAgICAgICAgICAgICksXG4gICAgICAgICAgICBmaWx0ZXIoKG9wdGlvbnNGaWx0ZXJlZEZsYXQ6IE5neFNlbGVjdE9wdGlvbikgPT4gIW9wdGlvbnNGaWx0ZXJlZEZsYXQuZGlzYWJsZWQpLFxuICAgICAgICAgICAgdG9BcnJheSgpLFxuICAgICAgICAgICAgdGFwKChvcHRpb25zRmlsdGVyZWRGbGF0OiBOZ3hTZWxlY3RPcHRpb25bXSkgPT4gdGhpcy5jYWNoZU9wdGlvbnNGaWx0ZXJlZEZsYXQgPSBvcHRpb25zRmlsdGVyZWRGbGF0KVxuICAgICAgICApO1xuICAgIH1cblxuICAgIHByaXZhdGUgbmF2aWdhdGVPcHRpb24obmF2aWdhdGlvbjogRU5hdmlnYXRpb24pIHtcbiAgICAgICAgdGhpcy5vcHRpb25zRmlsdGVyZWRGbGF0KCkucGlwZShcbiAgICAgICAgICAgIG1hcDxOZ3hTZWxlY3RPcHRpb25bXSwgSU5neE9wdGlvbk5hdmlnYXRlZD4oKG9wdGlvbnM6IE5neFNlbGVjdE9wdGlvbltdKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgbmF2aWdhdGVkOiBJTmd4T3B0aW9uTmF2aWdhdGVkID0ge2luZGV4OiAtMSwgYWN0aXZlT3B0aW9uOiBudWxsLCBmaWx0ZXJlZE9wdGlvbkxpc3Q6IG9wdGlvbnN9O1xuICAgICAgICAgICAgICAgIGxldCBuZXdBY3RpdmVJZHg7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChuYXZpZ2F0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgRU5hdmlnYXRpb24uZmlyc3Q6XG4gICAgICAgICAgICAgICAgICAgICAgICBuYXZpZ2F0ZWQuaW5kZXggPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgRU5hdmlnYXRpb24ucHJldmlvdXM6XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdBY3RpdmVJZHggPSBvcHRpb25zLmluZGV4T2YodGhpcy5vcHRpb25BY3RpdmUpIC0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hdmlnYXRlZC5pbmRleCA9IG5ld0FjdGl2ZUlkeCA+PSAwID8gbmV3QWN0aXZlSWR4IDogb3B0aW9ucy5sZW5ndGggLSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgRU5hdmlnYXRpb24ubmV4dDpcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld0FjdGl2ZUlkeCA9IG9wdGlvbnMuaW5kZXhPZih0aGlzLm9wdGlvbkFjdGl2ZSkgKyAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgbmF2aWdhdGVkLmluZGV4ID0gbmV3QWN0aXZlSWR4IDwgb3B0aW9ucy5sZW5ndGggPyBuZXdBY3RpdmVJZHggOiAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgRU5hdmlnYXRpb24ubGFzdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hdmlnYXRlZC5pbmRleCA9IG9wdGlvbnMubGVuZ3RoIC0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIEVOYXZpZ2F0aW9uLmZpcnN0U2VsZWN0ZWQ6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5zdWJqT3B0aW9uc1NlbGVjdGVkLnZhbHVlLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hdmlnYXRlZC5pbmRleCA9IG9wdGlvbnMuaW5kZXhPZih0aGlzLnN1YmpPcHRpb25zU2VsZWN0ZWQudmFsdWVbMF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgRU5hdmlnYXRpb24uZmlyc3RJZk9wdGlvbkFjdGl2ZUludmlzaWJsZTpcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBpZHhPZk9wdGlvbkFjdGl2ZSA9IC0xO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9uQWN0aXZlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWR4T2ZPcHRpb25BY3RpdmUgPSBvcHRpb25zLmluZGV4T2Yob3B0aW9ucy5maW5kKHggPT4geC52YWx1ZSA9PT0gdGhpcy5vcHRpb25BY3RpdmUudmFsdWUpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIG5hdmlnYXRlZC5pbmRleCA9IGlkeE9mT3B0aW9uQWN0aXZlID4gMCA/IGlkeE9mT3B0aW9uQWN0aXZlIDogMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBuYXZpZ2F0ZWQuYWN0aXZlT3B0aW9uID0gb3B0aW9uc1tuYXZpZ2F0ZWQuaW5kZXhdO1xuICAgICAgICAgICAgICAgIHJldHVybiBuYXZpZ2F0ZWQ7XG4gICAgICAgICAgICB9KVxuICAgICAgICApLnN1YnNjcmliZSgobmV3TmF2aWdhdGVkOiBJTmd4T3B0aW9uTmF2aWdhdGVkKSA9PiB0aGlzLm9wdGlvbkFjdGl2YXRlKG5ld05hdmlnYXRlZCkpO1xuICAgIH1cblxuICAgIHB1YmxpYyBuZ0RvQ2hlY2soKTogdm9pZCB7XG4gICAgICAgIGlmICh0aGlzLml0ZW1zRGlmZmVyLmRpZmYodGhpcy5pdGVtcykpIHtcbiAgICAgICAgICAgIHRoaXMuc3Viak9wdGlvbnMubmV4dCh0aGlzLmJ1aWxkT3B0aW9ucyh0aGlzLml0ZW1zKSk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBkZWZWYWwgPSB0aGlzLmRlZmF1bHRWYWx1ZSA/IFtdLmNvbmNhdCh0aGlzLmRlZmF1bHRWYWx1ZSkgOiBbXTtcbiAgICAgICAgaWYgKHRoaXMuZGVmYXVsdFZhbHVlRGlmZmVyLmRpZmYoZGVmVmFsKSkge1xuICAgICAgICAgICAgdGhpcy5zdWJqRGVmYXVsdFZhbHVlLm5leHQoZGVmVmFsKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBuZ0FmdGVyQ29udGVudENoZWNrZWQoKTogdm9pZCB7XG4gICAgICAgIGlmICh0aGlzLl9mb2N1c1RvSW5wdXQgJiYgdGhpcy5jaGVja0lucHV0VmlzaWJpbGl0eSgpICYmIHRoaXMuaW5wdXRFbFJlZiAmJlxuICAgICAgICAgICAgdGhpcy5pbnB1dEVsUmVmLm5hdGl2ZUVsZW1lbnQgIT09IGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQpIHtcbiAgICAgICAgICAgIHRoaXMuX2ZvY3VzVG9JbnB1dCA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5pbnB1dEVsUmVmLm5hdGl2ZUVsZW1lbnQuZm9jdXMoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLmNob2ljZU1lbnVFbFJlZikge1xuICAgICAgICAgICAgY29uc3QgdWxFbGVtZW50ID0gdGhpcy5jaG9pY2VNZW51RWxSZWYubmF0aXZlRWxlbWVudCBhcyBIVE1MVUxpc3RFbGVtZW50O1xuICAgICAgICAgICAgY29uc3QgZWxlbWVudCA9IHVsRWxlbWVudC5xdWVyeVNlbGVjdG9yKCdhLm5neC1zZWxlY3RfX2l0ZW1fYWN0aXZlLmFjdGl2ZScpIGFzIEhUTUxMaW5rRWxlbWVudDtcblxuICAgICAgICAgICAgaWYgKGVsZW1lbnQgJiYgZWxlbWVudC5vZmZzZXRIZWlnaHQgPiAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5lbnN1cmVWaXNpYmxlRWxlbWVudChlbGVtZW50KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIGNhbkNsZWFyTm90TXVsdGlwbGUoKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLmFsbG93Q2xlYXIgJiYgISF0aGlzLnN1YmpPcHRpb25zU2VsZWN0ZWQudmFsdWUubGVuZ3RoICYmXG4gICAgICAgICAgICAoIXRoaXMuc3ViakRlZmF1bHRWYWx1ZS52YWx1ZS5sZW5ndGggfHwgdGhpcy5zdWJqRGVmYXVsdFZhbHVlLnZhbHVlWzBdICE9PSB0aGlzLmFjdHVhbFZhbHVlWzBdKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgZm9jdXNUb0lucHV0KCk6IHZvaWQge1xuICAgICAgICB0aGlzLl9mb2N1c1RvSW5wdXQgPSB0cnVlO1xuICAgIH1cblxuICAgIHB1YmxpYyBpbnB1dEtleURvd24oZXZlbnQ6IEtleWJvYXJkRXZlbnQpIHtcbiAgICAgICAgY29uc3Qga2V5c0Zvck9wZW5lZFN0YXRlID0gW10uY29uY2F0KFxuICAgICAgICAgICAgdGhpcy5rZXlDb2RlVG9PcHRpb25zU2VsZWN0LFxuICAgICAgICAgICAgdGhpcy5rZXlDb2RlVG9OYXZpZ2F0ZUZpcnN0LFxuICAgICAgICAgICAgdGhpcy5rZXlDb2RlVG9OYXZpZ2F0ZVByZXZpb3VzLFxuICAgICAgICAgICAgdGhpcy5rZXlDb2RlVG9OYXZpZ2F0ZU5leHQsXG4gICAgICAgICAgICB0aGlzLmtleUNvZGVUb05hdmlnYXRlTGFzdFxuICAgICAgICApO1xuICAgICAgICBjb25zdCBrZXlzRm9yQ2xvc2VkU3RhdGUgPSBbXS5jb25jYXQodGhpcy5rZXlDb2RlVG9PcHRpb25zT3BlbiwgdGhpcy5rZXlDb2RlVG9SZW1vdmVTZWxlY3RlZCk7XG5cbiAgICAgICAgaWYgKHRoaXMub3B0aW9uc09wZW5lZCAmJiBrZXlzRm9yT3BlbmVkU3RhdGUuaW5kZXhPZihldmVudC5jb2RlKSAhPT0gLTEpIHtcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgIHN3aXRjaCAoZXZlbnQuY29kZSkge1xuICAgICAgICAgICAgICAgIGNhc2UgKFtdLmNvbmNhdCh0aGlzLmtleUNvZGVUb09wdGlvbnNTZWxlY3QpLmluZGV4T2YoZXZlbnQuY29kZSkgKyAxKSAmJiBldmVudC5jb2RlOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9wdGlvblNlbGVjdCh0aGlzLm9wdGlvbkFjdGl2ZSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubmF2aWdhdGVPcHRpb24oRU5hdmlnYXRpb24ubmV4dCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgdGhpcy5rZXlDb2RlVG9OYXZpZ2F0ZUZpcnN0OlxuICAgICAgICAgICAgICAgICAgICB0aGlzLm5hdmlnYXRlT3B0aW9uKEVOYXZpZ2F0aW9uLmZpcnN0KTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSB0aGlzLmtleUNvZGVUb05hdmlnYXRlUHJldmlvdXM6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubmF2aWdhdGVPcHRpb24oRU5hdmlnYXRpb24ucHJldmlvdXMpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIHRoaXMua2V5Q29kZVRvTmF2aWdhdGVMYXN0OlxuICAgICAgICAgICAgICAgICAgICB0aGlzLm5hdmlnYXRlT3B0aW9uKEVOYXZpZ2F0aW9uLmxhc3QpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIHRoaXMua2V5Q29kZVRvTmF2aWdhdGVOZXh0OlxuICAgICAgICAgICAgICAgICAgICB0aGlzLm5hdmlnYXRlT3B0aW9uKEVOYXZpZ2F0aW9uLm5leHQpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmICghdGhpcy5vcHRpb25zT3BlbmVkICYmIGtleXNGb3JDbG9zZWRTdGF0ZS5pbmRleE9mKGV2ZW50LmNvZGUpICE9PSAtMSkge1xuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgc3dpdGNoIChldmVudC5jb2RlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAoW10uY29uY2F0KHRoaXMua2V5Q29kZVRvT3B0aW9uc09wZW4pLmluZGV4T2YoZXZlbnQuY29kZSkgKyAxKSAmJiBldmVudC5jb2RlOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnNPcGVuKCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgdGhpcy5rZXlDb2RlVG9SZW1vdmVTZWxlY3RlZDpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vcHRpb25SZW1vdmUodGhpcy5zdWJqT3B0aW9uc1NlbGVjdGVkLnZhbHVlW3RoaXMuc3Viak9wdGlvbnNTZWxlY3RlZC52YWx1ZS5sZW5ndGggLSAxXSwgZXZlbnQpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyB0cmFja0J5T3B0aW9uKGluZGV4OiBudW1iZXIsIG9wdGlvbjogVFNlbGVjdE9wdGlvbikge1xuICAgICAgICByZXR1cm4gb3B0aW9uIGluc3RhbmNlb2YgTmd4U2VsZWN0T3B0aW9uID8gb3B0aW9uLnZhbHVlIDpcbiAgICAgICAgICAgIChvcHRpb24gaW5zdGFuY2VvZiBOZ3hTZWxlY3RPcHRHcm91cCA/IG9wdGlvbi5sYWJlbCA6IG9wdGlvbik7XG4gICAgfVxuXG4gICAgcHVibGljIGNoZWNrSW5wdXRWaXNpYmlsaXR5KCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gKHRoaXMubXVsdGlwbGUgPT09IHRydWUpIHx8ICh0aGlzLm9wdGlvbnNPcGVuZWQgJiYgIXRoaXMubm9BdXRvQ29tcGxldGUpO1xuICAgIH1cblxuICAgIC8qKiBAaW50ZXJuYWwgKi9cbiAgICBwdWJsaWMgaW5wdXRLZXlVcCh2YWx1ZTogc3RyaW5nID0gJycsIGV2ZW50OiBLZXlib2FyZEV2ZW50KSB7XG4gICAgICAgIGlmIChldmVudC5jb2RlID09PSB0aGlzLmtleUNvZGVUb09wdGlvbnNDbG9zZSkge1xuICAgICAgICAgICAgdGhpcy5vcHRpb25zQ2xvc2UoLyp0cnVlKi8pO1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMub3B0aW9uc09wZW5lZCAmJiAoWydBcnJvd0Rvd24nLCAnQXJyb3dVcCcsICdBcnJvd0xlZnQnLCAnQXJyb3dEb3duJ10uaW5kZXhPZihldmVudC5jb2RlKSA9PT0gLTEpLyppZ25vcmUgYXJyb3dzKi8pIHtcbiAgICAgICAgICAgIHRoaXMudHlwZWQuZW1pdCh2YWx1ZSk7XG4gICAgICAgIH0gZWxzZSBpZiAoIXRoaXMub3B0aW9uc09wZW5lZCAmJiB2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5vcHRpb25zT3Blbih2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKiogQGludGVybmFsICovXG4gICAgcHVibGljIGlucHV0Q2xpY2sodmFsdWU6IHN0cmluZyA9ICcnKSB7XG4gICAgICAgIGlmICghdGhpcy5vcHRpb25zT3BlbmVkKSB7XG4gICAgICAgICAgICB0aGlzLm9wdGlvbnNPcGVuKHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKiBAaW50ZXJuYWwgKi9cbiAgICBwdWJsaWMgc2FuaXRpemUoaHRtbDogc3RyaW5nKTogU2FmZUh0bWwge1xuICAgICAgICByZXR1cm4gaHRtbCA/IHRoaXMuc2FuaXRpemVyLmJ5cGFzc1NlY3VyaXR5VHJ1c3RIdG1sKGh0bWwpIDogbnVsbDtcbiAgICB9XG5cbiAgICAvKiogQGludGVybmFsICovXG4gICAgcHVibGljIGhpZ2hsaWdodE9wdGlvbihvcHRpb246IE5neFNlbGVjdE9wdGlvbik6IFNhZmVIdG1sIHtcbiAgICAgICAgaWYgKHRoaXMuaW5wdXRFbFJlZikge1xuICAgICAgICAgICAgcmV0dXJuIG9wdGlvbi5yZW5kZXJUZXh0KHRoaXMuc2FuaXRpemVyLCB0aGlzLmlucHV0RWxSZWYubmF0aXZlRWxlbWVudC52YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG9wdGlvbi5yZW5kZXJUZXh0KHRoaXMuc2FuaXRpemVyLCAnJyk7XG4gICAgfVxuXG4gICAgLyoqIEBpbnRlcm5hbCAqL1xuICAgIHB1YmxpYyBvcHRpb25TZWxlY3Qob3B0aW9uOiBOZ3hTZWxlY3RPcHRpb24sIGV2ZW50OiBFdmVudCA9IG51bGwpOiB2b2lkIHtcbiAgICAgICAgaWYgKGV2ZW50KSB7XG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG9wdGlvbiAmJiAhb3B0aW9uLmRpc2FibGVkKSB7XG4gICAgICAgICAgICB0aGlzLnN1YmpPcHRpb25zU2VsZWN0ZWQubmV4dCgodGhpcy5tdWx0aXBsZSA/IHRoaXMuc3Viak9wdGlvbnNTZWxlY3RlZC52YWx1ZSA6IFtdKS5jb25jYXQoW29wdGlvbl0pKTtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0LmVtaXQob3B0aW9uLnZhbHVlKTtcbiAgICAgICAgICAgIHRoaXMub3B0aW9uc0Nsb3NlKC8qdHJ1ZSovKTtcbiAgICAgICAgICAgIHRoaXMub25Ub3VjaGVkKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKiogQGludGVybmFsICovXG4gICAgcHVibGljIG9wdGlvblJlbW92ZShvcHRpb246IE5neFNlbGVjdE9wdGlvbiwgZXZlbnQ6IEV2ZW50KTogdm9pZCB7XG4gICAgICAgIGlmICghdGhpcy5kaXNhYmxlZCAmJiBvcHRpb24pIHtcbiAgICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgdGhpcy5zdWJqT3B0aW9uc1NlbGVjdGVkLm5leHQoKHRoaXMubXVsdGlwbGUgPyB0aGlzLnN1YmpPcHRpb25zU2VsZWN0ZWQudmFsdWUgOiBbXSkuZmlsdGVyKG8gPT4gbyAhPT0gb3B0aW9uKSk7XG4gICAgICAgICAgICB0aGlzLnJlbW92ZS5lbWl0KG9wdGlvbi52YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKiogQGludGVybmFsICovXG4gICAgcHVibGljIG9wdGlvbkFjdGl2YXRlKG5hdmlnYXRlZDogSU5neE9wdGlvbk5hdmlnYXRlZCk6IHZvaWQge1xuICAgICAgICBpZiAoKHRoaXMub3B0aW9uQWN0aXZlICE9PSBuYXZpZ2F0ZWQuYWN0aXZlT3B0aW9uKSAmJlxuICAgICAgICAgICAgKCFuYXZpZ2F0ZWQuYWN0aXZlT3B0aW9uIHx8ICFuYXZpZ2F0ZWQuYWN0aXZlT3B0aW9uLmRpc2FibGVkKSkge1xuICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9uQWN0aXZlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vcHRpb25BY3RpdmUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMub3B0aW9uQWN0aXZlID0gbmF2aWdhdGVkLmFjdGl2ZU9wdGlvbjtcblxuICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9uQWN0aXZlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vcHRpb25BY3RpdmUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMubmF2aWdhdGVkLmVtaXQobmF2aWdhdGVkKTtcbiAgICAgICAgICAgIHRoaXMuY2QuZGV0ZWN0Q2hhbmdlcygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqIEBpbnRlcm5hbCAqL1xuICAgIHB1YmxpYyBvbk1vdXNlRW50ZXIobmF2aWdhdGVkOiBJTmd4T3B0aW9uTmF2aWdhdGVkKTogdm9pZCB7XG4gICAgICAgIGRvY3VtZW50Lm9ubW91c2Vtb3ZlID0gKCkgPT4ge1xuICAgICAgICAgICAgaWYgKHRoaXMuYXV0b0FjdGl2ZU9uTW91c2VFbnRlcikge1xuICAgICAgICAgICAgICAgIHRoaXMub3B0aW9uQWN0aXZhdGUobmF2aWdhdGVkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGZpbHRlck9wdGlvbnMoc2VhcmNoOiBzdHJpbmcsIG9wdGlvbnM6IFRTZWxlY3RPcHRpb25bXSwgc2VsZWN0ZWRPcHRpb25zOiBOZ3hTZWxlY3RPcHRpb25bXSk6IFRTZWxlY3RPcHRpb25bXSB7XG4gICAgICAgIGNvbnN0IHJlZ0V4cCA9IG5ldyBSZWdFeHAoZXNjYXBlU3RyaW5nKHNlYXJjaCksICdpJyksXG4gICAgICAgICAgICBmaWx0ZXJPcHRpb24gPSAob3B0aW9uOiBOZ3hTZWxlY3RPcHRpb24pID0+IHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5zZWFyY2hDYWxsYmFjaykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zZWFyY2hDYWxsYmFjayhzZWFyY2gsIG9wdGlvbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiAoIXNlYXJjaCB8fCByZWdFeHAudGVzdChvcHRpb24udGV4dCkpICYmICghdGhpcy5tdWx0aXBsZSB8fCBzZWxlY3RlZE9wdGlvbnMuaW5kZXhPZihvcHRpb24pID09PSAtMSk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBvcHRpb25zLmZpbHRlcigob3B0aW9uOiBUU2VsZWN0T3B0aW9uKSA9PiB7XG4gICAgICAgICAgICBpZiAob3B0aW9uIGluc3RhbmNlb2YgTmd4U2VsZWN0T3B0aW9uKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZpbHRlck9wdGlvbig8Tmd4U2VsZWN0T3B0aW9uPm9wdGlvbik7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKG9wdGlvbiBpbnN0YW5jZW9mIE5neFNlbGVjdE9wdEdyb3VwKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc3ViT3AgPSA8Tmd4U2VsZWN0T3B0R3JvdXA+b3B0aW9uO1xuICAgICAgICAgICAgICAgIHN1Yk9wLmZpbHRlcigoc3ViT3B0aW9uOiBOZ3hTZWxlY3RPcHRpb24pID0+IGZpbHRlck9wdGlvbihzdWJPcHRpb24pKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gc3ViT3Aub3B0aW9uc0ZpbHRlcmVkLmxlbmd0aDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBlbnN1cmVWaXNpYmxlRWxlbWVudChlbGVtZW50OiBIVE1MRWxlbWVudCkge1xuICAgICAgICBpZiAodGhpcy5jaG9pY2VNZW51RWxSZWYgJiYgdGhpcy5jYWNoZUVsZW1lbnRPZmZzZXRUb3AgIT09IGVsZW1lbnQub2Zmc2V0VG9wKSB7XG4gICAgICAgICAgICB0aGlzLmNhY2hlRWxlbWVudE9mZnNldFRvcCA9IGVsZW1lbnQub2Zmc2V0VG9wO1xuICAgICAgICAgICAgY29uc3QgY29udGFpbmVyOiBIVE1MRWxlbWVudCA9IHRoaXMuY2hvaWNlTWVudUVsUmVmLm5hdGl2ZUVsZW1lbnQ7XG4gICAgICAgICAgICBpZiAodGhpcy5jYWNoZUVsZW1lbnRPZmZzZXRUb3AgPCBjb250YWluZXIuc2Nyb2xsVG9wKSB7XG4gICAgICAgICAgICAgICAgY29udGFpbmVyLnNjcm9sbFRvcCA9IHRoaXMuY2FjaGVFbGVtZW50T2Zmc2V0VG9wO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmNhY2hlRWxlbWVudE9mZnNldFRvcCArIGVsZW1lbnQub2Zmc2V0SGVpZ2h0ID4gY29udGFpbmVyLnNjcm9sbFRvcCArIGNvbnRhaW5lci5jbGllbnRIZWlnaHQpIHtcbiAgICAgICAgICAgICAgICBjb250YWluZXIuc2Nyb2xsVG9wID0gdGhpcy5jYWNoZUVsZW1lbnRPZmZzZXRUb3AgKyBlbGVtZW50Lm9mZnNldEhlaWdodCAtIGNvbnRhaW5lci5jbGllbnRIZWlnaHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgb3B0aW9uc09wZW4oc2VhcmNoOiBzdHJpbmcgPSAnJykge1xuICAgICAgICBpZiAoIXRoaXMuZGlzYWJsZWQpIHtcbiAgICAgICAgICAgIHRoaXMub3B0aW9uc09wZW5lZCA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLnN1YmpTZWFyY2hUZXh0Lm5leHQoc2VhcmNoKTtcbiAgICAgICAgICAgIGlmICghdGhpcy5tdWx0aXBsZSAmJiB0aGlzLnN1YmpPcHRpb25zU2VsZWN0ZWQudmFsdWUubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5uYXZpZ2F0ZU9wdGlvbihFTmF2aWdhdGlvbi5maXJzdFNlbGVjdGVkKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5uYXZpZ2F0ZU9wdGlvbihFTmF2aWdhdGlvbi5maXJzdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmZvY3VzVG9JbnB1dCgpO1xuICAgICAgICAgICAgdGhpcy5vcGVuLmVtaXQoKTtcbiAgICAgICAgICAgIHRoaXMuY2QubWFya0ZvckNoZWNrKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgb3B0aW9uc0Nsb3NlKC8qZm9jdXNUb0hvc3Q6IGJvb2xlYW4gPSBmYWxzZSovKSB7XG4gICAgICAgIHRoaXMub3B0aW9uc09wZW5lZCA9IGZhbHNlO1xuICAgICAgICAvLyBpZiAoZm9jdXNUb0hvc3QpIHtcbiAgICAgICAgLy8gICAgIGNvbnN0IHggPSB3aW5kb3cuc2Nyb2xsWCwgeSA9IHdpbmRvdy5zY3JvbGxZO1xuICAgICAgICAvLyAgICAgdGhpcy5tYWluRWxSZWYubmF0aXZlRWxlbWVudC5mb2N1cygpO1xuICAgICAgICAvLyAgICAgd2luZG93LnNjcm9sbFRvKHgsIHkpO1xuICAgICAgICAvLyB9XG4gICAgICAgIHRoaXMuY2xvc2UuZW1pdCgpO1xuXG4gICAgICAgIGlmICh0aGlzLmF1dG9DbGVhclNlYXJjaCAmJiB0aGlzLm11bHRpcGxlICYmIHRoaXMuaW5wdXRFbFJlZikge1xuICAgICAgICAgICAgdGhpcy5pbnB1dEVsUmVmLm5hdGl2ZUVsZW1lbnQudmFsdWUgPSBudWxsO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBidWlsZE9wdGlvbnMoZGF0YTogYW55W10pOiBBcnJheTxOZ3hTZWxlY3RPcHRpb24gfCBOZ3hTZWxlY3RPcHRHcm91cD4ge1xuICAgICAgICBjb25zdCByZXN1bHQ6IEFycmF5PE5neFNlbGVjdE9wdGlvbiB8IE5neFNlbGVjdE9wdEdyb3VwPiA9IFtdO1xuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShkYXRhKSkge1xuICAgICAgICAgICAgbGV0IG9wdGlvbjogTmd4U2VsZWN0T3B0aW9uO1xuICAgICAgICAgICAgZGF0YS5mb3JFYWNoKChpdGVtOiBhbnkpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBpc09wdEdyb3VwID0gdHlwZW9mIGl0ZW0gPT09ICdvYmplY3QnICYmIGl0ZW0gIT09IG51bGwgJiZcbiAgICAgICAgICAgICAgICAgICAgcHJvcGVydHlFeGlzdHMoaXRlbSwgdGhpcy5vcHRHcm91cExhYmVsRmllbGQpICYmIHByb3BlcnR5RXhpc3RzKGl0ZW0sIHRoaXMub3B0R3JvdXBPcHRpb25zRmllbGQpICYmXG4gICAgICAgICAgICAgICAgICAgIEFycmF5LmlzQXJyYXkoaXRlbVt0aGlzLm9wdEdyb3VwT3B0aW9uc0ZpZWxkXSk7XG4gICAgICAgICAgICAgICAgaWYgKGlzT3B0R3JvdXApIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgb3B0R3JvdXAgPSBuZXcgTmd4U2VsZWN0T3B0R3JvdXAoaXRlbVt0aGlzLm9wdEdyb3VwTGFiZWxGaWVsZF0pO1xuICAgICAgICAgICAgICAgICAgICBpdGVtW3RoaXMub3B0R3JvdXBPcHRpb25zRmllbGRdLmZvckVhY2goKHN1Yk9wdGlvbjogTmd4U2VsZWN0T3B0aW9uKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAob3B0aW9uID0gdGhpcy5idWlsZE9wdGlvbihzdWJPcHRpb24sIG9wdEdyb3VwKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdEdyb3VwLm9wdGlvbnMucHVzaChvcHRpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnB1c2gob3B0R3JvdXApO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAob3B0aW9uID0gdGhpcy5idWlsZE9wdGlvbihpdGVtLCBudWxsKSkge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQucHVzaChvcHRpb24pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBidWlsZE9wdGlvbihkYXRhOiBhbnksIHBhcmVudDogTmd4U2VsZWN0T3B0R3JvdXApOiBOZ3hTZWxlY3RPcHRpb24ge1xuICAgICAgICBsZXQgdmFsdWUsIHRleHQsIGRpc2FibGVkO1xuICAgICAgICBpZiAodHlwZW9mIGRhdGEgPT09ICdzdHJpbmcnIHx8IHR5cGVvZiBkYXRhID09PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgdmFsdWUgPSB0ZXh0ID0gZGF0YTtcbiAgICAgICAgICAgIGRpc2FibGVkID0gZmFsc2U7XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGRhdGEgPT09ICdvYmplY3QnICYmIGRhdGEgIT09IG51bGwgJiZcbiAgICAgICAgICAgIChwcm9wZXJ0eUV4aXN0cyhkYXRhLCB0aGlzLm9wdGlvblZhbHVlRmllbGQpIHx8IHByb3BlcnR5RXhpc3RzKGRhdGEsIHRoaXMub3B0aW9uVGV4dEZpZWxkKSkpIHtcbiAgICAgICAgICAgIHZhbHVlID0gcHJvcGVydHlFeGlzdHMoZGF0YSwgdGhpcy5vcHRpb25WYWx1ZUZpZWxkKSA/IGRhdGFbdGhpcy5vcHRpb25WYWx1ZUZpZWxkXSA6IGRhdGFbdGhpcy5vcHRpb25UZXh0RmllbGRdO1xuICAgICAgICAgICAgdGV4dCA9IHByb3BlcnR5RXhpc3RzKGRhdGEsIHRoaXMub3B0aW9uVGV4dEZpZWxkKSA/IGRhdGFbdGhpcy5vcHRpb25UZXh0RmllbGRdIDogZGF0YVt0aGlzLm9wdGlvblZhbHVlRmllbGRdO1xuICAgICAgICAgICAgZGlzYWJsZWQgPSBwcm9wZXJ0eUV4aXN0cyhkYXRhLCAnZGlzYWJsZWQnKSA/IGRhdGFbJ2Rpc2FibGVkJ10gOiBmYWxzZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXcgTmd4U2VsZWN0T3B0aW9uKHZhbHVlLCB0ZXh0LCBkaXNhYmxlZCwgZGF0YSwgcGFyZW50KTtcbiAgICB9XG5cbiAgICAvLy8vLy8vLy8vLy8gaW50ZXJmYWNlIENvbnRyb2xWYWx1ZUFjY2Vzc29yIC8vLy8vLy8vLy8vL1xuICAgIHB1YmxpYyBvbkNoYW5nZSA9ICh2OiBhbnkpID0+IHY7XG5cbiAgICBwdWJsaWMgb25Ub3VjaGVkOiAoKSA9PiB2b2lkID0gKCkgPT4gbnVsbDtcblxuICAgIHB1YmxpYyB3cml0ZVZhbHVlKG9iajogYW55KTogdm9pZCB7XG4gICAgICAgIHRoaXMuc3ViakV4dGVybmFsVmFsdWUubmV4dChvYmopO1xuICAgIH1cblxuICAgIHB1YmxpYyByZWdpc3Rlck9uQ2hhbmdlKGZuOiAoXzogYW55KSA9PiB7fSk6IHZvaWQge1xuICAgICAgICB0aGlzLm9uQ2hhbmdlID0gZm47XG4gICAgICAgIHRoaXMuc3VialJlZ2lzdGVyT25DaGFuZ2UubmV4dCgpO1xuICAgIH1cblxuICAgIHB1YmxpYyByZWdpc3Rlck9uVG91Y2hlZChmbjogKCkgPT4ge30pOiB2b2lkIHtcbiAgICAgICAgdGhpcy5vblRvdWNoZWQgPSBmbjtcbiAgICB9XG5cbiAgICBwdWJsaWMgc2V0RGlzYWJsZWRTdGF0ZShpc0Rpc2FibGVkOiBib29sZWFuKTogdm9pZCB7XG4gICAgICAgIHRoaXMuZGlzYWJsZWQgPSBpc0Rpc2FibGVkO1xuICAgICAgICB0aGlzLmNkLm1hcmtGb3JDaGVjaygpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7TW9kdWxlV2l0aFByb3ZpZGVycywgTmdNb2R1bGV9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHtDb21tb25Nb2R1bGV9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XG5pbXBvcnQge05HWF9TRUxFQ1RfT1BUSU9OUywgTmd4U2VsZWN0Q29tcG9uZW50fSBmcm9tICcuL25neC1zZWxlY3QuY29tcG9uZW50JztcbmltcG9ydCB7Tmd4U2VsZWN0T3B0aW9uRGlyZWN0aXZlLCBOZ3hTZWxlY3RPcHRpb25Ob3RGb3VuZERpcmVjdGl2ZSwgTmd4U2VsZWN0T3B0aW9uU2VsZWN0ZWREaXJlY3RpdmV9IGZyb20gJy4vbmd4LXRlbXBsYXRlcy5kaXJlY3RpdmUnO1xuaW1wb3J0IHtJTmd4U2VsZWN0T3B0aW9uc30gZnJvbSAnLi9uZ3gtc2VsZWN0LmludGVyZmFjZXMnO1xuXG5ATmdNb2R1bGUoe1xuICAgIGltcG9ydHM6IFtcbiAgICAgICAgQ29tbW9uTW9kdWxlXG4gICAgXSxcbiAgICBkZWNsYXJhdGlvbnM6IFtOZ3hTZWxlY3RDb21wb25lbnQsXG4gICAgICAgIE5neFNlbGVjdE9wdGlvbkRpcmVjdGl2ZSwgTmd4U2VsZWN0T3B0aW9uU2VsZWN0ZWREaXJlY3RpdmUsIE5neFNlbGVjdE9wdGlvbk5vdEZvdW5kRGlyZWN0aXZlXG4gICAgXSxcbiAgICBleHBvcnRzOiBbTmd4U2VsZWN0Q29tcG9uZW50LFxuICAgICAgICBOZ3hTZWxlY3RPcHRpb25EaXJlY3RpdmUsIE5neFNlbGVjdE9wdGlvblNlbGVjdGVkRGlyZWN0aXZlLCBOZ3hTZWxlY3RPcHRpb25Ob3RGb3VuZERpcmVjdGl2ZVxuICAgIF1cbn0pXG5leHBvcnQgY2xhc3MgTmd4U2VsZWN0TW9kdWxlIHtcbiAgICBzdGF0aWMgZm9yUm9vdChvcHRpb25zOiBJTmd4U2VsZWN0T3B0aW9ucyk6IE1vZHVsZVdpdGhQcm92aWRlcnMge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgbmdNb2R1bGU6IE5neFNlbGVjdE1vZHVsZSxcbiAgICAgICAgICAgIHByb3ZpZGVyczogW3twcm92aWRlOiBOR1hfU0VMRUNUX09QVElPTlMsIHVzZVZhbHVlOiBvcHRpb25zfV1cbiAgICAgICAgfTtcbiAgICB9XG59XG4iXSwibmFtZXMiOlsiRGlyZWN0aXZlIiwiVGVtcGxhdGVSZWYiLCJlc2NhcGVTdHJpbmciLCJJbmplY3Rpb25Ub2tlbiIsIkV2ZW50RW1pdHRlciIsIkJlaGF2aW9yU3ViamVjdCIsIlN1YmplY3QiLCJjb21iaW5lTGF0ZXN0IiwibWVyZ2UiLCJtYXAiLCJkaXN0aW5jdFVudGlsQ2hhbmdlZCIsInNoYXJlIiwiZmxhdE1hcCIsImZyb20iLCJvZiIsIkVNUFRZIiwidG9BcnJheSIsImZpbHRlciIsInRhcCIsIkNvbXBvbmVudCIsIkNoYW5nZURldGVjdGlvblN0cmF0ZWd5IiwiTkdfVkFMVUVfQUNDRVNTT1IiLCJmb3J3YXJkUmVmIiwiSXRlcmFibGVEaWZmZXJzIiwiRG9tU2FuaXRpemVyIiwiQ2hhbmdlRGV0ZWN0b3JSZWYiLCJJbmplY3QiLCJPcHRpb25hbCIsIklucHV0IiwiT3V0cHV0IiwiVmlld0NoaWxkIiwiQ29udGVudENoaWxkIiwiSG9zdExpc3RlbmVyIiwiTmdNb2R1bGUiLCJDb21tb25Nb2R1bGUiXSwibWFwcGluZ3MiOiI7Ozs7OztJQUFBOzs7Ozs7Ozs7Ozs7OztBQWNBLG9CQXVHdUIsQ0FBQyxFQUFFLENBQUM7UUFDdkIsSUFBSSxDQUFDLEdBQUcsT0FBTyxNQUFNLEtBQUssVUFBVSxJQUFJLENBQUMsQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDM0QsSUFBSSxDQUFDLENBQUM7WUFBRSxPQUFPLENBQUMsQ0FBQztRQUNqQixJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMs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