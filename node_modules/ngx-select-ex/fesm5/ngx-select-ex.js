import * as escapeStringNs from 'escape-string-regexp';
import { Directive, TemplateRef, Input, Output, ViewChild, Component, EventEmitter, forwardRef, HostListener, IterableDiffers, ChangeDetectorRef, ContentChild, Optional, Inject, InjectionToken, ChangeDetectionStrategy, NgModule } from '@angular/core';
import { __read, __spread } from 'tslib';
import { NG_VALUE_ACCESSOR } from '@angular/forms';
import { DomSanitizer } from '@angular/platform-browser';
import { Subject, BehaviorSubject, EMPTY, of, from, merge, combineLatest } from 'rxjs';
import { tap, filter, map, share, flatMap, toArray, distinctUntilChanged } from 'rxjs/operators';
import * as lodashNs from 'lodash';
import { CommonModule } from '@angular/common';

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */
/** @type {?} */
var escapeString = escapeStringNs;
var NgxSelectOption = /** @class */ (function () {
    function NgxSelectOption(value, text, disabled, data, _parent) {
        if (_parent === void 0) { _parent = null; }
        this.value = value;
        this.text = text;
        this.disabled = disabled;
        this.data = data;
        this._parent = _parent;
        this.type = 'option';
        this.cacheRenderedText = null;
    }
    Object.defineProperty(NgxSelectOption.prototype, "parent", {
        get: /**
         * @return {?}
         */
        function () {
            return this._parent;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @param {?} sanitizer
     * @param {?} highlightText
     * @return {?}
     */
    NgxSelectOption.prototype.renderText = /**
     * @param {?} sanitizer
     * @param {?} highlightText
     * @return {?}
     */
    function (sanitizer, highlightText) {
        if (this.cacheHighlightText !== highlightText || this.cacheRenderedText === null) {
            this.cacheHighlightText = highlightText;
            if (this.cacheHighlightText) {
                this.cacheRenderedText = sanitizer.bypassSecurityTrustHtml((this.text + '').replace(new RegExp(escapeString(this.cacheHighlightText), 'gi'), '<strong>$&</strong>'));
            }
            else {
                this.cacheRenderedText = sanitizer.bypassSecurityTrustHtml(this.text);
            }
        }
        return this.cacheRenderedText;
    };
    return NgxSelectOption;
}());
var NgxSelectOptGroup = /** @class */ (function () {
    function NgxSelectOptGroup(label, options) {
        if (options === void 0) { options = []; }
        this.label = label;
        this.options = options;
        this.type = 'optgroup';
        this.filter(function () { return true; });
    }
    /**
     * @param {?} callbackFn
     * @return {?}
     */
    NgxSelectOptGroup.prototype.filter = /**
     * @param {?} callbackFn
     * @return {?}
     */
    function (callbackFn) {
        this.optionsFiltered = this.options.filter(function (option) { return callbackFn(option); });
    };
    return NgxSelectOptGroup;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */
var NgxSelectOptionDirective = /** @class */ (function () {
    function NgxSelectOptionDirective(template) {
        this.template = template;
    }
    NgxSelectOptionDirective.decorators = [
        { type: Directive, args: [{ selector: '[ngx-select-option]' },] }
    ];
    /** @nocollapse */
    NgxSelectOptionDirective.ctorParameters = function () { return [
        { type: TemplateRef }
    ]; };
    return NgxSelectOptionDirective;
}());
var NgxSelectOptionSelectedDirective = /** @class */ (function () {
    function NgxSelectOptionSelectedDirective(template) {
        this.template = template;
    }
    NgxSelectOptionSelectedDirective.decorators = [
        { type: Directive, args: [{ selector: '[ngx-select-option-selected]' },] }
    ];
    /** @nocollapse */
    NgxSelectOptionSelectedDirective.ctorParameters = function () { return [
        { type: TemplateRef }
    ]; };
    return NgxSelectOptionSelectedDirective;
}());
var NgxSelectOptionNotFoundDirective = /** @class */ (function () {
    function NgxSelectOptionNotFoundDirective(template) {
        this.template = template;
    }
    NgxSelectOptionNotFoundDirective.decorators = [
        { type: Directive, args: [{ selector: '[ngx-select-option-not-found]' },] }
    ];
    /** @nocollapse */
    NgxSelectOptionNotFoundDirective.ctorParameters = function () { return [
        { type: TemplateRef }
    ]; };
    return NgxSelectOptionNotFoundDirective;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */
/** @type {?} */
var _ = lodashNs;
/** @type {?} */
var escapeString$1 = escapeStringNs;
/** @type {?} */
var NGX_SELECT_OPTIONS = new InjectionToken('NGX_SELECT_OPTIONS');
/** @enum {number} */
var ENavigation = {
    first: 0, previous: 1, next: 2, last: 3,
    firstSelected: 4, firstIfOptionActiveInvisible: 5,
};
ENavigation[ENavigation.first] = 'first';
ENavigation[ENavigation.previous] = 'previous';
ENavigation[ENavigation.next] = 'next';
ENavigation[ENavigation.last] = 'last';
ENavigation[ENavigation.firstSelected] = 'firstSelected';
ENavigation[ENavigation.firstIfOptionActiveInvisible] = 'firstIfOptionActiveInvisible';
/**
 * @param {?} obj
 * @param {?} propertyName
 * @return {?}
 */
function propertyExists(obj, propertyName) {
    return propertyName in obj;
}
var NgxSelectComponent = /** @class */ (function () {
    function NgxSelectComponent(iterableDiffers, sanitizer, cd, defaultOptions) {
        var _this = this;
        this.sanitizer = sanitizer;
        this.cd = cd;
        this.optionValueField = 'id';
        this.optionTextField = 'text';
        this.optGroupLabelField = 'label';
        this.optGroupOptionsField = 'options';
        this.multiple = false;
        this.allowClear = false;
        this.placeholder = '';
        this.noAutoComplete = false;
        this.disabled = false;
        this.defaultValue = [];
        this.autoSelectSingleOption = false;
        this.autoClearSearch = false;
        this.noResultsFound = 'No results found';
        this.size = 'default';
        this.autoActiveOnMouseEnter = true;
        this.isFocused = false;
        this.keyCodeToRemoveSelected = 'Delete';
        this.keyCodeToOptionsOpen = ['Enter', 'NumpadEnter'];
        this.keyCodeToOptionsClose = 'Escape';
        this.keyCodeToOptionsSelect = ['Enter', 'NumpadEnter'];
        this.keyCodeToNavigateFirst = 'ArrowLeft';
        this.keyCodeToNavigatePrevious = 'ArrowUp';
        this.keyCodeToNavigateNext = 'ArrowDown';
        this.keyCodeToNavigateLast = 'ArrowRight';
        this.typed = new EventEmitter();
        this.focus = new EventEmitter();
        this.blur = new EventEmitter();
        this.open = new EventEmitter();
        this.close = new EventEmitter();
        this.select = new EventEmitter();
        this.remove = new EventEmitter();
        this.navigated = new EventEmitter();
        this.selectionChanges = new EventEmitter();
        this.optionsOpened = false;
        this.actualValue = [];
        this.subjOptions = new BehaviorSubject([]);
        this.subjSearchText = new BehaviorSubject('');
        this.subjOptionsSelected = new BehaviorSubject([]);
        this.subjExternalValue = new BehaviorSubject([]);
        this.subjDefaultValue = new BehaviorSubject([]);
        this.subjRegisterOnChange = new Subject();
        this._focusToInput = false;
        this.onChange = function (v) { return v; };
        this.onTouched = function () { return null; };
        Object.assign(this, defaultOptions);
        // DIFFERS
        this.itemsDiffer = iterableDiffers.find([]).create(null);
        this.defaultValueDiffer = iterableDiffers.find([]).create(null);
        // OBSERVERS
        this.typed.subscribe(function (text) { return _this.subjSearchText.next(text); });
        this.subjOptionsSelected.subscribe(function (options) { return _this.selectionChanges.emit(options); });
        /** @type {?} */
        var cacheExternalValue;
        /** @type {?} */
        var subjActualValue = combineLatest(merge(this.subjExternalValue.pipe(map(function (v) { return cacheExternalValue = v === null ? [] : [].concat(v); })), this.subjOptionsSelected.pipe(map(function (options) { return options.map(function (o) { return o.value; }); }))), this.subjDefaultValue).pipe(map(function (_a) {
            var _b = __read(_a, 2), eVal = _b[0], dVal = _b[1];
            /** @type {?} */
            var newVal = _.isEqual(eVal, dVal) ? [] : eVal;
            return newVal.length ? newVal : dVal;
        }), distinctUntilChanged(function (x, y) { return _.isEqual(x, y); }), share());
        // Export actual value
        combineLatest(subjActualValue, this.subjRegisterOnChange)
            .pipe(map(function (_a) {
            var _b = __read(_a, 1), actualValue = _b[0];
            return actualValue;
        }))
            .subscribe(function (actualValue) {
            _this.actualValue = actualValue;
            if (!_.isEqual(actualValue, cacheExternalValue)) {
                cacheExternalValue = actualValue;
                if (_this.multiple) {
                    _this.onChange(actualValue);
                }
                else {
                    _this.onChange(actualValue.length ? actualValue[0] : null);
                }
            }
        });
        // Correct selected options when the options changed
        combineLatest(this.subjOptions.pipe(flatMap(function (options) { return from(options).pipe(flatMap(function (option) { return option instanceof NgxSelectOption
            ? of(option)
            : (option instanceof NgxSelectOptGroup ? from(option.options) : EMPTY); }), toArray()); })), subjActualValue).pipe(map(function (_a) {
            var _b = __read(_a, 2), optionsFlat = _b[0], actualValue = _b[1];
            /** @type {?} */
            var optionsSelected = [];
            actualValue.forEach(function (value) {
                /** @type {?} */
                var selectedOption = optionsFlat.find(function (option) { return option.value === value; });
                if (selectedOption) {
                    optionsSelected.push(selectedOption);
                }
            });
            if (_this.keepSelectedItems) {
                /** @type {?} */
                var optionValues_1 = optionsSelected.map(function (option) { return option.value; });
                /** @type {?} */
                var keptSelectedOptions = _this.subjOptionsSelected.value
                    .filter(function (selOption) { return optionValues_1.indexOf(selOption.value) === -1; });
                optionsSelected.push.apply(optionsSelected, __spread(keptSelectedOptions));
            }
            if (!_.isEqual(optionsSelected, _this.subjOptionsSelected.value)) {
                _this.subjOptionsSelected.next(optionsSelected);
                _this.cd.markForCheck();
            }
        })).subscribe();
        // Ensure working filter by a search text
        combineLatest(this.subjOptions, this.subjOptionsSelected, this.subjSearchText).pipe(map(function (_a) {
            var _b = __read(_a, 3), options = _b[0], selectedOptions = _b[1], search = _b[2];
            _this.optionsFiltered = _this.filterOptions(search, options, selectedOptions).map(function (option) {
                if (option instanceof NgxSelectOption) {
                    option.highlightedText = _this.highlightOption(option);
                }
                else if (option instanceof NgxSelectOptGroup) {
                    option.options.map(function (subOption) {
                        subOption.highlightedText = _this.highlightOption(subOption);
                        return subOption;
                    });
                }
                return option;
            });
            _this.cacheOptionsFilteredFlat = null;
            _this.navigateOption(ENavigation.firstIfOptionActiveInvisible);
            _this.cd.markForCheck();
            return selectedOptions;
        }), flatMap(function (selectedOptions) { return _this.optionsFilteredFlat().pipe(filter(function (flatOptions) { return _this.autoSelectSingleOption && flatOptions.length === 1 && !selectedOptions.length; })); })).subscribe(function (flatOptions) {
            _this.subjOptionsSelected.next(flatOptions);
            _this.cd.markForCheck();
        });
    }
    Object.defineProperty(NgxSelectComponent.prototype, "inputText", {
        get: /**
         * \@internal
         * @return {?}
         */
        function () {
            if (this.inputElRef && this.inputElRef.nativeElement) {
                return this.inputElRef.nativeElement.value;
            }
            return '';
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @param {?=} otherClassNames
     * @param {?=} useFormControl
     * @return {?}
     */
    NgxSelectComponent.prototype.setFormControlSize = /**
     * @param {?=} otherClassNames
     * @param {?=} useFormControl
     * @return {?}
     */
    function (otherClassNames, useFormControl) {
        if (otherClassNames === void 0) { otherClassNames = {}; }
        if (useFormControl === void 0) { useFormControl = true; }
        /** @type {?} */
        var formControlExtraClasses = useFormControl ? {
            'form-control-sm input-sm': this.size === 'small',
            'form-control-lg input-lg': this.size === 'large'
        } : {};
        return Object.assign(formControlExtraClasses, otherClassNames);
    };
    /**
     * @return {?}
     */
    NgxSelectComponent.prototype.setBtnSize = /**
     * @return {?}
     */
    function () {
        return { 'btn-sm': this.size === 'small', 'btn-lg': this.size === 'large' };
    };
    Object.defineProperty(NgxSelectComponent.prototype, "optionsSelected", {
        get: /**
         * @return {?}
         */
        function () {
            return this.subjOptionsSelected.value;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @param {?} event
     * @return {?}
     */
    NgxSelectComponent.prototype.mainClicked = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        event.clickedSelectComponent = this;
        if (!this.isFocused) {
            this.isFocused = true;
            this.focus.emit();
        }
    };
    /**
     * @param {?} event
     * @return {?}
     */
    NgxSelectComponent.prototype.documentClick = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        if (event.clickedSelectComponent !== this) {
            if (this.optionsOpened) {
                this.optionsClose();
                this.cd.detectChanges(); // fix error because of delay between different events
            }
            if (this.isFocused) {
                this.isFocused = false;
                this.blur.emit();
            }
        }
    };
    /**
     * @return {?}
     */
    NgxSelectComponent.prototype.optionsFilteredFlat = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.cacheOptionsFilteredFlat) {
            return of(this.cacheOptionsFilteredFlat);
        }
        return from(this.optionsFiltered).pipe(flatMap(function (option) {
            return option instanceof NgxSelectOption ? of(option) :
                (option instanceof NgxSelectOptGroup ? from(option.optionsFiltered) : EMPTY);
        }), filter(function (optionsFilteredFlat) { return !optionsFilteredFlat.disabled; }), toArray(), tap(function (optionsFilteredFlat) { return _this.cacheOptionsFilteredFlat = optionsFilteredFlat; }));
    };
    /**
     * @param {?} navigation
     * @return {?}
     */
    NgxSelectComponent.prototype.navigateOption = /**
     * @param {?} navigation
     * @return {?}
     */
    function (navigation) {
        var _this = this;
        this.optionsFilteredFlat().pipe(map(function (options) {
            /** @type {?} */
            var navigated = { index: -1, activeOption: null, filteredOptionList: options };
            /** @type {?} */
            var newActiveIdx;
            switch (navigation) {
                case ENavigation.first:
                    navigated.index = 0;
                    break;
                case ENavigation.previous:
                    newActiveIdx = options.indexOf(_this.optionActive) - 1;
                    navigated.index = newActiveIdx >= 0 ? newActiveIdx : options.length - 1;
                    break;
                case ENavigation.next:
                    newActiveIdx = options.indexOf(_this.optionActive) + 1;
                    navigated.index = newActiveIdx < options.length ? newActiveIdx : 0;
                    break;
                case ENavigation.last:
                    navigated.index = options.length - 1;
                    break;
                case ENavigation.firstSelected:
                    if (_this.subjOptionsSelected.value.length) {
                        navigated.index = options.indexOf(_this.subjOptionsSelected.value[0]);
                    }
                    break;
                case ENavigation.firstIfOptionActiveInvisible:
                    /** @type {?} */
                    var idxOfOptionActive = -1;
                    if (_this.optionActive) {
                        idxOfOptionActive = options.indexOf(options.find(function (x) { return x.value === _this.optionActive.value; }));
                    }
                    navigated.index = idxOfOptionActive > 0 ? idxOfOptionActive : 0;
                    break;
            }
            navigated.activeOption = options[navigated.index];
            return navigated;
        })).subscribe(function (newNavigated) { return _this.optionActivate(newNavigated); });
    };
    /**
     * @return {?}
     */
    NgxSelectComponent.prototype.ngDoCheck = /**
     * @return {?}
     */
    function () {
        if (this.itemsDiffer.diff(this.items)) {
            this.subjOptions.next(this.buildOptions(this.items));
        }
        /** @type {?} */
        var defVal = this.defaultValue ? [].concat(this.defaultValue) : [];
        if (this.defaultValueDiffer.diff(defVal)) {
            this.subjDefaultValue.next(defVal);
        }
    };
    /**
     * @return {?}
     */
    NgxSelectComponent.prototype.ngAfterContentChecked = /**
     * @return {?}
     */
    function () {
        if (this._focusToInput && this.checkInputVisibility() && this.inputElRef &&
            this.inputElRef.nativeElement !== document.activeElement) {
            this._focusToInput = false;
            this.inputElRef.nativeElement.focus();
        }
        if (this.choiceMenuElRef) {
            /** @type {?} */
            var ulElement = /** @type {?} */ (this.choiceMenuElRef.nativeElement);
            /** @type {?} */
            var element = /** @type {?} */ (ulElement.querySelector('a.ngx-select__item_active.active'));
            if (element && element.offsetHeight > 0) {
                this.ensureVisibleElement(element);
            }
        }
    };
    /**
     * @return {?}
     */
    NgxSelectComponent.prototype.canClearNotMultiple = /**
     * @return {?}
     */
    function () {
        return this.allowClear && !!this.subjOptionsSelected.value.length &&
            (!this.subjDefaultValue.value.length || this.subjDefaultValue.value[0] !== this.actualValue[0]);
    };
    /**
     * @return {?}
     */
    NgxSelectComponent.prototype.focusToInput = /**
     * @return {?}
     */
    function () {
        this._focusToInput = true;
    };
    /**
     * @param {?} event
     * @return {?}
     */
    NgxSelectComponent.prototype.inputKeyDown = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        /** @type {?} */
        var keysForOpenedState = [].concat(this.keyCodeToOptionsSelect, this.keyCodeToNavigateFirst, this.keyCodeToNavigatePrevious, this.keyCodeToNavigateNext, this.keyCodeToNavigateLast);
        /** @type {?} */
        var keysForClosedState = [].concat(this.keyCodeToOptionsOpen, this.keyCodeToRemoveSelected);
        if (this.optionsOpened && keysForOpenedState.indexOf(event.code) !== -1) {
            event.preventDefault();
            event.stopPropagation();
            switch (event.code) {
                case ([].concat(this.keyCodeToOptionsSelect).indexOf(event.code) + 1) && event.code:
                    this.optionSelect(this.optionActive);
                    this.navigateOption(ENavigation.next);
                    break;
                case this.keyCodeToNavigateFirst:
                    this.navigateOption(ENavigation.first);
                    break;
                case this.keyCodeToNavigatePrevious:
                    this.navigateOption(ENavigation.previous);
                    break;
                case this.keyCodeToNavigateLast:
                    this.navigateOption(ENavigation.last);
                    break;
                case this.keyCodeToNavigateNext:
                    this.navigateOption(ENavigation.next);
                    break;
            }
        }
        else if (!this.optionsOpened && keysForClosedState.indexOf(event.code) !== -1) {
            event.preventDefault();
            event.stopPropagation();
            switch (event.code) {
                case ([].concat(this.keyCodeToOptionsOpen).indexOf(event.code) + 1) && event.code:
                    this.optionsOpen();
                    break;
                case this.keyCodeToRemoveSelected:
                    this.optionRemove(this.subjOptionsSelected.value[this.subjOptionsSelected.value.length - 1], event);
                    break;
            }
        }
    };
    /**
     * @param {?} index
     * @param {?} option
     * @return {?}
     */
    NgxSelectComponent.prototype.trackByOption = /**
     * @param {?} index
     * @param {?} option
     * @return {?}
     */
    function (index, option) {
        return option instanceof NgxSelectOption ? option.value :
            (option instanceof NgxSelectOptGroup ? option.label : option);
    };
    /**
     * @return {?}
     */
    NgxSelectComponent.prototype.checkInputVisibility = /**
     * @return {?}
     */
    function () {
        return (this.multiple === true) || (this.optionsOpened && !this.noAutoComplete);
    };
    /**
     * \@internal
     * @param {?=} value
     * @param {?=} event
     * @return {?}
     */
    NgxSelectComponent.prototype.inputKeyUp = /**
     * \@internal
     * @param {?=} value
     * @param {?=} event
     * @return {?}
     */
    function (value, event) {
        if (value === void 0) { value = ''; }
        if (event.code === this.keyCodeToOptionsClose) {
            this.optionsClose();
        }
        else if (this.optionsOpened && (['ArrowDown', 'ArrowUp', 'ArrowLeft', 'ArrowDown'].indexOf(event.code) === -1) /*ignore arrows*/) {
            this.typed.emit(value);
        }
        else if (!this.optionsOpened && value) {
            this.optionsOpen(value);
        }
    };
    /**
     * \@internal
     * @param {?=} value
     * @return {?}
     */
    NgxSelectComponent.prototype.inputClick = /**
     * \@internal
     * @param {?=} value
     * @return {?}
     */
    function (value) {
        if (value === void 0) { value = ''; }
        if (!this.optionsOpened) {
            this.optionsOpen(value);
        }
    };
    /**
     * \@internal
     * @param {?} html
     * @return {?}
     */
    NgxSelectComponent.prototype.sanitize = /**
     * \@internal
     * @param {?} html
     * @return {?}
     */
    function (html) {
        return html ? this.sanitizer.bypassSecurityTrustHtml(html) : null;
    };
    /**
     * \@internal
     * @param {?} option
     * @return {?}
     */
    NgxSelectComponent.prototype.highlightOption = /**
     * \@internal
     * @param {?} option
     * @return {?}
     */
    function (option) {
        if (this.inputElRef) {
            return option.renderText(this.sanitizer, this.inputElRef.nativeElement.value);
        }
        return option.renderText(this.sanitizer, '');
    };
    /**
     * \@internal
     * @param {?} option
     * @param {?=} event
     * @return {?}
     */
    NgxSelectComponent.prototype.optionSelect = /**
     * \@internal
     * @param {?} option
     * @param {?=} event
     * @return {?}
     */
    function (option, event) {
        if (event === void 0) { event = null; }
        if (event) {
            event.preventDefault();
            event.stopPropagation();
        }
        if (option && !option.disabled) {
            this.subjOptionsSelected.next((this.multiple ? this.subjOptionsSelected.value : []).concat([option]));
            this.select.emit(option.value);
            this.optionsClose();
            this.onTouched();
        }
    };
    /**
     * \@internal
     * @param {?} option
     * @param {?} event
     * @return {?}
     */
    NgxSelectComponent.prototype.optionRemove = /**
     * \@internal
     * @param {?} option
     * @param {?} event
     * @return {?}
     */
    function (option, event) {
        if (!this.disabled && option) {
            event.stopPropagation();
            this.subjOptionsSelected.next((this.multiple ? this.subjOptionsSelected.value : []).filter(function (o) { return o !== option; }));
            this.remove.emit(option.value);
        }
    };
    /**
     * \@internal
     * @param {?} navigated
     * @return {?}
     */
    NgxSelectComponent.prototype.optionActivate = /**
     * \@internal
     * @param {?} navigated
     * @return {?}
     */
    function (navigated) {
        if ((this.optionActive !== navigated.activeOption) &&
            (!navigated.activeOption || !navigated.activeOption.disabled)) {
            if (this.optionActive) {
                this.optionActive.active = false;
            }
            this.optionActive = navigated.activeOption;
            if (this.optionActive) {
                this.optionActive.active = true;
            }
            this.navigated.emit(navigated);
            this.cd.detectChanges();
        }
    };
    /**
     * \@internal
     * @param {?} navigated
     * @return {?}
     */
    NgxSelectComponent.prototype.onMouseEnter = /**
     * \@internal
     * @param {?} navigated
     * @return {?}
     */
    function (navigated) {
        var _this = this;
        document.onmousemove = function () {
            if (_this.autoActiveOnMouseEnter) {
                _this.optionActivate(navigated);
            }
        };
    };
    /**
     * @param {?} search
     * @param {?} options
     * @param {?} selectedOptions
     * @return {?}
     */
    NgxSelectComponent.prototype.filterOptions = /**
     * @param {?} search
     * @param {?} options
     * @param {?} selectedOptions
     * @return {?}
     */
    function (search, options, selectedOptions) {
        var _this = this;
        /** @type {?} */
        var regExp = new RegExp(escapeString$1(search), 'i');
        /** @type {?} */
        var filterOption = function (option) {
            if (_this.searchCallback) {
                return _this.searchCallback(search, option);
            }
            return (!search || regExp.test(option.text)) && (!_this.multiple || selectedOptions.indexOf(option) === -1);
        };
        return options.filter(function (option) {
            if (option instanceof NgxSelectOption) {
                return filterOption(/** @type {?} */ (option));
            }
            else if (option instanceof NgxSelectOptGroup) {
                /** @type {?} */
                var subOp = /** @type {?} */ (option);
                subOp.filter(function (subOption) { return filterOption(subOption); });
                return subOp.optionsFiltered.length;
            }
        });
    };
    /**
     * @param {?} element
     * @return {?}
     */
    NgxSelectComponent.prototype.ensureVisibleElement = /**
     * @param {?} element
     * @return {?}
     */
    function (element) {
        if (this.choiceMenuElRef && this.cacheElementOffsetTop !== element.offsetTop) {
            this.cacheElementOffsetTop = element.offsetTop;
            /** @type {?} */
            var container = this.choiceMenuElRef.nativeElement;
            if (this.cacheElementOffsetTop < container.scrollTop) {
                container.scrollTop = this.cacheElementOffsetTop;
            }
            else if (this.cacheElementOffsetTop + element.offsetHeight > container.scrollTop + container.clientHeight) {
                container.scrollTop = this.cacheElementOffsetTop + element.offsetHeight - container.clientHeight;
            }
        }
    };
    /**
     * @param {?=} search
     * @return {?}
     */
    NgxSelectComponent.prototype.optionsOpen = /**
     * @param {?=} search
     * @return {?}
     */
    function (search) {
        if (search === void 0) { search = ''; }
        if (!this.disabled) {
            this.optionsOpened = true;
            this.subjSearchText.next(search);
            if (!this.multiple && this.subjOptionsSelected.value.length) {
                this.navigateOption(ENavigation.firstSelected);
            }
            else {
                this.navigateOption(ENavigation.first);
            }
            this.focusToInput();
            this.open.emit();
            this.cd.markForCheck();
        }
    };
    /**
     * @return {?}
     */
    NgxSelectComponent.prototype.optionsClose = /**
     * @return {?}
     */
    function () {
        this.optionsOpened = false;
        // if (focusToHost) {
        //     const x = window.scrollX, y = window.scrollY;
        //     this.mainElRef.nativeElement.focus();
        //     window.scrollTo(x, y);
        // }
        this.close.emit();
        if (this.autoClearSearch && this.multiple && this.inputElRef) {
            this.inputElRef.nativeElement.value = null;
        }
    };
    /**
     * @param {?} data
     * @return {?}
     */
    NgxSelectComponent.prototype.buildOptions = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        var _this = this;
        /** @type {?} */
        var result = [];
        if (Array.isArray(data)) {
            /** @type {?} */
            var option_1 = void 0;
            data.forEach(function (item) {
                /** @type {?} */
                var isOptGroup = typeof item === 'object' && item !== null &&
                    propertyExists(item, _this.optGroupLabelField) && propertyExists(item, _this.optGroupOptionsField) &&
                    Array.isArray(item[_this.optGroupOptionsField]);
                if (isOptGroup) {
                    /** @type {?} */
                    var optGroup_1 = new NgxSelectOptGroup(item[_this.optGroupLabelField]);
                    item[_this.optGroupOptionsField].forEach(function (subOption) {
                        if (option_1 = _this.buildOption(subOption, optGroup_1)) {
                            optGroup_1.options.push(option_1);
                        }
                    });
                    result.push(optGroup_1);
                }
                else if (option_1 = _this.buildOption(item, null)) {
                    result.push(option_1);
                }
            });
        }
        return result;
    };
    /**
     * @param {?} data
     * @param {?} parent
     * @return {?}
     */
    NgxSelectComponent.prototype.buildOption = /**
     * @param {?} data
     * @param {?} parent
     * @return {?}
     */
    function (data, parent) {
        /** @type {?} */
        var value;
        /** @type {?} */
        var text;
        /** @type {?} */
        var disabled;
        if (typeof data === 'string' || typeof data === 'number') {
            value = text = data;
            disabled = false;
        }
        else if (typeof data === 'object' && data !== null &&
            (propertyExists(data, this.optionValueField) || propertyExists(data, this.optionTextField))) {
            value = propertyExists(data, this.optionValueField) ? data[this.optionValueField] : data[this.optionTextField];
            text = propertyExists(data, this.optionTextField) ? data[this.optionTextField] : data[this.optionValueField];
            disabled = propertyExists(data, 'disabled') ? data['disabled'] : false;
        }
        else {
            return null;
        }
        return new NgxSelectOption(value, text, disabled, data, parent);
    };
    /**
     * @param {?} obj
     * @return {?}
     */
    NgxSelectComponent.prototype.writeValue = /**
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        this.subjExternalValue.next(obj);
    };
    /**
     * @param {?} fn
     * @return {?}
     */
    NgxSelectComponent.prototype.registerOnChange = /**
     * @param {?} fn
     * @return {?}
     */
    function (fn) {
        this.onChange = fn;
        this.subjRegisterOnChange.next();
    };
    /**
     * @param {?} fn
     * @return {?}
     */
    NgxSelectComponent.prototype.registerOnTouched = /**
     * @param {?} fn
     * @return {?}
     */
    function (fn) {
        this.onTouched = fn;
    };
    /**
     * @param {?} isDisabled
     * @return {?}
     */
    NgxSelectComponent.prototype.setDisabledState = /**
     * @param {?} isDisabled
     * @return {?}
     */
    function (isDisabled) {
        this.disabled = isDisabled;
        this.cd.markForCheck();
    };
    NgxSelectComponent.decorators = [
        { type: Component, args: [{
                    selector: 'ngx-select',
                    template: "<div #main [tabindex]=\"disabled? -1: 0\" class=\"ngx-select dropdown\"\n     [ngClass]=\"setFormControlSize({\n        'ngx-select_multiple form-control': multiple === true,\n        'open show': optionsOpened && optionsFiltered.length\n     }, multiple === true)\"\n     (click)=\"mainClicked($event)\" (focusin)=\"mainClicked($event)\"\n     (focus)=\"focusToInput()\" (keydown)=\"inputKeyDown($event)\">\n    <div [ngClass]=\"{ 'ngx-select__disabled': disabled}\"></div>\n\n    <!-- single selected item -->\n    <div class=\"ngx-select__selected\"\n         *ngIf=\"(multiple === false) && (!optionsOpened || noAutoComplete)\">\n        <div class=\"ngx-select__toggle btn form-control\" [ngClass]=\"setFormControlSize(setBtnSize())\"\n             (click)=\"optionsOpen()\">\n\n            <span *ngIf=\"!optionsSelected.length\" class=\"ngx-select__placeholder text-muted\">\n                <span [innerHtml]=\"placeholder\"></span>\n            </span>\n            <span *ngIf=\"optionsSelected.length\"\n                  class=\"ngx-select__selected-single pull-left float-left\"\n                  [ngClass]=\"{'ngx-select__allow-clear': allowClear}\">\n                <ng-container [ngTemplateOutlet]=\"templateSelectedOption || defaultTemplateOption\"\n                              [ngTemplateOutletContext]=\"{$implicit: optionsSelected[0], index: 0,\n                                                          text: sanitize(optionsSelected[0].text)}\">\n                </ng-container>\n            </span>\n            <span class=\"ngx-select__toggle-buttons\">\n                <a class=\"ngx-select__clear btn btn-sm btn-link\" *ngIf=\"canClearNotMultiple()\"\n                   [ngClass]=\"setBtnSize()\"\n                   (click)=\"optionRemove(optionsSelected[0], $event)\">\n                    <i class=\"ngx-select__clear-icon\"></i>\n                </a>\n                <i class=\"dropdown-toggle\"></i>\n                <i class=\"ngx-select__toggle-caret caret\"></i>\n            </span>\n        </div>\n    </div>\n\n    <!-- multiple selected items -->\n    <div class=\"ngx-select__selected\" *ngIf=\"multiple === true\">\n        <span *ngFor=\"let option of optionsSelected; trackBy: trackByOption; let idx = index\">\n            <span tabindex=\"-1\" [ngClass]=\"setBtnSize()\"\n                  class=\"ngx-select__selected-plural btn btn-default btn-secondary btn-xs\">\n\n                <ng-container [ngTemplateOutlet]=\"templateSelectedOption || defaultTemplateOption\"\n                              [ngTemplateOutletContext]=\"{$implicit: option, index: idx, text: sanitize(option.text)}\">\n                </ng-container>\n\n                <a class=\"ngx-select__clear btn btn-sm btn-link pull-right float-right\" [ngClass]=\"setBtnSize()\"\n                   (click)=\"optionRemove(option, $event)\">\n                    <i class=\"ngx-select__clear-icon\"></i>\n                </a>\n            </span>\n        </span>\n    </div>\n\n    <!-- live search an item from the list -->\n    <input #input type=\"text\" class=\"ngx-select__search form-control\" [ngClass]=\"setFormControlSize()\"\n           *ngIf=\"checkInputVisibility()\"\n           [tabindex]=\"multiple === false? -1: 0\"\n           (keyup)=\"inputKeyUp(input.value, $event)\"\n           [disabled]=\"disabled\"\n           [placeholder]=\"optionsSelected.length? '': placeholder\"\n           (click)=\"inputClick(input.value)\"\n           autocomplete=\"off\"\n           autocorrect=\"off\"\n           autocapitalize=\"off\"\n           spellcheck=\"false\"\n           role=\"combobox\">\n\n    <!-- options template -->\n    <ul #choiceMenu role=\"menu\" *ngIf=\"isFocused\" class=\"ngx-select__choices dropdown-menu\"\n        [class.show]=\"optionsOpened && subjOptions.value.length\">\n        <li class=\"ngx-select__item-group\" role=\"menuitem\"\n            *ngFor=\"let opt of optionsFiltered; trackBy: trackByOption; let idxGroup=index\">\n            <div class=\"divider dropdown-divider\" *ngIf=\"opt.type === 'optgroup' && (idxGroup > 0)\"></div>\n            <div class=\"dropdown-header\" *ngIf=\"opt.type === 'optgroup'\">{{opt.label}}</div>\n\n            <a href=\"#\" #choiceItem class=\"ngx-select__item dropdown-item\"\n               *ngFor=\"let option of (opt.optionsFiltered || [opt]); trackBy: trackByOption; let idxOption = index\"\n               [ngClass]=\"{\n                    'ngx-select__item_active active': option.active,\n                    'ngx-select__item_disabled disabled': option.disabled\n               }\"\n               (mouseenter)=\"onMouseEnter({\n                    activeOption: option,\n                    filteredOptionList: optionsFiltered,\n                    index: optionsFiltered.indexOf(option)\n               })\"\n               (click)=\"optionSelect(option, $event)\">\n                <ng-container [ngTemplateOutlet]=\"templateOption || defaultTemplateOption\"\n                              [ngTemplateOutletContext]=\"{$implicit: option, text: option.highlightedText,\n                              index: idxGroup, subIndex: idxOption}\"></ng-container>\n            </a>\n        </li>\n        <li class=\"ngx-select__item ngx-select__item_no-found dropdown-header\" *ngIf=\"!optionsFiltered.length\">\n            <ng-container [ngTemplateOutlet]=\"templateOptionNotFound || defaultTemplateOptionNotFound\"\n                          [ngTemplateOutletContext]=\"{$implicit: inputText}\"></ng-container>\n        </li>\n    </ul>\n\n    <!--Default templates-->\n    <ng-template #defaultTemplateOption let-text=\"text\">\n        <span [innerHtml]=\"text\"></span>\n    </ng-template>\n\n    <ng-template #defaultTemplateOptionNotFound>\n        {{noResultsFound}}\n    </ng-template>\n\n</div>\n",
                    changeDetection: ChangeDetectionStrategy.OnPush,
                    providers: [
                        {
                            provide: NG_VALUE_ACCESSOR,
                            useExisting: forwardRef(function () { return NgxSelectComponent; }),
                            multi: true
                        }
                    ],
                    styles: [".ngx-select_multiple{height:auto;padding:3px 3px 0}.ngx-select_multiple .ngx-select__search{background-color:transparent!important;border:none;outline:0;box-shadow:none;height:1.6666em;padding:0;margin-bottom:3px}.ngx-select__disabled{background-color:#eceeef;border-radius:4px;position:absolute;width:100%;height:100%;z-index:5;opacity:.6;top:0;left:0;cursor:not-allowed}.ngx-select__toggle{outline:0;position:relative;text-align:left!important;color:#333;background-color:#fff;border-color:#ccc;display:inline-flex;align-items:stretch;justify-content:space-between}.ngx-select__toggle:hover{color:#333;background-color:#e6e6e6;border-color:#adadad}.ngx-select__toggle-buttons{flex-shrink:0;display:flex;align-items:center}.ngx-select__toggle-caret{position:absolute;height:10px;top:50%;right:10px;margin-top:-2px}.ngx-select__placeholder{float:left;max-width:100%;text-overflow:ellipsis;overflow:hidden}.ngx-select__clear{margin-right:10px;padding:0;border:none}.ngx-select_multiple .ngx-select__clear{line-height:initial;margin-left:5px;margin-right:0;color:#000;opacity:.5}.ngx-select__clear-icon{display:inline-block;font-size:inherit;cursor:pointer;position:relative;width:1em;height:.75em;padding:0}.ngx-select__clear-icon:after,.ngx-select__clear-icon:before{content:'';position:absolute;border-top:3px solid;width:100%;top:50%;left:0;margin-top:-1px}.ngx-select__clear-icon:before{-webkit-transform:rotate(45deg);transform:rotate(45deg)}.ngx-select__clear-icon:after{-webkit-transform:rotate(-45deg);transform:rotate(-45deg)}.ngx-select__choices{width:100%;height:auto;max-height:200px;overflow-x:hidden;margin-top:0;position:absolute}.ngx-select_multiple .ngx-select__choices{margin-top:1px}.ngx-select__item{display:block;padding:3px 20px;clear:both;font-weight:400;line-height:1.42857143;white-space:nowrap;cursor:pointer;text-decoration:none}.ngx-select__item_disabled,.ngx-select__item_no-found{cursor:default}.ngx-select__item_active{color:#fff;outline:0;background-color:#428bca}.ngx-select__selected-plural,.ngx-select__selected-single{display:inline-flex;align-items:center;overflow:hidden}.ngx-select__selected-plural span,.ngx-select__selected-single span{overflow:hidden;text-overflow:ellipsis}.ngx-select__selected-plural{outline:0;margin:0 3px 3px 0}.input-group>.dropdown{position:static}"]
                }] }
    ];
    /** @nocollapse */
    NgxSelectComponent.ctorParameters = function () { return [
        { type: IterableDiffers },
        { type: DomSanitizer },
        { type: ChangeDetectorRef },
        { type: undefined, decorators: [{ type: Inject, args: [NGX_SELECT_OPTIONS,] }, { type: Optional }] }
    ]; };
    NgxSelectComponent.propDecorators = {
        items: [{ type: Input }],
        optionValueField: [{ type: Input }],
        optionTextField: [{ type: Input }],
        optGroupLabelField: [{ type: Input }],
        optGroupOptionsField: [{ type: Input }],
        multiple: [{ type: Input }],
        allowClear: [{ type: Input }],
        placeholder: [{ type: Input }],
        noAutoComplete: [{ type: Input }],
        disabled: [{ type: Input }],
        defaultValue: [{ type: Input }],
        autoSelectSingleOption: [{ type: Input }],
        autoClearSearch: [{ type: Input }],
        noResultsFound: [{ type: Input }],
        keepSelectedItems: [{ type: Input }],
        size: [{ type: Input }],
        searchCallback: [{ type: Input }],
        autoActiveOnMouseEnter: [{ type: Input }],
        isFocused: [{ type: Input }],
        typed: [{ type: Output }],
        focus: [{ type: Output }],
        blur: [{ type: Output }],
        open: [{ type: Output }],
        close: [{ type: Output }],
        select: [{ type: Output }],
        remove: [{ type: Output }],
        navigated: [{ type: Output }],
        selectionChanges: [{ type: Output }],
        mainElRef: [{ type: ViewChild, args: ['main',] }],
        inputElRef: [{ type: ViewChild, args: ['input',] }],
        choiceMenuElRef: [{ type: ViewChild, args: ['choiceMenu',] }],
        templateOption: [{ type: ContentChild, args: [NgxSelectOptionDirective, { read: TemplateRef },] }],
        templateSelectedOption: [{ type: ContentChild, args: [NgxSelectOptionSelectedDirective, { read: TemplateRef },] }],
        templateOptionNotFound: [{ type: ContentChild, args: [NgxSelectOptionNotFoundDirective, { read: TemplateRef },] }],
        documentClick: [{ type: HostListener, args: ['document:focusin', ['$event'],] }, { type: HostListener, args: ['document:click', ['$event'],] }]
    };
    return NgxSelectComponent;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */
var NgxSelectModule = /** @class */ (function () {
    function NgxSelectModule() {
    }
    /**
     * @param {?} options
     * @return {?}
     */
    NgxSelectModule.forRoot = /**
     * @param {?} options
     * @return {?}
     */
    function (options) {
        return {
            ngModule: NgxSelectModule,
            providers: [{ provide: NGX_SELECT_OPTIONS, useValue: options }]
        };
    };
    NgxSelectModule.decorators = [
        { type: NgModule, args: [{
                    imports: [
                        CommonModule
                    ],
                    declarations: [NgxSelectComponent,
                        NgxSelectOptionDirective, NgxSelectOptionSelectedDirective, NgxSelectOptionNotFoundDirective
                    ],
                    exports: [NgxSelectComponent,
                        NgxSelectOptionDirective, NgxSelectOptionSelectedDirective, NgxSelectOptionNotFoundDirective
                    ]
                },] }
    ];
    return NgxSelectModule;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */

export { NgxSelectModule, NGX_SELECT_OPTIONS, NgxSelectComponent, NgxSelectOption, NgxSelectOptGroup, NgxSelectOptionDirective, NgxSelectOptionSelectedDirective, NgxSelectOptionNotFoundDirective };

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LXNlbGVjdC1leC5qcy5tYXAiLCJzb3VyY2VzIjpbIm5nOi8vbmd4LXNlbGVjdC1leC9uZ3gtc2VsZWN0L25neC1zZWxlY3QuY2xhc3Nlcy50cyIsIm5nOi8vbmd4LXNlbGVjdC1leC9uZ3gtc2VsZWN0L25neC10ZW1wbGF0ZXMuZGlyZWN0aXZlLnRzIiwibmc6Ly9uZ3gtc2VsZWN0LWV4L25neC1zZWxlY3Qvbmd4LXNlbGVjdC5jb21wb25lbnQudHMiLCJuZzovL25neC1zZWxlY3QtZXgvbmd4LXNlbGVjdC9uZ3gtc2VsZWN0Lm1vZHVsZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge0RvbVNhbml0aXplciwgU2FmZUh0bWx9IGZyb20gJ0Bhbmd1bGFyL3BsYXRmb3JtLWJyb3dzZXInO1xuaW1wb3J0ICogYXMgZXNjYXBlU3RyaW5nTnMgZnJvbSAnZXNjYXBlLXN0cmluZy1yZWdleHAnO1xuaW1wb3J0IHtJTmd4U2VsZWN0T3B0R3JvdXAsIElOZ3hTZWxlY3RPcHRpb24sIElOZ3hTZWxlY3RPcHRpb25CYXNlLCBUTmd4U2VsZWN0T3B0aW9uVHlwZX0gZnJvbSAnLi9uZ3gtc2VsZWN0LmludGVyZmFjZXMnO1xuXG5jb25zdCBlc2NhcGVTdHJpbmcgPSBlc2NhcGVTdHJpbmdOcztcblxuZXhwb3J0IGNsYXNzIE5neFNlbGVjdE9wdGlvbiBpbXBsZW1lbnRzIElOZ3hTZWxlY3RPcHRpb24sIElOZ3hTZWxlY3RPcHRpb25CYXNlIHtcbiAgICByZWFkb25seSB0eXBlOiBUTmd4U2VsZWN0T3B0aW9uVHlwZSA9ICdvcHRpb24nO1xuXG4gIGhpZ2hsaWdodGVkVGV4dDogU2FmZUh0bWw7XG4gIGFjdGl2ZTogYm9vbGVhbjtcblxuICBjb25zdHJ1Y3RvcihwdWJsaWMgdmFsdWU6IG51bWJlciB8IHN0cmluZyxcbiAgICAgICAgICAgICAgICBwdWJsaWMgdGV4dDogc3RyaW5nLFxuICAgICAgICAgICAgICAgIHB1YmxpYyBkaXNhYmxlZDogYm9vbGVhbixcbiAgICAgICAgICAgICAgICBwdWJsaWMgZGF0YTogYW55LFxuICAgICAgICAgICAgICAgIHByaXZhdGUgX3BhcmVudDogTmd4U2VsZWN0T3B0R3JvdXAgPSBudWxsKSB7XG4gICAgfVxuXG4gICAgcHVibGljIGdldCBwYXJlbnQoKTogTmd4U2VsZWN0T3B0R3JvdXAge1xuICAgICAgICByZXR1cm4gdGhpcy5fcGFyZW50O1xuICAgIH1cblxuICAgIHByaXZhdGUgY2FjaGVIaWdobGlnaHRUZXh0OiBzdHJpbmc7XG4gICAgcHJpdmF0ZSBjYWNoZVJlbmRlcmVkVGV4dDogU2FmZUh0bWwgPSBudWxsO1xuXG4gICAgcHVibGljIHJlbmRlclRleHQoc2FuaXRpemVyOiBEb21TYW5pdGl6ZXIsIGhpZ2hsaWdodFRleHQ6IHN0cmluZyk6IFNhZmVIdG1sIHtcbiAgICAgICAgaWYgKHRoaXMuY2FjaGVIaWdobGlnaHRUZXh0ICE9PSBoaWdobGlnaHRUZXh0IHx8IHRoaXMuY2FjaGVSZW5kZXJlZFRleHQgPT09IG51bGwpIHtcbiAgICAgICAgICAgIHRoaXMuY2FjaGVIaWdobGlnaHRUZXh0ID0gaGlnaGxpZ2h0VGV4dDtcbiAgICAgICAgICAgIGlmICh0aGlzLmNhY2hlSGlnaGxpZ2h0VGV4dCkge1xuICAgICAgICAgICAgICAgIHRoaXMuY2FjaGVSZW5kZXJlZFRleHQgPSBzYW5pdGl6ZXIuYnlwYXNzU2VjdXJpdHlUcnVzdEh0bWwoKHRoaXMudGV4dCArICcnKS5yZXBsYWNlKFxuICAgICAgICAgICAgICAgICAgICBuZXcgUmVnRXhwKGVzY2FwZVN0cmluZyh0aGlzLmNhY2hlSGlnaGxpZ2h0VGV4dCksICdnaScpLCAnPHN0cm9uZz4kJjwvc3Ryb25nPidcbiAgICAgICAgICAgICAgICApKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jYWNoZVJlbmRlcmVkVGV4dCA9IHNhbml0aXplci5ieXBhc3NTZWN1cml0eVRydXN0SHRtbCh0aGlzLnRleHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLmNhY2hlUmVuZGVyZWRUZXh0O1xuICAgIH1cbn1cblxuZXhwb3J0IGNsYXNzIE5neFNlbGVjdE9wdEdyb3VwIGltcGxlbWVudHMgSU5neFNlbGVjdE9wdEdyb3VwLCBJTmd4U2VsZWN0T3B0aW9uQmFzZSB7XG4gICAgcmVhZG9ubHkgdHlwZTogVE5neFNlbGVjdE9wdGlvblR5cGUgPSAnb3B0Z3JvdXAnO1xuXG4gICAgcHVibGljIG9wdGlvbnNGaWx0ZXJlZDogTmd4U2VsZWN0T3B0aW9uW107XG5cbiAgICBjb25zdHJ1Y3RvcihwdWJsaWMgbGFiZWw6IHN0cmluZyxcbiAgICAgICAgICAgICAgICBwdWJsaWMgb3B0aW9uczogTmd4U2VsZWN0T3B0aW9uW10gPSBbXSkge1xuICAgICAgICB0aGlzLmZpbHRlcigoKSA9PiB0cnVlKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgZmlsdGVyKGNhbGxiYWNrRm46ICh2YWx1ZTogTmd4U2VsZWN0T3B0aW9uKSA9PiBhbnkpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5vcHRpb25zRmlsdGVyZWQgPSB0aGlzLm9wdGlvbnMuZmlsdGVyKChvcHRpb246IE5neFNlbGVjdE9wdGlvbikgPT4gY2FsbGJhY2tGbihvcHRpb24pKTtcbiAgICB9XG59XG5cbmV4cG9ydCB0eXBlIFRTZWxlY3RPcHRpb24gPSBOZ3hTZWxlY3RPcHRHcm91cCB8IE5neFNlbGVjdE9wdGlvbjtcbiIsImltcG9ydCB7RGlyZWN0aXZlLCBUZW1wbGF0ZVJlZn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5cbkBEaXJlY3RpdmUoe3NlbGVjdG9yOiAnW25neC1zZWxlY3Qtb3B0aW9uXSd9KVxuZXhwb3J0IGNsYXNzIE5neFNlbGVjdE9wdGlvbkRpcmVjdGl2ZSB7XG4gICAgY29uc3RydWN0b3IocHVibGljIHRlbXBsYXRlOiBUZW1wbGF0ZVJlZjxhbnk+KSB7XG4gICAgfVxufVxuXG5ARGlyZWN0aXZlKHtzZWxlY3RvcjogJ1tuZ3gtc2VsZWN0LW9wdGlvbi1zZWxlY3RlZF0nfSlcbmV4cG9ydCBjbGFzcyBOZ3hTZWxlY3RPcHRpb25TZWxlY3RlZERpcmVjdGl2ZSB7XG4gICAgY29uc3RydWN0b3IocHVibGljIHRlbXBsYXRlOiBUZW1wbGF0ZVJlZjxhbnk+KSB7XG4gICAgfVxufVxuXG5ARGlyZWN0aXZlKHtzZWxlY3RvcjogJ1tuZ3gtc2VsZWN0LW9wdGlvbi1ub3QtZm91bmRdJ30pXG5leHBvcnQgY2xhc3MgTmd4U2VsZWN0T3B0aW9uTm90Rm91bmREaXJlY3RpdmUge1xuICAgIGNvbnN0cnVjdG9yKHB1YmxpYyB0ZW1wbGF0ZTogVGVtcGxhdGVSZWY8YW55Pikge1xuICAgIH1cbn1cbiIsImltcG9ydCB7XG4gICAgQWZ0ZXJDb250ZW50Q2hlY2tlZCwgRG9DaGVjaywgSW5wdXQsIE91dHB1dCwgVmlld0NoaWxkLFxuICAgIENvbXBvbmVudCwgRWxlbWVudFJlZiwgRXZlbnRFbWl0dGVyLCBmb3J3YXJkUmVmLCBIb3N0TGlzdGVuZXIsIEl0ZXJhYmxlRGlmZmVyLCBJdGVyYWJsZURpZmZlcnMsIENoYW5nZURldGVjdG9yUmVmLCBDb250ZW50Q2hpbGQsXG4gICAgVGVtcGxhdGVSZWYsIE9wdGlvbmFsLCBJbmplY3QsIEluamVjdGlvblRva2VuLCBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneVxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7Q29udHJvbFZhbHVlQWNjZXNzb3IsIE5HX1ZBTFVFX0FDQ0VTU09SfSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XG5pbXBvcnQge0RvbVNhbml0aXplciwgU2FmZUh0bWx9IGZyb20gJ0Bhbmd1bGFyL3BsYXRmb3JtLWJyb3dzZXInO1xuaW1wb3J0IHtPYnNlcnZhYmxlLCBTdWJqZWN0LCBCZWhhdmlvclN1YmplY3QsIEVNUFRZLCBvZiwgZnJvbSwgbWVyZ2UsIGNvbWJpbmVMYXRlc3R9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHt0YXAsIGZpbHRlciwgbWFwLCBzaGFyZSwgZmxhdE1hcCwgdG9BcnJheSwgZGlzdGluY3RVbnRpbENoYW5nZWR9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcbmltcG9ydCAqIGFzIGxvZGFzaE5zIGZyb20gJ2xvZGFzaCc7XG5pbXBvcnQgKiBhcyBlc2NhcGVTdHJpbmdOcyBmcm9tICdlc2NhcGUtc3RyaW5nLXJlZ2V4cCc7XG5pbXBvcnQge05neFNlbGVjdE9wdEdyb3VwLCBOZ3hTZWxlY3RPcHRpb24sIFRTZWxlY3RPcHRpb259IGZyb20gJy4vbmd4LXNlbGVjdC5jbGFzc2VzJztcbmltcG9ydCB7Tmd4U2VsZWN0T3B0aW9uRGlyZWN0aXZlLCBOZ3hTZWxlY3RPcHRpb25Ob3RGb3VuZERpcmVjdGl2ZSwgTmd4U2VsZWN0T3B0aW9uU2VsZWN0ZWREaXJlY3RpdmV9IGZyb20gJy4vbmd4LXRlbXBsYXRlcy5kaXJlY3RpdmUnO1xuaW1wb3J0IHtJTmd4T3B0aW9uTmF2aWdhdGVkLCBJTmd4U2VsZWN0T3B0aW9uLCBJTmd4U2VsZWN0T3B0aW9uc30gZnJvbSAnLi9uZ3gtc2VsZWN0LmludGVyZmFjZXMnO1xuXG5jb25zdCBfID0gbG9kYXNoTnM7XG5jb25zdCBlc2NhcGVTdHJpbmcgPSBlc2NhcGVTdHJpbmdOcztcblxuZXhwb3J0IGNvbnN0IE5HWF9TRUxFQ1RfT1BUSU9OUyA9IG5ldyBJbmplY3Rpb25Ub2tlbjxhbnk+KCdOR1hfU0VMRUNUX09QVElPTlMnKTtcblxuZXhwb3J0IGludGVyZmFjZSBJTmd4U2VsZWN0Q29tcG9uZW50TW91c2VFdmVudCBleHRlbmRzIE1vdXNlRXZlbnQge1xuICAgIGNsaWNrZWRTZWxlY3RDb21wb25lbnQ/OiBOZ3hTZWxlY3RDb21wb25lbnQ7XG59XG5cbmVudW0gRU5hdmlnYXRpb24ge1xuICAgIGZpcnN0LCBwcmV2aW91cywgbmV4dCwgbGFzdCxcbiAgICBmaXJzdFNlbGVjdGVkLCBmaXJzdElmT3B0aW9uQWN0aXZlSW52aXNpYmxlXG59XG5cbmZ1bmN0aW9uIHByb3BlcnR5RXhpc3RzKG9iajogT2JqZWN0LCBwcm9wZXJ0eU5hbWU6IHN0cmluZykge1xuICAgIHJldHVybiBwcm9wZXJ0eU5hbWUgaW4gb2JqO1xufVxuXG5AQ29tcG9uZW50KHtcbiAgICBzZWxlY3RvcjogJ25neC1zZWxlY3QnLFxuICAgIHRlbXBsYXRlVXJsOiAnLi9uZ3gtc2VsZWN0LmNvbXBvbmVudC5odG1sJyxcbiAgICBzdHlsZVVybHM6IFsnLi9uZ3gtc2VsZWN0LmNvbXBvbmVudC5zY3NzJ10sXG4gICAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2gsXG4gICAgcHJvdmlkZXJzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIHByb3ZpZGU6IE5HX1ZBTFVFX0FDQ0VTU09SLFxuICAgICAgICAgICAgdXNlRXhpc3Rpbmc6IGZvcndhcmRSZWYoKCkgPT4gTmd4U2VsZWN0Q29tcG9uZW50KSxcbiAgICAgICAgICAgIG11bHRpOiB0cnVlXG4gICAgICAgIH1cbiAgICBdXG59KVxuZXhwb3J0IGNsYXNzIE5neFNlbGVjdENvbXBvbmVudCBpbXBsZW1lbnRzIElOZ3hTZWxlY3RPcHRpb25zLCBDb250cm9sVmFsdWVBY2Nlc3NvciwgRG9DaGVjaywgQWZ0ZXJDb250ZW50Q2hlY2tlZCB7XG4gICAgQElucHV0KCkgcHVibGljIGl0ZW1zOiBhbnlbXTtcbiAgICBASW5wdXQoKSBwdWJsaWMgb3B0aW9uVmFsdWVGaWVsZCA9ICdpZCc7XG4gICAgQElucHV0KCkgcHVibGljIG9wdGlvblRleHRGaWVsZCA9ICd0ZXh0JztcbiAgICBASW5wdXQoKSBwdWJsaWMgb3B0R3JvdXBMYWJlbEZpZWxkID0gJ2xhYmVsJztcbiAgICBASW5wdXQoKSBwdWJsaWMgb3B0R3JvdXBPcHRpb25zRmllbGQgPSAnb3B0aW9ucyc7XG4gICAgQElucHV0KCkgcHVibGljIG11bHRpcGxlID0gZmFsc2U7XG4gICAgQElucHV0KCkgcHVibGljIGFsbG93Q2xlYXIgPSBmYWxzZTtcbiAgICBASW5wdXQoKSBwdWJsaWMgcGxhY2Vob2xkZXIgPSAnJztcbiAgICBASW5wdXQoKSBwdWJsaWMgbm9BdXRvQ29tcGxldGUgPSBmYWxzZTtcbiAgICBASW5wdXQoKSBwdWJsaWMgZGlzYWJsZWQgPSBmYWxzZTtcbiAgICBASW5wdXQoKSBwdWJsaWMgZGVmYXVsdFZhbHVlOiBhbnlbXSA9IFtdO1xuICAgIEBJbnB1dCgpIHB1YmxpYyBhdXRvU2VsZWN0U2luZ2xlT3B0aW9uID0gZmFsc2U7XG4gICAgQElucHV0KCkgcHVibGljIGF1dG9DbGVhclNlYXJjaCA9IGZhbHNlO1xuICAgIEBJbnB1dCgpIHB1YmxpYyBub1Jlc3VsdHNGb3VuZCA9ICdObyByZXN1bHRzIGZvdW5kJztcbiAgICBASW5wdXQoKSBwdWJsaWMga2VlcFNlbGVjdGVkSXRlbXM6IGZhbHNlO1xuICAgIEBJbnB1dCgpIHB1YmxpYyBzaXplOiAnc21hbGwnIHwgJ2RlZmF1bHQnIHwgJ2xhcmdlJyA9ICdkZWZhdWx0JztcbiAgICBASW5wdXQoKSBwdWJsaWMgc2VhcmNoQ2FsbGJhY2s6IChzZWFyY2g6IHN0cmluZywgaXRlbTogSU5neFNlbGVjdE9wdGlvbikgPT4gYm9vbGVhbjtcbiAgICBASW5wdXQoKSBwdWJsaWMgYXV0b0FjdGl2ZU9uTW91c2VFbnRlciA9IHRydWU7XG4gICAgQElucHV0KCkgcHVibGljIGlzRm9jdXNlZCA9IGZhbHNlO1xuICAgIHB1YmxpYyBrZXlDb2RlVG9SZW1vdmVTZWxlY3RlZCA9ICdEZWxldGUnO1xuICAgIHB1YmxpYyBrZXlDb2RlVG9PcHRpb25zT3BlbiA9IFsnRW50ZXInLCAnTnVtcGFkRW50ZXInXTtcbiAgICBwdWJsaWMga2V5Q29kZVRvT3B0aW9uc0Nsb3NlID0gJ0VzY2FwZSc7XG4gICAgcHVibGljIGtleUNvZGVUb09wdGlvbnNTZWxlY3QgPSBbJ0VudGVyJywgJ051bXBhZEVudGVyJ107XG4gICAgcHVibGljIGtleUNvZGVUb05hdmlnYXRlRmlyc3QgPSAnQXJyb3dMZWZ0JztcbiAgICBwdWJsaWMga2V5Q29kZVRvTmF2aWdhdGVQcmV2aW91cyA9ICdBcnJvd1VwJztcbiAgICBwdWJsaWMga2V5Q29kZVRvTmF2aWdhdGVOZXh0ID0gJ0Fycm93RG93bic7XG4gICAgcHVibGljIGtleUNvZGVUb05hdmlnYXRlTGFzdCA9ICdBcnJvd1JpZ2h0JztcblxuICAgIEBPdXRwdXQoKSBwdWJsaWMgdHlwZWQgPSBuZXcgRXZlbnRFbWl0dGVyPHN0cmluZz4oKTtcbiAgICBAT3V0cHV0KCkgcHVibGljIGZvY3VzID0gbmV3IEV2ZW50RW1pdHRlcjx2b2lkPigpO1xuICAgIEBPdXRwdXQoKSBwdWJsaWMgYmx1ciA9IG5ldyBFdmVudEVtaXR0ZXI8dm9pZD4oKTtcbiAgICBAT3V0cHV0KCkgcHVibGljIG9wZW4gPSBuZXcgRXZlbnRFbWl0dGVyPHZvaWQ+KCk7XG4gICAgQE91dHB1dCgpIHB1YmxpYyBjbG9zZSA9IG5ldyBFdmVudEVtaXR0ZXI8dm9pZD4oKTtcbiAgICBAT3V0cHV0KCkgcHVibGljIHNlbGVjdCA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xuICAgIEBPdXRwdXQoKSBwdWJsaWMgcmVtb3ZlID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XG4gICAgQE91dHB1dCgpIHB1YmxpYyBuYXZpZ2F0ZWQgPSBuZXcgRXZlbnRFbWl0dGVyPElOZ3hPcHRpb25OYXZpZ2F0ZWQ+KCk7XG4gICAgQE91dHB1dCgpIHB1YmxpYyBzZWxlY3Rpb25DaGFuZ2VzID0gbmV3IEV2ZW50RW1pdHRlcjxJTmd4U2VsZWN0T3B0aW9uW10+KCk7XG5cbiAgICBAVmlld0NoaWxkKCdtYWluJykgcHJvdGVjdGVkIG1haW5FbFJlZjogRWxlbWVudFJlZjtcbiAgICBAVmlld0NoaWxkKCdpbnB1dCcpIHByb3RlY3RlZCBpbnB1dEVsUmVmOiBFbGVtZW50UmVmO1xuICAgIEBWaWV3Q2hpbGQoJ2Nob2ljZU1lbnUnKSBwcm90ZWN0ZWQgY2hvaWNlTWVudUVsUmVmOiBFbGVtZW50UmVmO1xuXG4gICAgQENvbnRlbnRDaGlsZChOZ3hTZWxlY3RPcHRpb25EaXJlY3RpdmUsIHtyZWFkOiBUZW1wbGF0ZVJlZn0pIHRlbXBsYXRlT3B0aW9uOiBOZ3hTZWxlY3RPcHRpb25EaXJlY3RpdmU7XG4gICAgQENvbnRlbnRDaGlsZChOZ3hTZWxlY3RPcHRpb25TZWxlY3RlZERpcmVjdGl2ZSwge3JlYWQ6IFRlbXBsYXRlUmVmfSkgdGVtcGxhdGVTZWxlY3RlZE9wdGlvbjogTmd4U2VsZWN0T3B0aW9uU2VsZWN0ZWREaXJlY3RpdmU7XG4gICAgQENvbnRlbnRDaGlsZChOZ3hTZWxlY3RPcHRpb25Ob3RGb3VuZERpcmVjdGl2ZSwge3JlYWQ6IFRlbXBsYXRlUmVmfSkgdGVtcGxhdGVPcHRpb25Ob3RGb3VuZDogTmd4U2VsZWN0T3B0aW9uTm90Rm91bmREaXJlY3RpdmU7XG5cbiAgICBwdWJsaWMgb3B0aW9uc09wZW5lZCA9IGZhbHNlO1xuICAgIHB1YmxpYyBvcHRpb25zRmlsdGVyZWQ6IFRTZWxlY3RPcHRpb25bXTtcblxuICAgIHByaXZhdGUgb3B0aW9uQWN0aXZlOiBOZ3hTZWxlY3RPcHRpb247XG4gICAgcHJpdmF0ZSBpdGVtc0RpZmZlcjogSXRlcmFibGVEaWZmZXI8YW55PjtcbiAgICBwcml2YXRlIGRlZmF1bHRWYWx1ZURpZmZlcjogSXRlcmFibGVEaWZmZXI8YW55W10+O1xuICAgIHByaXZhdGUgYWN0dWFsVmFsdWU6IGFueVtdID0gW107XG5cbiAgICBwdWJsaWMgc3Viak9wdGlvbnMgPSBuZXcgQmVoYXZpb3JTdWJqZWN0PFRTZWxlY3RPcHRpb25bXT4oW10pO1xuICAgIHByaXZhdGUgc3VialNlYXJjaFRleHQgPSBuZXcgQmVoYXZpb3JTdWJqZWN0PHN0cmluZz4oJycpO1xuXG4gICAgcHJpdmF0ZSBzdWJqT3B0aW9uc1NlbGVjdGVkID0gbmV3IEJlaGF2aW9yU3ViamVjdDxOZ3hTZWxlY3RPcHRpb25bXT4oW10pO1xuICAgIHByaXZhdGUgc3ViakV4dGVybmFsVmFsdWUgPSBuZXcgQmVoYXZpb3JTdWJqZWN0PGFueVtdPihbXSk7XG4gICAgcHJpdmF0ZSBzdWJqRGVmYXVsdFZhbHVlID0gbmV3IEJlaGF2aW9yU3ViamVjdDxhbnlbXT4oW10pO1xuICAgIHByaXZhdGUgc3VialJlZ2lzdGVyT25DaGFuZ2UgPSBuZXcgU3ViamVjdCgpO1xuXG4gICAgcHJpdmF0ZSBjYWNoZU9wdGlvbnNGaWx0ZXJlZEZsYXQ6IE5neFNlbGVjdE9wdGlvbltdO1xuICAgIHByaXZhdGUgY2FjaGVFbGVtZW50T2Zmc2V0VG9wOiBudW1iZXI7XG5cbiAgICBwcml2YXRlIF9mb2N1c1RvSW5wdXQgPSBmYWxzZTtcblxuICAgIC8qKiBAaW50ZXJuYWwgKi9cbiAgICBwdWJsaWMgZ2V0IGlucHV0VGV4dCgpIHtcbiAgICAgICAgaWYgKHRoaXMuaW5wdXRFbFJlZiAmJiB0aGlzLmlucHV0RWxSZWYubmF0aXZlRWxlbWVudCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuaW5wdXRFbFJlZi5uYXRpdmVFbGVtZW50LnZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAnJztcbiAgICB9XG5cbiAgICBjb25zdHJ1Y3RvcihpdGVyYWJsZURpZmZlcnM6IEl0ZXJhYmxlRGlmZmVycywgcHJpdmF0ZSBzYW5pdGl6ZXI6IERvbVNhbml0aXplciwgcHJpdmF0ZSBjZDogQ2hhbmdlRGV0ZWN0b3JSZWYsXG4gICAgICAgICAgICAgICAgQEluamVjdChOR1hfU0VMRUNUX09QVElPTlMpIEBPcHRpb25hbCgpIGRlZmF1bHRPcHRpb25zOiBJTmd4U2VsZWN0T3B0aW9ucykge1xuICAgICAgICBPYmplY3QuYXNzaWduKHRoaXMsIGRlZmF1bHRPcHRpb25zKTtcblxuICAgICAgICAvLyBESUZGRVJTXG4gICAgICAgIHRoaXMuaXRlbXNEaWZmZXIgPSBpdGVyYWJsZURpZmZlcnMuZmluZChbXSkuY3JlYXRlPGFueT4obnVsbCk7XG4gICAgICAgIHRoaXMuZGVmYXVsdFZhbHVlRGlmZmVyID0gaXRlcmFibGVEaWZmZXJzLmZpbmQoW10pLmNyZWF0ZTxhbnk+KG51bGwpO1xuXG4gICAgICAgIC8vIE9CU0VSVkVSU1xuICAgICAgICB0aGlzLnR5cGVkLnN1YnNjcmliZSgodGV4dDogc3RyaW5nKSA9PiB0aGlzLnN1YmpTZWFyY2hUZXh0Lm5leHQodGV4dCkpO1xuICAgICAgICB0aGlzLnN1YmpPcHRpb25zU2VsZWN0ZWQuc3Vic2NyaWJlKChvcHRpb25zOiBOZ3hTZWxlY3RPcHRpb25bXSkgPT4gdGhpcy5zZWxlY3Rpb25DaGFuZ2VzLmVtaXQob3B0aW9ucykpO1xuICAgICAgICBsZXQgY2FjaGVFeHRlcm5hbFZhbHVlOiBhbnlbXTtcblxuICAgICAgICAvLyBHZXQgYWN0dWFsIHZhbHVlXG4gICAgICAgIGNvbnN0IHN1YmpBY3R1YWxWYWx1ZSA9IGNvbWJpbmVMYXRlc3QoXG4gICAgICAgICAgICBtZXJnZShcbiAgICAgICAgICAgICAgICB0aGlzLnN1YmpFeHRlcm5hbFZhbHVlLnBpcGUobWFwKFxuICAgICAgICAgICAgICAgICAgICAodjogYW55W10pID0+IGNhY2hlRXh0ZXJuYWxWYWx1ZSA9IHYgPT09IG51bGwgPyBbXSA6IFtdLmNvbmNhdCh2KVxuICAgICAgICAgICAgICAgICkpLFxuICAgICAgICAgICAgICAgIHRoaXMuc3Viak9wdGlvbnNTZWxlY3RlZC5waXBlKG1hcChcbiAgICAgICAgICAgICAgICAgICAgKG9wdGlvbnM6IE5neFNlbGVjdE9wdGlvbltdKSA9PiBvcHRpb25zLm1hcCgobzogTmd4U2VsZWN0T3B0aW9uKSA9PiBvLnZhbHVlKVxuICAgICAgICAgICAgICAgICkpXG4gICAgICAgICAgICApLFxuICAgICAgICAgICAgdGhpcy5zdWJqRGVmYXVsdFZhbHVlXG4gICAgICAgICkucGlwZShcbiAgICAgICAgICAgIG1hcCgoW2VWYWwsIGRWYWxdOiBbYW55W10sIGFueVtdXSkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IG5ld1ZhbCA9IF8uaXNFcXVhbChlVmFsLCBkVmFsKSA/IFtdIDogZVZhbDtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3VmFsLmxlbmd0aCA/IG5ld1ZhbCA6IGRWYWw7XG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIGRpc3RpbmN0VW50aWxDaGFuZ2VkKCh4LCB5KSA9PiBfLmlzRXF1YWwoeCwgeSkpLFxuICAgICAgICAgICAgc2hhcmUoKVxuICAgICAgICApO1xuXG4gICAgICAgIC8vIEV4cG9ydCBhY3R1YWwgdmFsdWVcbiAgICAgICAgY29tYmluZUxhdGVzdChzdWJqQWN0dWFsVmFsdWUsIHRoaXMuc3VialJlZ2lzdGVyT25DaGFuZ2UpXG4gICAgICAgICAgICAucGlwZShtYXAoKFthY3R1YWxWYWx1ZV06IFthbnlbXSwgYW55W11dKSA9PiBhY3R1YWxWYWx1ZSkpXG4gICAgICAgICAgICAuc3Vic2NyaWJlKChhY3R1YWxWYWx1ZTogYW55W10pID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmFjdHVhbFZhbHVlID0gYWN0dWFsVmFsdWU7XG4gICAgICAgICAgICAgICAgaWYgKCFfLmlzRXF1YWwoYWN0dWFsVmFsdWUsIGNhY2hlRXh0ZXJuYWxWYWx1ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FjaGVFeHRlcm5hbFZhbHVlID0gYWN0dWFsVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm11bHRpcGxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9uQ2hhbmdlKGFjdHVhbFZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub25DaGFuZ2UoYWN0dWFsVmFsdWUubGVuZ3RoID8gYWN0dWFsVmFsdWVbMF0gOiBudWxsKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIC8vIENvcnJlY3Qgc2VsZWN0ZWQgb3B0aW9ucyB3aGVuIHRoZSBvcHRpb25zIGNoYW5nZWRcbiAgICAgICAgY29tYmluZUxhdGVzdChcbiAgICAgICAgICAgIHRoaXMuc3Viak9wdGlvbnMucGlwZShcbiAgICAgICAgICAgICAgICBmbGF0TWFwKChvcHRpb25zOiBUU2VsZWN0T3B0aW9uW10pID0+IGZyb20ob3B0aW9ucykucGlwZShcbiAgICAgICAgICAgICAgICAgICAgZmxhdE1hcCgob3B0aW9uOiBUU2VsZWN0T3B0aW9uKSA9PiBvcHRpb24gaW5zdGFuY2VvZiBOZ3hTZWxlY3RPcHRpb25cbiAgICAgICAgICAgICAgICAgICAgICAgID8gb2Yob3B0aW9uKVxuICAgICAgICAgICAgICAgICAgICAgICAgOiAob3B0aW9uIGluc3RhbmNlb2YgTmd4U2VsZWN0T3B0R3JvdXAgPyBmcm9tKG9wdGlvbi5vcHRpb25zKSA6IEVNUFRZKVxuICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICB0b0FycmF5KClcbiAgICAgICAgICAgICAgICApKVxuICAgICAgICAgICAgKSxcbiAgICAgICAgICAgIHN1YmpBY3R1YWxWYWx1ZVxuICAgICAgICApLnBpcGUoXG4gICAgICAgICAgICBtYXAoKFtvcHRpb25zRmxhdCwgYWN0dWFsVmFsdWVdOiBbTmd4U2VsZWN0T3B0aW9uW10sIGFueVtdXSkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IG9wdGlvbnNTZWxlY3RlZCA9IFtdO1xuXG4gICAgICAgICAgICAgICAgYWN0dWFsVmFsdWUuZm9yRWFjaCgodmFsdWU6IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3RlZE9wdGlvbiA9IG9wdGlvbnNGbGF0LmZpbmQoKG9wdGlvbjogTmd4U2VsZWN0T3B0aW9uKSA9PiBvcHRpb24udmFsdWUgPT09IHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkT3B0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zU2VsZWN0ZWQucHVzaChzZWxlY3RlZE9wdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmtlZXBTZWxlY3RlZEl0ZW1zKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG9wdGlvblZhbHVlcyA9IG9wdGlvbnNTZWxlY3RlZC5tYXAoKG9wdGlvbjogTmd4U2VsZWN0T3B0aW9uKSA9PiBvcHRpb24udmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBrZXB0U2VsZWN0ZWRPcHRpb25zID0gdGhpcy5zdWJqT3B0aW9uc1NlbGVjdGVkLnZhbHVlXG4gICAgICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKChzZWxPcHRpb246IE5neFNlbGVjdE9wdGlvbikgPT4gb3B0aW9uVmFsdWVzLmluZGV4T2Yoc2VsT3B0aW9uLnZhbHVlKSA9PT0gLTEpO1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25zU2VsZWN0ZWQucHVzaCguLi5rZXB0U2VsZWN0ZWRPcHRpb25zKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoIV8uaXNFcXVhbChvcHRpb25zU2VsZWN0ZWQsIHRoaXMuc3Viak9wdGlvbnNTZWxlY3RlZC52YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdWJqT3B0aW9uc1NlbGVjdGVkLm5leHQob3B0aW9uc1NlbGVjdGVkKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jZC5tYXJrRm9yQ2hlY2soKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0pXG4gICAgICAgICkuc3Vic2NyaWJlKCk7XG5cbiAgICAgICAgLy8gRW5zdXJlIHdvcmtpbmcgZmlsdGVyIGJ5IGEgc2VhcmNoIHRleHRcbiAgICAgICAgY29tYmluZUxhdGVzdCh0aGlzLnN1YmpPcHRpb25zLCB0aGlzLnN1YmpPcHRpb25zU2VsZWN0ZWQsIHRoaXMuc3VialNlYXJjaFRleHQpLnBpcGUoXG4gICAgICAgICAgICBtYXAoKFtvcHRpb25zLCBzZWxlY3RlZE9wdGlvbnMsIHNlYXJjaF06IFtUU2VsZWN0T3B0aW9uW10sIE5neFNlbGVjdE9wdGlvbltdLCBzdHJpbmddKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zRmlsdGVyZWQgPSB0aGlzLmZpbHRlck9wdGlvbnMoc2VhcmNoLCBvcHRpb25zLCBzZWxlY3RlZE9wdGlvbnMpLm1hcChvcHRpb24gPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAob3B0aW9uIGluc3RhbmNlb2YgTmd4U2VsZWN0T3B0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvcHRpb24uaGlnaGxpZ2h0ZWRUZXh0ID0gdGhpcy5oaWdobGlnaHRPcHRpb24ob3B0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChvcHRpb24gaW5zdGFuY2VvZiBOZ3hTZWxlY3RPcHRHcm91cCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uLm9wdGlvbnMubWFwKHN1Yk9wdGlvbiA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ViT3B0aW9uLmhpZ2hsaWdodGVkVGV4dCA9IHRoaXMuaGlnaGxpZ2h0T3B0aW9uKHN1Yk9wdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHN1Yk9wdGlvbjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBvcHRpb247XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdGhpcy5jYWNoZU9wdGlvbnNGaWx0ZXJlZEZsYXQgPSBudWxsO1xuICAgICAgICAgICAgICAgIHRoaXMubmF2aWdhdGVPcHRpb24oRU5hdmlnYXRpb24uZmlyc3RJZk9wdGlvbkFjdGl2ZUludmlzaWJsZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5jZC5tYXJrRm9yQ2hlY2soKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZWN0ZWRPcHRpb25zO1xuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBmbGF0TWFwKChzZWxlY3RlZE9wdGlvbnM6IE5neFNlbGVjdE9wdGlvbltdKSA9PiB0aGlzLm9wdGlvbnNGaWx0ZXJlZEZsYXQoKS5waXBlKGZpbHRlcihcbiAgICAgICAgICAgICAgICAoZmxhdE9wdGlvbnM6IE5neFNlbGVjdE9wdGlvbltdKSA9PiB0aGlzLmF1dG9TZWxlY3RTaW5nbGVPcHRpb24gJiYgZmxhdE9wdGlvbnMubGVuZ3RoID09PSAxICYmICFzZWxlY3RlZE9wdGlvbnMubGVuZ3RoXG4gICAgICAgICAgICApKSlcbiAgICAgICAgKS5zdWJzY3JpYmUoKGZsYXRPcHRpb25zOiBOZ3hTZWxlY3RPcHRpb25bXSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5zdWJqT3B0aW9uc1NlbGVjdGVkLm5leHQoZmxhdE9wdGlvbnMpO1xuICAgICAgICAgICAgdGhpcy5jZC5tYXJrRm9yQ2hlY2soKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHVibGljIHNldEZvcm1Db250cm9sU2l6ZShvdGhlckNsYXNzTmFtZXM6IE9iamVjdCA9IHt9LCB1c2VGb3JtQ29udHJvbDogYm9vbGVhbiA9IHRydWUpIHtcbiAgICAgICAgY29uc3QgZm9ybUNvbnRyb2xFeHRyYUNsYXNzZXMgPSB1c2VGb3JtQ29udHJvbCA/IHtcbiAgICAgICAgICAgICdmb3JtLWNvbnRyb2wtc20gaW5wdXQtc20nOiB0aGlzLnNpemUgPT09ICdzbWFsbCcsXG4gICAgICAgICAgICAnZm9ybS1jb250cm9sLWxnIGlucHV0LWxnJzogdGhpcy5zaXplID09PSAnbGFyZ2UnXG4gICAgICAgIH0gOiB7fTtcbiAgICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oZm9ybUNvbnRyb2xFeHRyYUNsYXNzZXMsIG90aGVyQ2xhc3NOYW1lcyk7XG4gICAgfVxuXG4gICAgcHVibGljIHNldEJ0blNpemUoKSB7XG4gICAgICAgIHJldHVybiB7J2J0bi1zbSc6IHRoaXMuc2l6ZSA9PT0gJ3NtYWxsJywgJ2J0bi1sZyc6IHRoaXMuc2l6ZSA9PT0gJ2xhcmdlJ307XG4gICAgfVxuXG4gICAgcHVibGljIGdldCBvcHRpb25zU2VsZWN0ZWQoKTogTmd4U2VsZWN0T3B0aW9uW10ge1xuICAgICAgICByZXR1cm4gdGhpcy5zdWJqT3B0aW9uc1NlbGVjdGVkLnZhbHVlO1xuICAgIH1cblxuICAgIHB1YmxpYyBtYWluQ2xpY2tlZChldmVudDogSU5neFNlbGVjdENvbXBvbmVudE1vdXNlRXZlbnQpIHtcbiAgICAgICAgZXZlbnQuY2xpY2tlZFNlbGVjdENvbXBvbmVudCA9IHRoaXM7XG4gICAgICAgIGlmICghdGhpcy5pc0ZvY3VzZWQpIHtcbiAgICAgICAgICAgIHRoaXMuaXNGb2N1c2VkID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuZm9jdXMuZW1pdCgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgQEhvc3RMaXN0ZW5lcignZG9jdW1lbnQ6Zm9jdXNpbicsIFsnJGV2ZW50J10pXG4gICAgQEhvc3RMaXN0ZW5lcignZG9jdW1lbnQ6Y2xpY2snLCBbJyRldmVudCddKVxuICAgIHB1YmxpYyBkb2N1bWVudENsaWNrKGV2ZW50OiBJTmd4U2VsZWN0Q29tcG9uZW50TW91c2VFdmVudCkge1xuICAgICAgICBpZiAoZXZlbnQuY2xpY2tlZFNlbGVjdENvbXBvbmVudCAhPT0gdGhpcykge1xuICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9uc09wZW5lZCkge1xuICAgICAgICAgICAgICAgIHRoaXMub3B0aW9uc0Nsb3NlKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5jZC5kZXRlY3RDaGFuZ2VzKCk7IC8vIGZpeCBlcnJvciBiZWNhdXNlIG9mIGRlbGF5IGJldHdlZW4gZGlmZmVyZW50IGV2ZW50c1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuaXNGb2N1c2VkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5pc0ZvY3VzZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB0aGlzLmJsdXIuZW1pdCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBvcHRpb25zRmlsdGVyZWRGbGF0KCk6IE9ic2VydmFibGU8Tmd4U2VsZWN0T3B0aW9uW10+IHtcbiAgICAgICAgaWYgKHRoaXMuY2FjaGVPcHRpb25zRmlsdGVyZWRGbGF0KSB7XG4gICAgICAgICAgICByZXR1cm4gb2YodGhpcy5jYWNoZU9wdGlvbnNGaWx0ZXJlZEZsYXQpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGZyb20odGhpcy5vcHRpb25zRmlsdGVyZWQpLnBpcGUoXG4gICAgICAgICAgICBmbGF0TWFwPFRTZWxlY3RPcHRpb24sIE5neFNlbGVjdE9wdGlvbj4oKG9wdGlvbjogVFNlbGVjdE9wdGlvbikgPT5cbiAgICAgICAgICAgICAgICBvcHRpb24gaW5zdGFuY2VvZiBOZ3hTZWxlY3RPcHRpb24gPyBvZihvcHRpb24pIDpcbiAgICAgICAgICAgICAgICAgICAgKG9wdGlvbiBpbnN0YW5jZW9mIE5neFNlbGVjdE9wdEdyb3VwID8gZnJvbShvcHRpb24ub3B0aW9uc0ZpbHRlcmVkKSA6IEVNUFRZKVxuICAgICAgICAgICAgKSxcbiAgICAgICAgICAgIGZpbHRlcigob3B0aW9uc0ZpbHRlcmVkRmxhdDogTmd4U2VsZWN0T3B0aW9uKSA9PiAhb3B0aW9uc0ZpbHRlcmVkRmxhdC5kaXNhYmxlZCksXG4gICAgICAgICAgICB0b0FycmF5KCksXG4gICAgICAgICAgICB0YXAoKG9wdGlvbnNGaWx0ZXJlZEZsYXQ6IE5neFNlbGVjdE9wdGlvbltdKSA9PiB0aGlzLmNhY2hlT3B0aW9uc0ZpbHRlcmVkRmxhdCA9IG9wdGlvbnNGaWx0ZXJlZEZsYXQpXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBuYXZpZ2F0ZU9wdGlvbihuYXZpZ2F0aW9uOiBFTmF2aWdhdGlvbikge1xuICAgICAgICB0aGlzLm9wdGlvbnNGaWx0ZXJlZEZsYXQoKS5waXBlKFxuICAgICAgICAgICAgbWFwPE5neFNlbGVjdE9wdGlvbltdLCBJTmd4T3B0aW9uTmF2aWdhdGVkPigob3B0aW9uczogTmd4U2VsZWN0T3B0aW9uW10pID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBuYXZpZ2F0ZWQ6IElOZ3hPcHRpb25OYXZpZ2F0ZWQgPSB7aW5kZXg6IC0xLCBhY3RpdmVPcHRpb246IG51bGwsIGZpbHRlcmVkT3B0aW9uTGlzdDogb3B0aW9uc307XG4gICAgICAgICAgICAgICAgbGV0IG5ld0FjdGl2ZUlkeDtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKG5hdmlnYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBFTmF2aWdhdGlvbi5maXJzdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hdmlnYXRlZC5pbmRleCA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBFTmF2aWdhdGlvbi5wcmV2aW91czpcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld0FjdGl2ZUlkeCA9IG9wdGlvbnMuaW5kZXhPZih0aGlzLm9wdGlvbkFjdGl2ZSkgLSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgbmF2aWdhdGVkLmluZGV4ID0gbmV3QWN0aXZlSWR4ID49IDAgPyBuZXdBY3RpdmVJZHggOiBvcHRpb25zLmxlbmd0aCAtIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBFTmF2aWdhdGlvbi5uZXh0OlxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3QWN0aXZlSWR4ID0gb3B0aW9ucy5pbmRleE9mKHRoaXMub3B0aW9uQWN0aXZlKSArIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICBuYXZpZ2F0ZWQuaW5kZXggPSBuZXdBY3RpdmVJZHggPCBvcHRpb25zLmxlbmd0aCA/IG5ld0FjdGl2ZUlkeCA6IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBFTmF2aWdhdGlvbi5sYXN0OlxuICAgICAgICAgICAgICAgICAgICAgICAgbmF2aWdhdGVkLmluZGV4ID0gb3B0aW9ucy5sZW5ndGggLSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgRU5hdmlnYXRpb24uZmlyc3RTZWxlY3RlZDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnN1YmpPcHRpb25zU2VsZWN0ZWQudmFsdWUubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmF2aWdhdGVkLmluZGV4ID0gb3B0aW9ucy5pbmRleE9mKHRoaXMuc3Viak9wdGlvbnNTZWxlY3RlZC52YWx1ZVswXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBFTmF2aWdhdGlvbi5maXJzdElmT3B0aW9uQWN0aXZlSW52aXNpYmxlOlxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGlkeE9mT3B0aW9uQWN0aXZlID0gLTE7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5vcHRpb25BY3RpdmUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZHhPZk9wdGlvbkFjdGl2ZSA9IG9wdGlvbnMuaW5kZXhPZihvcHRpb25zLmZpbmQoeCA9PiB4LnZhbHVlID09PSB0aGlzLm9wdGlvbkFjdGl2ZS52YWx1ZSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgbmF2aWdhdGVkLmluZGV4ID0gaWR4T2ZPcHRpb25BY3RpdmUgPiAwID8gaWR4T2ZPcHRpb25BY3RpdmUgOiAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG5hdmlnYXRlZC5hY3RpdmVPcHRpb24gPSBvcHRpb25zW25hdmlnYXRlZC5pbmRleF07XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5hdmlnYXRlZDtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICkuc3Vic2NyaWJlKChuZXdOYXZpZ2F0ZWQ6IElOZ3hPcHRpb25OYXZpZ2F0ZWQpID0+IHRoaXMub3B0aW9uQWN0aXZhdGUobmV3TmF2aWdhdGVkKSk7XG4gICAgfVxuXG4gICAgcHVibGljIG5nRG9DaGVjaygpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuaXRlbXNEaWZmZXIuZGlmZih0aGlzLml0ZW1zKSkge1xuICAgICAgICAgICAgdGhpcy5zdWJqT3B0aW9ucy5uZXh0KHRoaXMuYnVpbGRPcHRpb25zKHRoaXMuaXRlbXMpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGRlZlZhbCA9IHRoaXMuZGVmYXVsdFZhbHVlID8gW10uY29uY2F0KHRoaXMuZGVmYXVsdFZhbHVlKSA6IFtdO1xuICAgICAgICBpZiAodGhpcy5kZWZhdWx0VmFsdWVEaWZmZXIuZGlmZihkZWZWYWwpKSB7XG4gICAgICAgICAgICB0aGlzLnN1YmpEZWZhdWx0VmFsdWUubmV4dChkZWZWYWwpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIG5nQWZ0ZXJDb250ZW50Q2hlY2tlZCgpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuX2ZvY3VzVG9JbnB1dCAmJiB0aGlzLmNoZWNrSW5wdXRWaXNpYmlsaXR5KCkgJiYgdGhpcy5pbnB1dEVsUmVmICYmXG4gICAgICAgICAgICB0aGlzLmlucHV0RWxSZWYubmF0aXZlRWxlbWVudCAhPT0gZG9jdW1lbnQuYWN0aXZlRWxlbWVudCkge1xuICAgICAgICAgICAgdGhpcy5fZm9jdXNUb0lucHV0ID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLmlucHV0RWxSZWYubmF0aXZlRWxlbWVudC5mb2N1cygpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuY2hvaWNlTWVudUVsUmVmKSB7XG4gICAgICAgICAgICBjb25zdCB1bEVsZW1lbnQgPSB0aGlzLmNob2ljZU1lbnVFbFJlZi5uYXRpdmVFbGVtZW50IGFzIEhUTUxVTGlzdEVsZW1lbnQ7XG4gICAgICAgICAgICBjb25zdCBlbGVtZW50ID0gdWxFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ2Eubmd4LXNlbGVjdF9faXRlbV9hY3RpdmUuYWN0aXZlJykgYXMgSFRNTExpbmtFbGVtZW50O1xuXG4gICAgICAgICAgICBpZiAoZWxlbWVudCAmJiBlbGVtZW50Lm9mZnNldEhlaWdodCA+IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLmVuc3VyZVZpc2libGVFbGVtZW50KGVsZW1lbnQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgY2FuQ2xlYXJOb3RNdWx0aXBsZSgpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYWxsb3dDbGVhciAmJiAhIXRoaXMuc3Viak9wdGlvbnNTZWxlY3RlZC52YWx1ZS5sZW5ndGggJiZcbiAgICAgICAgICAgICghdGhpcy5zdWJqRGVmYXVsdFZhbHVlLnZhbHVlLmxlbmd0aCB8fCB0aGlzLnN1YmpEZWZhdWx0VmFsdWUudmFsdWVbMF0gIT09IHRoaXMuYWN0dWFsVmFsdWVbMF0pO1xuICAgIH1cblxuICAgIHB1YmxpYyBmb2N1c1RvSW5wdXQoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuX2ZvY3VzVG9JbnB1dCA9IHRydWU7XG4gICAgfVxuXG4gICAgcHVibGljIGlucHV0S2V5RG93bihldmVudDogS2V5Ym9hcmRFdmVudCkge1xuICAgICAgICBjb25zdCBrZXlzRm9yT3BlbmVkU3RhdGUgPSBbXS5jb25jYXQoXG4gICAgICAgICAgICB0aGlzLmtleUNvZGVUb09wdGlvbnNTZWxlY3QsXG4gICAgICAgICAgICB0aGlzLmtleUNvZGVUb05hdmlnYXRlRmlyc3QsXG4gICAgICAgICAgICB0aGlzLmtleUNvZGVUb05hdmlnYXRlUHJldmlvdXMsXG4gICAgICAgICAgICB0aGlzLmtleUNvZGVUb05hdmlnYXRlTmV4dCxcbiAgICAgICAgICAgIHRoaXMua2V5Q29kZVRvTmF2aWdhdGVMYXN0XG4gICAgICAgICk7XG4gICAgICAgIGNvbnN0IGtleXNGb3JDbG9zZWRTdGF0ZSA9IFtdLmNvbmNhdCh0aGlzLmtleUNvZGVUb09wdGlvbnNPcGVuLCB0aGlzLmtleUNvZGVUb1JlbW92ZVNlbGVjdGVkKTtcblxuICAgICAgICBpZiAodGhpcy5vcHRpb25zT3BlbmVkICYmIGtleXNGb3JPcGVuZWRTdGF0ZS5pbmRleE9mKGV2ZW50LmNvZGUpICE9PSAtMSkge1xuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgc3dpdGNoIChldmVudC5jb2RlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAoW10uY29uY2F0KHRoaXMua2V5Q29kZVRvT3B0aW9uc1NlbGVjdCkuaW5kZXhPZihldmVudC5jb2RlKSArIDEpICYmIGV2ZW50LmNvZGU6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMub3B0aW9uU2VsZWN0KHRoaXMub3B0aW9uQWN0aXZlKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5uYXZpZ2F0ZU9wdGlvbihFTmF2aWdhdGlvbi5uZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSB0aGlzLmtleUNvZGVUb05hdmlnYXRlRmlyc3Q6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubmF2aWdhdGVPcHRpb24oRU5hdmlnYXRpb24uZmlyc3QpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIHRoaXMua2V5Q29kZVRvTmF2aWdhdGVQcmV2aW91czpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5uYXZpZ2F0ZU9wdGlvbihFTmF2aWdhdGlvbi5wcmV2aW91cyk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgdGhpcy5rZXlDb2RlVG9OYXZpZ2F0ZUxhc3Q6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubmF2aWdhdGVPcHRpb24oRU5hdmlnYXRpb24ubGFzdCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgdGhpcy5rZXlDb2RlVG9OYXZpZ2F0ZU5leHQ6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubmF2aWdhdGVPcHRpb24oRU5hdmlnYXRpb24ubmV4dCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKCF0aGlzLm9wdGlvbnNPcGVuZWQgJiYga2V5c0ZvckNsb3NlZFN0YXRlLmluZGV4T2YoZXZlbnQuY29kZSkgIT09IC0xKSB7XG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICBzd2l0Y2ggKGV2ZW50LmNvZGUpIHtcbiAgICAgICAgICAgICAgICBjYXNlIChbXS5jb25jYXQodGhpcy5rZXlDb2RlVG9PcHRpb25zT3BlbikuaW5kZXhPZihldmVudC5jb2RlKSArIDEpICYmIGV2ZW50LmNvZGU6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMub3B0aW9uc09wZW4oKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSB0aGlzLmtleUNvZGVUb1JlbW92ZVNlbGVjdGVkOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9wdGlvblJlbW92ZSh0aGlzLnN1YmpPcHRpb25zU2VsZWN0ZWQudmFsdWVbdGhpcy5zdWJqT3B0aW9uc1NlbGVjdGVkLnZhbHVlLmxlbmd0aCAtIDFdLCBldmVudCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIHRyYWNrQnlPcHRpb24oaW5kZXg6IG51bWJlciwgb3B0aW9uOiBUU2VsZWN0T3B0aW9uKSB7XG4gICAgICAgIHJldHVybiBvcHRpb24gaW5zdGFuY2VvZiBOZ3hTZWxlY3RPcHRpb24gPyBvcHRpb24udmFsdWUgOlxuICAgICAgICAgICAgKG9wdGlvbiBpbnN0YW5jZW9mIE5neFNlbGVjdE9wdEdyb3VwID8gb3B0aW9uLmxhYmVsIDogb3B0aW9uKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgY2hlY2tJbnB1dFZpc2liaWxpdHkoKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiAodGhpcy5tdWx0aXBsZSA9PT0gdHJ1ZSkgfHwgKHRoaXMub3B0aW9uc09wZW5lZCAmJiAhdGhpcy5ub0F1dG9Db21wbGV0ZSk7XG4gICAgfVxuXG4gICAgLyoqIEBpbnRlcm5hbCAqL1xuICAgIHB1YmxpYyBpbnB1dEtleVVwKHZhbHVlOiBzdHJpbmcgPSAnJywgZXZlbnQ6IEtleWJvYXJkRXZlbnQpIHtcbiAgICAgICAgaWYgKGV2ZW50LmNvZGUgPT09IHRoaXMua2V5Q29kZVRvT3B0aW9uc0Nsb3NlKSB7XG4gICAgICAgICAgICB0aGlzLm9wdGlvbnNDbG9zZSgvKnRydWUqLyk7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5vcHRpb25zT3BlbmVkICYmIChbJ0Fycm93RG93bicsICdBcnJvd1VwJywgJ0Fycm93TGVmdCcsICdBcnJvd0Rvd24nXS5pbmRleE9mKGV2ZW50LmNvZGUpID09PSAtMSkvKmlnbm9yZSBhcnJvd3MqLykge1xuICAgICAgICAgICAgdGhpcy50eXBlZC5lbWl0KHZhbHVlKTtcbiAgICAgICAgfSBlbHNlIGlmICghdGhpcy5vcHRpb25zT3BlbmVkICYmIHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLm9wdGlvbnNPcGVuKHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKiBAaW50ZXJuYWwgKi9cbiAgICBwdWJsaWMgaW5wdXRDbGljayh2YWx1ZTogc3RyaW5nID0gJycpIHtcbiAgICAgICAgaWYgKCF0aGlzLm9wdGlvbnNPcGVuZWQpIHtcbiAgICAgICAgICAgIHRoaXMub3B0aW9uc09wZW4odmFsdWUpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqIEBpbnRlcm5hbCAqL1xuICAgIHB1YmxpYyBzYW5pdGl6ZShodG1sOiBzdHJpbmcpOiBTYWZlSHRtbCB7XG4gICAgICAgIHJldHVybiBodG1sID8gdGhpcy5zYW5pdGl6ZXIuYnlwYXNzU2VjdXJpdHlUcnVzdEh0bWwoaHRtbCkgOiBudWxsO1xuICAgIH1cblxuICAgIC8qKiBAaW50ZXJuYWwgKi9cbiAgICBwdWJsaWMgaGlnaGxpZ2h0T3B0aW9uKG9wdGlvbjogTmd4U2VsZWN0T3B0aW9uKTogU2FmZUh0bWwge1xuICAgICAgICBpZiAodGhpcy5pbnB1dEVsUmVmKSB7XG4gICAgICAgICAgICByZXR1cm4gb3B0aW9uLnJlbmRlclRleHQodGhpcy5zYW5pdGl6ZXIsIHRoaXMuaW5wdXRFbFJlZi5uYXRpdmVFbGVtZW50LnZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3B0aW9uLnJlbmRlclRleHQodGhpcy5zYW5pdGl6ZXIsICcnKTtcbiAgICB9XG5cbiAgICAvKiogQGludGVybmFsICovXG4gICAgcHVibGljIG9wdGlvblNlbGVjdChvcHRpb246IE5neFNlbGVjdE9wdGlvbiwgZXZlbnQ6IEV2ZW50ID0gbnVsbCk6IHZvaWQge1xuICAgICAgICBpZiAoZXZlbnQpIHtcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAob3B0aW9uICYmICFvcHRpb24uZGlzYWJsZWQpIHtcbiAgICAgICAgICAgIHRoaXMuc3Viak9wdGlvbnNTZWxlY3RlZC5uZXh0KCh0aGlzLm11bHRpcGxlID8gdGhpcy5zdWJqT3B0aW9uc1NlbGVjdGVkLnZhbHVlIDogW10pLmNvbmNhdChbb3B0aW9uXSkpO1xuICAgICAgICAgICAgdGhpcy5zZWxlY3QuZW1pdChvcHRpb24udmFsdWUpO1xuICAgICAgICAgICAgdGhpcy5vcHRpb25zQ2xvc2UoLyp0cnVlKi8pO1xuICAgICAgICAgICAgdGhpcy5vblRvdWNoZWQoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKiBAaW50ZXJuYWwgKi9cbiAgICBwdWJsaWMgb3B0aW9uUmVtb3ZlKG9wdGlvbjogTmd4U2VsZWN0T3B0aW9uLCBldmVudDogRXZlbnQpOiB2b2lkIHtcbiAgICAgICAgaWYgKCF0aGlzLmRpc2FibGVkICYmIG9wdGlvbikge1xuICAgICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICB0aGlzLnN1YmpPcHRpb25zU2VsZWN0ZWQubmV4dCgodGhpcy5tdWx0aXBsZSA/IHRoaXMuc3Viak9wdGlvbnNTZWxlY3RlZC52YWx1ZSA6IFtdKS5maWx0ZXIobyA9PiBvICE9PSBvcHRpb24pKTtcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlLmVtaXQob3B0aW9uLnZhbHVlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKiBAaW50ZXJuYWwgKi9cbiAgICBwdWJsaWMgb3B0aW9uQWN0aXZhdGUobmF2aWdhdGVkOiBJTmd4T3B0aW9uTmF2aWdhdGVkKTogdm9pZCB7XG4gICAgICAgIGlmICgodGhpcy5vcHRpb25BY3RpdmUgIT09IG5hdmlnYXRlZC5hY3RpdmVPcHRpb24pICYmXG4gICAgICAgICAgICAoIW5hdmlnYXRlZC5hY3RpdmVPcHRpb24gfHwgIW5hdmlnYXRlZC5hY3RpdmVPcHRpb24uZGlzYWJsZWQpKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5vcHRpb25BY3RpdmUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbkFjdGl2ZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5vcHRpb25BY3RpdmUgPSBuYXZpZ2F0ZWQuYWN0aXZlT3B0aW9uO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5vcHRpb25BY3RpdmUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbkFjdGl2ZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5uYXZpZ2F0ZWQuZW1pdChuYXZpZ2F0ZWQpO1xuICAgICAgICAgICAgdGhpcy5jZC5kZXRlY3RDaGFuZ2VzKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKiogQGludGVybmFsICovXG4gICAgcHVibGljIG9uTW91c2VFbnRlcihuYXZpZ2F0ZWQ6IElOZ3hPcHRpb25OYXZpZ2F0ZWQpOiB2b2lkIHtcbiAgICAgICAgZG9jdW1lbnQub25tb3VzZW1vdmUgPSAoKSA9PiB7XG4gICAgICAgICAgICBpZiAodGhpcy5hdXRvQWN0aXZlT25Nb3VzZUVudGVyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vcHRpb25BY3RpdmF0ZShuYXZpZ2F0ZWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIHByaXZhdGUgZmlsdGVyT3B0aW9ucyhzZWFyY2g6IHN0cmluZywgb3B0aW9uczogVFNlbGVjdE9wdGlvbltdLCBzZWxlY3RlZE9wdGlvbnM6IE5neFNlbGVjdE9wdGlvbltdKTogVFNlbGVjdE9wdGlvbltdIHtcbiAgICAgICAgY29uc3QgcmVnRXhwID0gbmV3IFJlZ0V4cChlc2NhcGVTdHJpbmcoc2VhcmNoKSwgJ2knKSxcbiAgICAgICAgICAgIGZpbHRlck9wdGlvbiA9IChvcHRpb246IE5neFNlbGVjdE9wdGlvbikgPT4ge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnNlYXJjaENhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnNlYXJjaENhbGxiYWNrKHNlYXJjaCwgb3B0aW9uKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuICghc2VhcmNoIHx8IHJlZ0V4cC50ZXN0KG9wdGlvbi50ZXh0KSkgJiYgKCF0aGlzLm11bHRpcGxlIHx8IHNlbGVjdGVkT3B0aW9ucy5pbmRleE9mKG9wdGlvbikgPT09IC0xKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuZmlsdGVyKChvcHRpb246IFRTZWxlY3RPcHRpb24pID0+IHtcbiAgICAgICAgICAgIGlmIChvcHRpb24gaW5zdGFuY2VvZiBOZ3hTZWxlY3RPcHRpb24pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmlsdGVyT3B0aW9uKDxOZ3hTZWxlY3RPcHRpb24+b3B0aW9uKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAob3B0aW9uIGluc3RhbmNlb2YgTmd4U2VsZWN0T3B0R3JvdXApIHtcbiAgICAgICAgICAgICAgICBjb25zdCBzdWJPcCA9IDxOZ3hTZWxlY3RPcHRHcm91cD5vcHRpb247XG4gICAgICAgICAgICAgICAgc3ViT3AuZmlsdGVyKChzdWJPcHRpb246IE5neFNlbGVjdE9wdGlvbikgPT4gZmlsdGVyT3B0aW9uKHN1Yk9wdGlvbikpO1xuICAgICAgICAgICAgICAgIHJldHVybiBzdWJPcC5vcHRpb25zRmlsdGVyZWQubGVuZ3RoO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGVuc3VyZVZpc2libGVFbGVtZW50KGVsZW1lbnQ6IEhUTUxFbGVtZW50KSB7XG4gICAgICAgIGlmICh0aGlzLmNob2ljZU1lbnVFbFJlZiAmJiB0aGlzLmNhY2hlRWxlbWVudE9mZnNldFRvcCAhPT0gZWxlbWVudC5vZmZzZXRUb3ApIHtcbiAgICAgICAgICAgIHRoaXMuY2FjaGVFbGVtZW50T2Zmc2V0VG9wID0gZWxlbWVudC5vZmZzZXRUb3A7XG4gICAgICAgICAgICBjb25zdCBjb250YWluZXI6IEhUTUxFbGVtZW50ID0gdGhpcy5jaG9pY2VNZW51RWxSZWYubmF0aXZlRWxlbWVudDtcbiAgICAgICAgICAgIGlmICh0aGlzLmNhY2hlRWxlbWVudE9mZnNldFRvcCA8IGNvbnRhaW5lci5zY3JvbGxUb3ApIHtcbiAgICAgICAgICAgICAgICBjb250YWluZXIuc2Nyb2xsVG9wID0gdGhpcy5jYWNoZUVsZW1lbnRPZmZzZXRUb3A7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuY2FjaGVFbGVtZW50T2Zmc2V0VG9wICsgZWxlbWVudC5vZmZzZXRIZWlnaHQgPiBjb250YWluZXIuc2Nyb2xsVG9wICsgY29udGFpbmVyLmNsaWVudEhlaWdodCkge1xuICAgICAgICAgICAgICAgIGNvbnRhaW5lci5zY3JvbGxUb3AgPSB0aGlzLmNhY2hlRWxlbWVudE9mZnNldFRvcCArIGVsZW1lbnQub2Zmc2V0SGVpZ2h0IC0gY29udGFpbmVyLmNsaWVudEhlaWdodDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBvcHRpb25zT3BlbihzZWFyY2g6IHN0cmluZyA9ICcnKSB7XG4gICAgICAgIGlmICghdGhpcy5kaXNhYmxlZCkge1xuICAgICAgICAgICAgdGhpcy5vcHRpb25zT3BlbmVkID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuc3VialNlYXJjaFRleHQubmV4dChzZWFyY2gpO1xuICAgICAgICAgICAgaWYgKCF0aGlzLm11bHRpcGxlICYmIHRoaXMuc3Viak9wdGlvbnNTZWxlY3RlZC52YWx1ZS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm5hdmlnYXRlT3B0aW9uKEVOYXZpZ2F0aW9uLmZpcnN0U2VsZWN0ZWQpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLm5hdmlnYXRlT3B0aW9uKEVOYXZpZ2F0aW9uLmZpcnN0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuZm9jdXNUb0lucHV0KCk7XG4gICAgICAgICAgICB0aGlzLm9wZW4uZW1pdCgpO1xuICAgICAgICAgICAgdGhpcy5jZC5tYXJrRm9yQ2hlY2soKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBvcHRpb25zQ2xvc2UoLypmb2N1c1RvSG9zdDogYm9vbGVhbiA9IGZhbHNlKi8pIHtcbiAgICAgICAgdGhpcy5vcHRpb25zT3BlbmVkID0gZmFsc2U7XG4gICAgICAgIC8vIGlmIChmb2N1c1RvSG9zdCkge1xuICAgICAgICAvLyAgICAgY29uc3QgeCA9IHdpbmRvdy5zY3JvbGxYLCB5ID0gd2luZG93LnNjcm9sbFk7XG4gICAgICAgIC8vICAgICB0aGlzLm1haW5FbFJlZi5uYXRpdmVFbGVtZW50LmZvY3VzKCk7XG4gICAgICAgIC8vICAgICB3aW5kb3cuc2Nyb2xsVG8oeCwgeSk7XG4gICAgICAgIC8vIH1cbiAgICAgICAgdGhpcy5jbG9zZS5lbWl0KCk7XG5cbiAgICAgICAgaWYgKHRoaXMuYXV0b0NsZWFyU2VhcmNoICYmIHRoaXMubXVsdGlwbGUgJiYgdGhpcy5pbnB1dEVsUmVmKSB7XG4gICAgICAgICAgICB0aGlzLmlucHV0RWxSZWYubmF0aXZlRWxlbWVudC52YWx1ZSA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIGJ1aWxkT3B0aW9ucyhkYXRhOiBhbnlbXSk6IEFycmF5PE5neFNlbGVjdE9wdGlvbiB8IE5neFNlbGVjdE9wdEdyb3VwPiB7XG4gICAgICAgIGNvbnN0IHJlc3VsdDogQXJyYXk8Tmd4U2VsZWN0T3B0aW9uIHwgTmd4U2VsZWN0T3B0R3JvdXA+ID0gW107XG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KGRhdGEpKSB7XG4gICAgICAgICAgICBsZXQgb3B0aW9uOiBOZ3hTZWxlY3RPcHRpb247XG4gICAgICAgICAgICBkYXRhLmZvckVhY2goKGl0ZW06IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGlzT3B0R3JvdXAgPSB0eXBlb2YgaXRlbSA9PT0gJ29iamVjdCcgJiYgaXRlbSAhPT0gbnVsbCAmJlxuICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eUV4aXN0cyhpdGVtLCB0aGlzLm9wdEdyb3VwTGFiZWxGaWVsZCkgJiYgcHJvcGVydHlFeGlzdHMoaXRlbSwgdGhpcy5vcHRHcm91cE9wdGlvbnNGaWVsZCkgJiZcbiAgICAgICAgICAgICAgICAgICAgQXJyYXkuaXNBcnJheShpdGVtW3RoaXMub3B0R3JvdXBPcHRpb25zRmllbGRdKTtcbiAgICAgICAgICAgICAgICBpZiAoaXNPcHRHcm91cCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBvcHRHcm91cCA9IG5ldyBOZ3hTZWxlY3RPcHRHcm91cChpdGVtW3RoaXMub3B0R3JvdXBMYWJlbEZpZWxkXSk7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW1bdGhpcy5vcHRHcm91cE9wdGlvbnNGaWVsZF0uZm9yRWFjaCgoc3ViT3B0aW9uOiBOZ3hTZWxlY3RPcHRpb24pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvcHRpb24gPSB0aGlzLmJ1aWxkT3B0aW9uKHN1Yk9wdGlvbiwgb3B0R3JvdXApKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0R3JvdXAub3B0aW9ucy5wdXNoKG9wdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQucHVzaChvcHRHcm91cCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChvcHRpb24gPSB0aGlzLmJ1aWxkT3B0aW9uKGl0ZW0sIG51bGwpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKG9wdGlvbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5cbiAgICBwcml2YXRlIGJ1aWxkT3B0aW9uKGRhdGE6IGFueSwgcGFyZW50OiBOZ3hTZWxlY3RPcHRHcm91cCk6IE5neFNlbGVjdE9wdGlvbiB7XG4gICAgICAgIGxldCB2YWx1ZSwgdGV4dCwgZGlzYWJsZWQ7XG4gICAgICAgIGlmICh0eXBlb2YgZGF0YSA9PT0gJ3N0cmluZycgfHwgdHlwZW9mIGRhdGEgPT09ICdudW1iZXInKSB7XG4gICAgICAgICAgICB2YWx1ZSA9IHRleHQgPSBkYXRhO1xuICAgICAgICAgICAgZGlzYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgZGF0YSA9PT0gJ29iamVjdCcgJiYgZGF0YSAhPT0gbnVsbCAmJlxuICAgICAgICAgICAgKHByb3BlcnR5RXhpc3RzKGRhdGEsIHRoaXMub3B0aW9uVmFsdWVGaWVsZCkgfHwgcHJvcGVydHlFeGlzdHMoZGF0YSwgdGhpcy5vcHRpb25UZXh0RmllbGQpKSkge1xuICAgICAgICAgICAgdmFsdWUgPSBwcm9wZXJ0eUV4aXN0cyhkYXRhLCB0aGlzLm9wdGlvblZhbHVlRmllbGQpID8gZGF0YVt0aGlzLm9wdGlvblZhbHVlRmllbGRdIDogZGF0YVt0aGlzLm9wdGlvblRleHRGaWVsZF07XG4gICAgICAgICAgICB0ZXh0ID0gcHJvcGVydHlFeGlzdHMoZGF0YSwgdGhpcy5vcHRpb25UZXh0RmllbGQpID8gZGF0YVt0aGlzLm9wdGlvblRleHRGaWVsZF0gOiBkYXRhW3RoaXMub3B0aW9uVmFsdWVGaWVsZF07XG4gICAgICAgICAgICBkaXNhYmxlZCA9IHByb3BlcnR5RXhpc3RzKGRhdGEsICdkaXNhYmxlZCcpID8gZGF0YVsnZGlzYWJsZWQnXSA6IGZhbHNlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ldyBOZ3hTZWxlY3RPcHRpb24odmFsdWUsIHRleHQsIGRpc2FibGVkLCBkYXRhLCBwYXJlbnQpO1xuICAgIH1cblxuICAgIC8vLy8vLy8vLy8vLyBpbnRlcmZhY2UgQ29udHJvbFZhbHVlQWNjZXNzb3IgLy8vLy8vLy8vLy8vXG4gICAgcHVibGljIG9uQ2hhbmdlID0gKHY6IGFueSkgPT4gdjtcblxuICAgIHB1YmxpYyBvblRvdWNoZWQ6ICgpID0+IHZvaWQgPSAoKSA9PiBudWxsO1xuXG4gICAgcHVibGljIHdyaXRlVmFsdWUob2JqOiBhbnkpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5zdWJqRXh0ZXJuYWxWYWx1ZS5uZXh0KG9iaik7XG4gICAgfVxuXG4gICAgcHVibGljIHJlZ2lzdGVyT25DaGFuZ2UoZm46IChfOiBhbnkpID0+IHt9KTogdm9pZCB7XG4gICAgICAgIHRoaXMub25DaGFuZ2UgPSBmbjtcbiAgICAgICAgdGhpcy5zdWJqUmVnaXN0ZXJPbkNoYW5nZS5uZXh0KCk7XG4gICAgfVxuXG4gICAgcHVibGljIHJlZ2lzdGVyT25Ub3VjaGVkKGZuOiAoKSA9PiB7fSk6IHZvaWQge1xuICAgICAgICB0aGlzLm9uVG91Y2hlZCA9IGZuO1xuICAgIH1cblxuICAgIHB1YmxpYyBzZXREaXNhYmxlZFN0YXRlKGlzRGlzYWJsZWQ6IGJvb2xlYW4pOiB2b2lkIHtcbiAgICAgICAgdGhpcy5kaXNhYmxlZCA9IGlzRGlzYWJsZWQ7XG4gICAgICAgIHRoaXMuY2QubWFya0ZvckNoZWNrKCk7XG4gICAgfVxufVxuIiwiaW1wb3J0IHtNb2R1bGVXaXRoUHJvdmlkZXJzLCBOZ01vZHVsZX0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQge0NvbW1vbk1vZHVsZX0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uJztcbmltcG9ydCB7TkdYX1NFTEVDVF9PUFRJT05TLCBOZ3hTZWxlY3RDb21wb25lbnR9IGZyb20gJy4vbmd4LXNlbGVjdC5jb21wb25lbnQnO1xuaW1wb3J0IHtOZ3hTZWxlY3RPcHRpb25EaXJlY3RpdmUsIE5neFNlbGVjdE9wdGlvbk5vdEZvdW5kRGlyZWN0aXZlLCBOZ3hTZWxlY3RPcHRpb25TZWxlY3RlZERpcmVjdGl2ZX0gZnJvbSAnLi9uZ3gtdGVtcGxhdGVzLmRpcmVjdGl2ZSc7XG5pbXBvcnQge0lOZ3hTZWxlY3RPcHRpb25zfSBmcm9tICcuL25neC1zZWxlY3QuaW50ZXJmYWNlcyc7XG5cbkBOZ01vZHVsZSh7XG4gICAgaW1wb3J0czogW1xuICAgICAgICBDb21tb25Nb2R1bGVcbiAgICBdLFxuICAgIGRlY2xhcmF0aW9uczogW05neFNlbGVjdENvbXBvbmVudCxcbiAgICAgICAgTmd4U2VsZWN0T3B0aW9uRGlyZWN0aXZlLCBOZ3hTZWxlY3RPcHRpb25TZWxlY3RlZERpcmVjdGl2ZSwgTmd4U2VsZWN0T3B0aW9uTm90Rm91bmREaXJlY3RpdmVcbiAgICBdLFxuICAgIGV4cG9ydHM6IFtOZ3hTZWxlY3RDb21wb25lbnQsXG4gICAgICAgIE5neFNlbGVjdE9wdGlvbkRpcmVjdGl2ZSwgTmd4U2VsZWN0T3B0aW9uU2VsZWN0ZWREaXJlY3RpdmUsIE5neFNlbGVjdE9wdGlvbk5vdEZvdW5kRGlyZWN0aXZlXG4gICAgXVxufSlcbmV4cG9ydCBjbGFzcyBOZ3hTZWxlY3RNb2R1bGUge1xuICAgIHN0YXRpYyBmb3JSb290KG9wdGlvbnM6IElOZ3hTZWxlY3RPcHRpb25zKTogTW9kdWxlV2l0aFByb3ZpZGVycyB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBuZ01vZHVsZTogTmd4U2VsZWN0TW9kdWxlLFxuICAgICAgICAgICAgcHJvdmlkZXJzOiBbe3Byb3ZpZGU6IE5HWF9TRUxFQ1RfT1BUSU9OUywgdXNlVmFsdWU6IG9wdGlvbnN9XVxuICAgICAgICB9O1xuICAgIH1cbn1cbiJdLCJuYW1lcyI6WyJlc2NhcGVTdHJpbmciXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0FBQ0E7QUFHQSxJQUFNLFlBQVksR0FBRyxjQUFjLENBQUM7QUFFcEMsSUFBQTtJQU1FLHlCQUFtQixLQUFzQixFQUNwQixNQUNBLFVBQ0EsTUFDQzs7UUFKSCxVQUFLLEdBQUwsS0FBSyxDQUFpQjtRQUNwQixTQUFJLEdBQUosSUFBSTtRQUNKLGFBQVEsR0FBUixRQUFRO1FBQ1IsU0FBSSxHQUFKLElBQUk7UUFDSCxZQUFPLEdBQVAsT0FBTztvQkFUVyxRQUFRO2lDQWlCUixJQUFJO0tBUHpDOzBCQUVVLG1DQUFNOzs7OztZQUNiLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQzs7Ozs7Ozs7OztJ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